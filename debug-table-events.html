<!DOCTYPE html>
<html>
<head>
    <title>表格事件调试</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-container { border: 1px solid #ccc; padding: 20px; margin: 10px 0; }
        .debug-table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        .debug-table th, .debug-table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }
        .debug-table th { background-color: #f0f0f0; }
        .debug-table tr:hover { background-color: #f9f9f9; cursor: pointer; }
        #log { background: #f5f5f5; padding: 10px; height: 200px; overflow-y: auto; border: 1px solid #ccc; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <h1>PDF表格事件调试工具</h1>

    <div class="debug-container">
        <h2>测试1: 原生HTML表格</h2>
        <table class="debug-table" id="native-table">
            <thead>
                <tr>
                    <th>文件名</th>
                    <th>大小</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                <tr data-id="1">
                    <td>test1.pdf</td>
                    <td>1.2MB</td>
                    <td><button onclick="event.stopPropagation(); log('按钮1点击')">打开</button></td>
                </tr>
                <tr data-id="2">
                    <td>test2.pdf</td>
                    <td>2.5MB</td>
                    <td><button onclick="event.stopPropagation(); log('按钮2点击')">打开</button></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="debug-container">
        <h2>测试2: 模拟表格容器</h2>
        <div id="pdf-table-container" style="border: 2px solid red; min-height: 100px; padding: 10px;">
            <p>模拟的 #pdf-table-container</p>
            <div class="mock-row" style="padding: 10px; border: 1px solid #ccc; margin: 5px 0; cursor: pointer;" data-filename="mock.pdf">
                模拟表格行 - 请双击这里
            </div>
        </div>
    </div>

    <div class="debug-container">
        <h2>事件日志</h2>
        <button onclick="clearLog()">清空日志</button>
        <pre id="log"></pre>
    </div>

    <script>
        function log(message) {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        // 原生表格事件测试
        const nativeTable = document.getElementById('native-table');

        nativeTable.addEventListener('click', (e) => {
            if (e.target.tagName === 'TR' || e.target.tagName === 'TD') {
                const row = e.target.closest('tr');
                const id = row?.dataset?.id;
                log(`原生表格单击: ${id}`);
            }
        });

        nativeTable.addEventListener('dblclick', (e) => {
            if (e.target.tagName === 'TR' || e.target.tagName === 'TD') {
                const row = e.target.closest('tr');
                const id = row?.dataset?.id;
                log(`原生表格双击: ${id} ✅`);
            }
        });

        // 模拟容器事件测试
        const container = document.getElementById('pdf-table-container');

        container.addEventListener('click', (e) => {
            log('模拟容器单击');
        });

        container.addEventListener('dblclick', (e) => {
            const filename = e.target.dataset?.filename;
            log(`模拟容器双击: ${filename} ✅`);
        });

        // 检查页面是否有实际的表格
        setTimeout(() => {
            const realContainer = document.querySelector('#pdf-table-container');
            if (realContainer && realContainer !== container) {
                log('发现实际的 #pdf-table-container');
                log(`实际容器类名: ${realContainer.className}`);
                log(`实际容器子元素数量: ${realContainer.children.length}`);

                // 为实际容器添加事件监听
                realContainer.addEventListener('click', (e) => {
                    log(`实际容器单击: ${e.target.tagName}`);
                });

                realContainer.addEventListener('dblclick', (e) => {
                    log(`实际容器双击: ${e.target.tagName} ✅`);
                });
            } else {
                log('未发现其他 #pdf-table-container');
            }
        }, 1000);

        log('调试工具已加载');
        log('请尝试单击和双击上方的表格行');
    </script>
</body>
</html>