# ğŸ” å‰åç«¯é€šä¿¡æµ‹è¯•å·¥å…·æ€»ç»“

## ğŸ“Œ è®¾è®¡æ€è·¯

### é—®é¢˜èƒŒæ™¯
åœ¨å‰åç«¯ååŒå¼€å‘ä¸­ï¼Œç»å¸¸é‡åˆ°æ•°æ®æ ¼å¼ä¸ä¸€è‡´çš„é—®é¢˜ï¼š
- å­—æ®µå‘½åä¸ç»Ÿä¸€ï¼ˆcamelCase vs snake_caseï¼‰
- æ•°æ®ç±»å‹é”™è¯¯ï¼ˆæ•°å­— vs å­—ç¬¦ä¸²ï¼‰
- æ—¶é—´æˆ³æ ¼å¼æ··ä¹±ï¼ˆç§’ vs æ¯«ç§’ï¼‰
- ç¼ºå°‘å¿…éœ€å­—æ®µ
- æ¶ˆæ¯ç»“æ„ä¸è§„èŒƒ

### è§£å†³æ–¹æ¡ˆ
åˆ›å»ºè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­å®æ—¶éªŒè¯å‰åç«¯é€šä¿¡çš„æ•°æ®æ ¼å¼ä¸€è‡´æ€§ã€‚

## ğŸ› ï¸ å·¥å…·ç»„æˆ

### 1. Python æµ‹è¯•è„šæœ¬ï¼ˆåç«¯ç‹¬ç«‹æµ‹è¯•ï¼‰

#### æ–‡ä»¶ç»“æ„
```
test_message_schemas.py        # æ•°æ®æ ¼å¼å®šä¹‰ï¼ˆSchemaï¼‰
test_frontend_backend_integration.py  # ä¸»æµ‹è¯•è„šæœ¬
quick_test.py                   # å¿«é€Ÿæµ‹è¯•è„šæœ¬
INTEGRATION_TEST_README.md      # ä½¿ç”¨è¯´æ˜
```

#### åŠŸèƒ½ç‰¹æ€§
- âœ… WebSocket è¿æ¥æµ‹è¯•
- âœ… æ¶ˆæ¯ç»“æ„éªŒè¯
- âœ… å­—æ®µå‘½åè§„èŒƒæ£€æŸ¥ï¼ˆsnake_caseï¼‰
- âœ… æ•°æ®ç±»å‹éªŒè¯
- âœ… æ—¶é—´æˆ³æ ¼å¼éªŒè¯
- âœ… PDF è®°å½•å®Œæ•´æ€§æ£€æŸ¥
- âœ… è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Š

#### ä½¿ç”¨æ–¹å¼
```bash
# å®Œæ•´æµ‹è¯•
python test_frontend_backend_integration.py --port 8765

# å¿«é€Ÿæµ‹è¯•
python quick_test.py 8765
```

### 2. å‰ç«¯æµ‹è¯•å·¥å…·ï¼ˆé›†æˆåˆ° PDF-Homeï¼‰

#### æ–‡ä»¶ä½ç½®
```
src/frontend/pdf-home/utils/communication-tester.js
src/frontend/pdf-home/index.js  # å·²é›†æˆ
```

#### åŠŸèƒ½ç‰¹æ€§
- ğŸ¯ **å¯è§†åŒ–ç•Œé¢**ï¼šé¡µé¢å³ä¸‹è§’çš„æµ‹è¯•æŒ‰é’®
- ğŸ“Š **å®æ—¶éªŒè¯**ï¼šç‚¹å‡»å³å¯æµ‹è¯•å½“å‰è¿æ¥
- ğŸ“ˆ **è¯¦ç»†æŠ¥å‘Š**ï¼šHTML æ ¼å¼çš„æµ‹è¯•ç»“æœ
- ğŸ”„ **è‡ªåŠ¨æ£€æµ‹**ï¼šä»…åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨
- âš¡ **é›¶é…ç½®**ï¼šæ— éœ€æ‰‹åŠ¨è®¾ç½®

#### ä½¿ç”¨æ–¹å¼
1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆç¡®ä¿æ˜¯å¼€å‘ç¯å¢ƒï¼‰
2. æ‰“å¼€ PDF-Home é¡µé¢
3. ç‚¹å‡»å³ä¸‹è§’çš„ "ğŸ” é€šä¿¡æµ‹è¯•" æŒ‰é’®
4. æŸ¥çœ‹å¼¹å‡ºçš„æµ‹è¯•æŠ¥å‘Š

## ğŸ“Š æµ‹è¯•å†…å®¹

### æµ‹è¯•é¡¹ç›®æ¸…å•

| æµ‹è¯•é¡¹ | æ£€æŸ¥å†…å®¹ | ä¸¥é‡æ€§ |
|-------|---------|--------|
| **è¿æ¥æµ‹è¯•** | WebSocket çŠ¶æ€æ£€æŸ¥ | âŒ é”™è¯¯ |
| **æ¶ˆæ¯ç»“æ„** | type, data å­—æ®µéªŒè¯ | âŒ é”™è¯¯ |
| **å­—æ®µå‘½å** | snake_case è§„èŒƒ | âš ï¸ è­¦å‘Š |
| **æ•°æ®ç±»å‹** | ç±»å‹åŒ¹é…éªŒè¯ | âŒ é”™è¯¯ |
| **æ—¶é—´æˆ³** | Unix ç§’æ ¼å¼éªŒè¯ | âš ï¸ è­¦å‘Š |
| **è®°å½•å®Œæ•´æ€§** | 13 ä¸ªå­—æ®µé½å…¨æ€§ | âŒ é”™è¯¯ |

### PDF è®°å½•å­—æ®µéªŒè¯

éªŒè¯æ‰€æœ‰ 13 ä¸ªå­—æ®µï¼š
```javascript
{
  id: string,
  filename: string,
  file_path: string,
  file_size: number,
  page_count: number,
  created_at: number,          // Unix ç§’
  last_accessed_at: number,    // Unix ç§’
  review_count: number,
  rating: number,              // 0-5
  tags: array,
  is_visible: boolean,
  total_reading_time: number,  // ç§’
  due_date: number            // Unix ç§’
}
```

## ğŸ¨ å‰ç«¯æµ‹è¯•å·¥å…·ç•Œé¢

### æŒ‰é’®ä½ç½®
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
â”‚      PDF-Home é¡µé¢          â”‚
â”‚                             â”‚
â”‚                             â”‚
â”‚                             â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   â”‚ğŸ” é€šä¿¡æµ‹è¯•â”‚  â† æµ‹è¯•æŒ‰é’®
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹

#### âœ… æˆåŠŸæŠ¥å‘Š
```
================
é€šä¿¡æµ‹è¯•æŠ¥å‘Š
================
å…± 2 é¡¹æµ‹è¯•
âœ… å…¨éƒ¨é€šè¿‡

WebSocketè¿æ¥æµ‹è¯•
  âœ… æ— é—®é¢˜
  readyState: 1
  status: å·²è¿æ¥

PDFåˆ—è¡¨è·å–æµ‹è¯•
  âœ… æ— é—®é¢˜
  responseType: pdf/list
  hasRecords: true
  recordCount: 5
```

#### âŒ é”™è¯¯æŠ¥å‘Š
```
================
é€šä¿¡æµ‹è¯•æŠ¥å‘Š
================
å…± 2 é¡¹æµ‹è¯•
âŒ 3 ä¸ªé”™è¯¯
âš ï¸ 2 ä¸ªè­¦å‘Š

PDFåˆ—è¡¨è·å–æµ‹è¯•
  âŒ è®°å½•#1 (test.pdf): å­—æ®µ 'page_count' ç±»å‹é”™è¯¯: æœŸæœ› number, å®é™… string
  âŒ è®°å½•#2 (guide.pdf): ç¼ºå°‘å­—æ®µ: last_accessed_at
  âš ï¸ è®°å½•#3 (example.pdf): å­—æ®µå‘½åä¸ç¬¦åˆ snake_case: createdAt
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼1: ä½¿ç”¨å‰ç«¯æµ‹è¯•å·¥å…·ï¼ˆæ¨èï¼‰

```bash
# 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 2. æ‰“å¼€æµè§ˆå™¨è®¿é—® PDF-Home
# 3. ç‚¹å‡»å³ä¸‹è§’çš„ "ğŸ” é€šä¿¡æµ‹è¯•" æŒ‰é’®
```

### æ–¹å¼2: ä½¿ç”¨ Python è„šæœ¬

```bash
# 1. å¯åŠ¨åç«¯
cd src/backend
python main.py --module pdf-home --ws-port 8765

# 2. è¿è¡Œæµ‹è¯•
python quick_test.py 8765
```

## ğŸ’¡ æœ€ä½³å®è·µ

### å¼€å‘æµç¨‹å»ºè®®

1. **ä¿®æ”¹æ•°æ®æ ¼å¼å‰**
   - è¿è¡Œæµ‹è¯•å»ºç«‹åŸºçº¿
   - è®°å½•å½“å‰çš„å­—æ®µå’Œç±»å‹

2. **å¼€å‘è¿‡ç¨‹ä¸­**
   - é¢‘ç¹ç‚¹å‡»æµ‹è¯•æŒ‰é’®éªŒè¯
   - åŠæ—¶å‘ç°æ ¼å¼ä¸ä¸€è‡´

3. **å¼€å‘å®Œæˆå**
   - è¿è¡Œå®Œæ•´æµ‹è¯•
   - ç¡®ä¿æ‰€æœ‰æ£€æŸ¥é€šè¿‡
   - æ›´æ–° Schema å®šä¹‰

### å¸¸è§é—®é¢˜ä¿®å¤

#### é—®é¢˜1: å­—æ®µå‘½åä¸ä¸€è‡´
```javascript
// âŒ é”™è¯¯
{ pageCount: 10, createdAt: 1234567890 }

// âœ… æ­£ç¡®
{ page_count: 10, created_at: 1234567890 }
```

#### é—®é¢˜2: æ•°æ®ç±»å‹é”™è¯¯
```javascript
// âŒ é”™è¯¯
{ page_count: "10", file_size: "1024" }

// âœ… æ­£ç¡®
{ page_count: 10, file_size: 1024 }
```

#### é—®é¢˜3: æ—¶é—´æˆ³æ ¼å¼
```javascript
// âŒ é”™è¯¯ï¼ˆæ¯«ç§’ï¼‰
{ created_at: 1696262400000 }

// âœ… æ­£ç¡®ï¼ˆç§’ï¼‰
{ created_at: 1696262400 }
```

## ğŸ“ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹

ç¼–è¾‘ `communication-tester.js`ï¼š

```javascript
async testNewFeature(websocket) {
    const testResult = {
        name: 'æ–°åŠŸèƒ½æµ‹è¯•',
        issues: [],
        details: {}
    };

    // å‘é€è¯·æ±‚
    const request = { type: 'new/feature', data: {} };
    await this.wsClient.send(request);

    // éªŒè¯å“åº”
    // ...

    return testResult;
}

// åœ¨ runAllTests() ä¸­è°ƒç”¨
const newTest = await this.testNewFeature();
this.testResults.push(newTest);
```

### æ›´æ–° Schema å®šä¹‰

ä¿®æ”¹ `test_message_schemas.py` æˆ– `communication-tester.js` ä¸­çš„ Schemaï¼š

```javascript
const NEW_RECORD_SCHEMA = {
    // æ·»åŠ æ–°å­—æ®µ
    new_field: 'string',
    ...PDF_RECORD_SCHEMA
};
```

## ğŸ”„ åç»­ä¼˜åŒ–

### è®¡åˆ’åŠŸèƒ½

- [ ] æ”¯æŒæ›´å¤šæ¶ˆæ¯ç±»å‹æµ‹è¯•ï¼ˆæ·»åŠ ã€åˆ é™¤ã€æ›´æ–°ï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆå“åº”æ—¶é—´ç›‘æ§ï¼‰
- [ ] å¹¶å‘æµ‹è¯•ï¼ˆå¤šä¸ªè¯·æ±‚åŒæ—¶å‘é€ï¼‰
- [ ] æµ‹è¯•å†å²è®°å½•
- [ ] å¯¼å‡ºæµ‹è¯•æŠ¥å‘Šï¼ˆJSON/PDFï¼‰
- [ ] CI/CD é›†æˆ

### æ”¹è¿›å»ºè®®

1. **è‡ªåŠ¨åŒ–ç¨‹åº¦**ï¼šé›†æˆåˆ° Git hooksï¼Œæäº¤å‰è‡ªåŠ¨æµ‹è¯•
2. **è¦†ç›–èŒƒå›´**ï¼šå¢åŠ æ›´å¤šè¾¹ç•Œæ¡ä»¶æµ‹è¯•
3. **ç”¨æˆ·ä½“éªŒ**ï¼šå¢åŠ å¿«æ·é”®è§¦å‘æµ‹è¯•
4. **æŠ¥å‘ŠåŠŸèƒ½**ï¼šæ”¯æŒå¯¼å‡ºå’Œåˆ†äº«æµ‹è¯•ç»“æœ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é›†æˆæµ‹è¯•ä½¿ç”¨è¯´æ˜](INTEGRATION_TEST_README.md)
- [æ•°æ®æ ¼å¼å®šä¹‰](test_message_schemas.py)
- [å‰ç«¯æµ‹è¯•å·¥å…·](src/frontend/pdf-home/utils/communication-tester.js)

## âœ… æ€»ç»“

é€šè¿‡è¿™å¥—å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š

1. **åŠæ—©å‘ç°é—®é¢˜**ï¼šå¼€å‘è¿‡ç¨‹ä¸­å®æ—¶éªŒè¯
2. **æé«˜æ•ˆç‡**ï¼šè‡ªåŠ¨åŒ–æ£€æµ‹ï¼Œæ— éœ€æ‰‹åŠ¨å¯¹æ¯”
3. **ä¿è¯è´¨é‡**ï¼šç¡®ä¿å‰åç«¯æ•°æ®æ ¼å¼ä¸€è‡´
4. **é™ä½æˆæœ¬**ï¼šå‡å°‘å› æ ¼å¼é”™è¯¯å¯¼è‡´çš„è°ƒè¯•æ—¶é—´

å·¥å…·å·²é›†æˆåˆ° PDF-Home å¼€å‘ç¯å¢ƒï¼Œå¼€ç®±å³ç”¨ï¼ğŸ‰
