---
title: 原子任务说明（模板）
author: Job-Executor
file_version: 1.0
input:
  - AITASK/[序号-项目名]/v[版本号]/[任务组别编号]/[YYYYMMDDhhmmss]-分组任务说明.md
  - AITASK/[序号-项目名]/v[版本号]/[任务组别编号]/[YYYYMMDDhhmmss]-API用例说明.md
usage: 描述单个原子任务的详细需求、DoD、执行步骤与产物路径，供 Job-Executor 执行
---

<!-- 用途：快速理解任务目标 -->
# 概要

### 业务背景与目标
- 简短描述业务背景、为什么需要此原子任务以及交付目标。
- 示例：该任务用于实现数据导入接口的单元处理，保证输入数据被校验并写入目标表。

<!-- 用途：提供任务元信息 -->
# 任务基本信息

- 任务 ID: TSK-XXXX（占位）
- 任务名称: 原子任务示例（占位）
- 所属分组: GRP-YYYY（占位）
- 负责人: 张三（占位）
- 估时: 4h（占位）
- 优先级: 中（Low/Medium/High）

<!-- 用途：逐步描述工作内容与边界 -->
# 任务描述

详细说明任务步骤、边界条件、输入与输出。

### 输入（示例）
- 文档/输入文件：[`AITASK/000-示例/v1/001/20250101123000-分组任务说明.md`](AITASK/000-示例/v1/001/20250101123000-分组任务说明.md:1)
- API请求样例：JSON 或 CSV 文件

### 输出（示例）
- 目标文件/产物：[`outputs/result.json`](outputs/result.json:1)

### 处理步骤（编号）
1. 准备环境（安装依赖、拉取代码或数据）。
2. 校验输入格式与完整性。
3. 执行核心处理逻辑（按用例逐条处理）。
4. 生成产物并写入指定路径。
5. 运行产物校验脚本并记录结果。

<!-- 用途：明确定义可验收的条件 -->
# 完成定义（DoD）

- 所有必需输入存在且通过格式校验（示例检查）。
- 处理逻辑在本地/CI 上可重复执行且无错误退出码。
- 产物文件已生成且通过校验（示例：JSON schema、SHA256、行数）。
- 必要日志已记录至指定位置并包含关键字段（见日志与监控点）。

### 验收要点与校验方法
- 自动校验：运行脚本校验产物（示例命令见下方执行/测试指南）。
- 手动校验：审阅产物示例与日志摘要，确认业务规则被正确执行。

<!-- 用途：列出外部依赖，避免误触发 -->
# 依赖与前置条件

- 依赖服务：数据库实例、消息队列、外部 API 等（列出详细地址/凭证位置）。
- 依赖任务/文件：
  - [`templates/原子任务汇总.md`](templates/原子任务汇总.md:1)
  - 任务 ID 参考：TSK-YYYY
- 前置条件：数据准备完成、凭证可用、CI 环境变量已配置。

<!-- 用途：指明生成文件/路径用于后续查证 -->
# 预期产物

- 主要产物（示例）：
  - [`outputs/result.json`](outputs/result.json:1)
  - [`logs/processing.log`](logs/processing.log:1)

### 路径与文件名示例（代码块）
```text
[`outputs/result.json`](outputs/result.json:1)
[`logs/processing.log`](logs/processing.log:1)
```

<!-- 用途：指导 Job-Executor 真正运行与测试 -->
# 执行/测试指南

- 环境要求：Python 3.10+, Node 18+, 或指定镜像。
- 建议使用 Docker 以保证一致性。

### 示例：使用 Docker 运行（bash）
```bash
# 构建镜像（示例）
docker build -t task-runner:latest .
# 运行任务（示例）
docker run --rm -v $(pwd):/work -w /work task-runner:latest bash -c "python scripts/run_task.py --input inputs/sample.json --output outputs/result.json"
```

### 示例：本地（PowerShell / Bash）
```bash
# 安装依赖（示例）
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
# 运行处理脚本
python scripts/run_task.py --input inputs/sample.json --output outputs/result.json
```

### 产物校验示例脚本片段（bash）
```bash
# 校验文件存在
test -f outputs/result.json && echo "OK: file exists" || (echo "MISSING"; exit 1)
# 校验 JSON schema（需安装 ajv 或 python jsonschema）
jq empty outputs/result.json || (echo "INVALID JSON"; exit 2)
# 计算 SHA256
sha256sum outputs/result.json | awk '{print $1}' > outputs/result.json.sha256
```

<!-- 用途：定义需要追踪的日志与指标 -->
# 日志与监控点

- 必须记录的日志字段：
  - timestamp（ISO8601）
  - task_id
  - record_count / processed_count / error_count
  - duration_ms
- 关键监控指标与阈值：
  - error_count > 0 触发告警
  - duration_ms > 60000 触发性能警报

<!-- 用途：出现异常时的安全回退流程 -->
# 回滚/异常处理策略

- 出现错误时首先停止后续处理并记录完整日志。
- 回退步骤（示例）：
  1. 停止消费/调度任务。
  2. 恢复到上一个稳定产物（如有），示例路径：[`outputs/result.json.bak`](outputs/result.json.bak:1)
  3. 通知负责人，并在 issue 中记录失败上下文与日志摘要。
- 联系信息：负责人邮箱（占位）/ Oncall 值班（占位）。

<!-- 用途：追踪模板的历史修改 -->
# 变更记录

| 版本 | 修改人 | 修改时间(YYYYMMDDhhmmss) | 说明 |
|---|---|---:|---|
| 1.0 | Job-Executor | 20250...（占位） | 初始模板 |

<!-- 用途：列出所有参考资料 -->
# 参考文档与输入

- 必须参考：
  - [`docs/articles/开发流程设计.md`](docs/articles/开发流程设计.md:1)
  - [`docs/articles/AITASK项目工程文件目录结构.md`](docs/articles/AITASK项目工程文件目录结构.md:1)
  - kilocode 相关提示词：
    - [`kilocode/system-prompt-job-executor`](kilocode/system-prompt-job-executor:1)
    - [`kilocode/system-prompt-code-generator`](kilocode/system-prompt-code-generator:1)
    - [`kilocode/system-prompt-test-designer`](kilocode/system-prompt-test-designer:1)

<!-- 用途：维护与联系人信息 -->
# 模板维护信息

- 作者: Job-Executor（或 Task-Design-Manager）
- 创建时间(占位): YYYYMMDDhhmmss
- 联系方式: 邮箱/团队群（占位）
- 修改流程：提交 PR -> Code Review -> 合并 -> 更新变更记录

<!-- 用途：提供可立即使用的示例，便于 Job-Executor 执行 -->
# 示例填充（可执行示例）

### 示例任务：导入用户数据（完整填充）
- 任务 ID: TSK-20250801-IMPORT-USER
- 任务名称: 用户数据导入
- 所属分组: 数据导入组
- 负责人: 李四
- 估时: 6h
- 优先级: 高

#### 输入
- [`inputs/users.csv`](inputs/users.csv:1)

#### 处理步骤
1. 在开发环境创建虚拟环境并安装依赖。
2. 运行数据校验脚本：`python scripts/validate_users.py inputs/users.csv`
3. 运行导入脚本并生成产物：`python scripts/import_users.py --in inputs/users.csv --out outputs/result.json`
4. 校验产物：见下方校验命令

#### DoD（示例）
- outputs/result.json 存在且为有效 JSON。
- records_processed == CSV 行数（减去表头）。
- logs/processing.log 包含 "Import completed" 字样。

#### 执行示例命令（bash）
```bash
# 校验输入存在
test -f inputs/users.csv || (echo "inputs missing"; exit 1)
# 运行导入并校验
python scripts/import_users.py --in inputs/users.csv --out outputs/result.json
jq '.records | length' outputs/result.json
```

#### 示例校验断言（bash）
```bash
# 断言产物为有效 JSON 并包含 records 字段
jq -e '.records and (.records | type == "array")' outputs/result.json || (echo "invalid"; exit 2)
# 断言日志包含成功标记
grep -q "Import completed" logs/processing.log || (echo "log missing"; exit 3)
```

### 示例输出断言（示例文本）
- outputs/result.json:
```json
{
  "task_id": "TSK-20250801-IMPORT-USER",
  "records": [ /* ... */ ],
  "summary": { "processed": 100, "errors": 0 }
}
```

<!-- 用途：说明模板的覆盖与使用限制 -->
# 附注与限制

- 本模板为通用原子任务说明模板，使用时请替换所有占位字段。
- 严禁在本次操作中修改仓库中其他文件。

<!-- 用途：模板结束标识 -->
# 结束