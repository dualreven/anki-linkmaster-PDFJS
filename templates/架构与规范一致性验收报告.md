title: 架构与规范一致性验收报告（模板）
author: Conflict-Detector
file_version: 1.0
input:
  - [`AITASK/[序号-项目名]/v[版本号]/[YYYYMMDDhhmmss]-架构说明.md`](AITASK/[序号-项目名]/v1/[YYYYMMDDhhmmss]-架构说明.md:1)
  - [`AITASK/[序号-项目名]/v[版本号]/[YYYYMMDDhhmmss]-规范说明.md`](AITASK/[序号-项目名]/v1/[YYYYMMDDhhmmss]-规范说明.md:1)
usage: 用于记录架构与规范之间的一致性检查结果、冲突清单、优先级与修复建议，供 ArchSpec-Manager 汇总与下游处理
```

<!-- 用途：快速理解检查结论 -->
# 概要
简短描述本次一致性检查的目的、范围与结论摘要（通过/未通过），突出最重要的冲突与建议。

<!-- 用途：明确检查依据与限制 -->
# 输入与范围
- 输入文件（来源）：
  - [`AITASK/[序号-项目名]/v[版本号]/[YYYYMMDDhhmmss]-架构说明.md`](AITASK/[序号-项目名]/v1/[YYYYMMDDhhmmss]-架构说明.md:1)
  - [`AITASK/[序号-项目名]/v[版本号]/[YYYYMMDDhhmmss]-规范说明.md`](AITASK/[序号-项目名]/v1/[YYYYMMDDhhmmss]-规范说明.md:1)
  - 其它补充材料：（列出相对路径）
- 检查边界：明确哪些模块/接口/数据模型包含在检查范围内，哪些被排除

<!-- 用途：说明如何执行一致性检查 -->
# 检查方法与工具
- 自动化比对规则：列出所用规则/脚本/工具（示例）
  - 使用脚本：[`scripts/一致性比对.py`](scripts/一致性比对.py:1)（示例）
- 手工复核步骤：列出人工检查流程
- 比对策略：字段对齐、类型比对、接口契约检查、错误码一致性校验等

<!-- 用途：快速把握总体态势 -->
# 检查结果总览
- 结论：通过 / 不通过
- 关键统计（示例）：
  - 接口不一致数：0
  - 数据模型差异数：0
  - 错误码不一致数：0
  - 总冲突数：0

<!-- 用途：逐条说明冲突、影响范围、定位、证据、建议修复措施 -->
# 冲突/不一致清单
说明：本清单使用可机器解析的表格格式，每行代表一条冲突，便于自动化生成修复子任务。

| ID | 类型 | 描述 | 影响范围 | 严重度 | 建议修复（new_task 模板） | 责任人（建议） | 优先级 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| CD-001 | 接口 | 示例：GET /users 返回字段 userId 与规范不一致 | 用户服务 / API 层 | 高 | see 下方 new_task 模板 | 接口 owner | P1 |

<!-- 用途：展示机器可读的冲突结构（JSON/YAML）供自动化使用 -->
### 结构化样例（YAML）
```yaml
- id: CD-001
  type: 接口
  description: "GET /users 返回字段 userId 与规范不一致"
  scope: "用户服务"
  severity: 高
  evidence:
    - file: "AITASK/001-示例/v1/20250101010101-架构说明.md"
      line: 123
    - file: "AITASK/001-示例/v1/20250101010101-规范说明.md"
      line: 45
  suggested_fix: |
    请将架构中字段 userId 改为 user_id，或在规范中统一为 userId；详见建议 new_task。
  suggested_new_task:
    title: 修复 CD-001：统一 GET /users userId 字段名
    assignee: 接口 owner
    description: |
      说明问题、修改文件路径与具体变更点、更新自动化测试，提交 PR 并通知相关方。
```

<!-- 用途：提供自动化比对产生的细节输出 -->
# 自动化比对明细
- 若有，附上字段差异表格或示例对比（可用 CSV / 表格形式）

<!-- 用途：说明哪些冲突是阻塞性问题及其后果 -->
# 风险与阻塞判定
- 阻塞性问题判定标准（示例）
- 当前阻塞项列表（若有）

<!-- 用途：给出修复顺序与可直接执行的任务模板 -->
# 建议的修复计划与优先级
- 总体修复建议（按优先级）
- 可直接创建的修复子任务模板（示例）

### 修复子任务 new_task 示例（可直接复制）
```yaml
title: 修复 CD-001：统一 GET /users userId 字段名
mode: code
assignee: 接口 owner
todos:
- [ ] 分析冲突并确认变更范围
- [ ] 更新架构说明（[`AITASK/.../架构说明.md`](AITASK/.../架构说明.md:1)）
- [ ] 更新规范说明（[`AITASK/.../规范说明.md`](AITASK/.../规范说明.md:1)）
- [ ] 修改实现并添加兼容层（如需）
- [ ] 编写/更新自动化回归测试
- [ ] 提交 PR 并关联本冲突 ID
- [ ] 通知相关责任人并验证通过
description: |
  详细说明冲突背景、受影响模块、测试验证要求与验收条件。
```

<!-- 用途：说明验收需满足的条件 -->
# 验收通过条件
- 所有冲突被关闭且对应 PR 被合并，或有明确的兼容方案并通过回归测试
- 自动化检查再次运行结果为 0 个高/中/阻塞性冲突

<!-- 用途：给出结论与后续动作 -->
# 结论与下一步
- 通过 / 不通过（填入结论）
- 建议行动项（含责任人、截止时间）

<!-- 用途：列出本报告产生的产出文件与位置 -->
# 产出清单
- 报告文件：[`templates/架构与规范一致性验收报告.md`](templates/架构与规范一致性验收报告.md:1)
- 补充材料（列出路径）
- 生成时间戳：YYYYMMDDhhmmss

<!-- 用途：列出引用的参考文档 -->
# 参考文档
- [`docs/articles/开发流程设计.md`](docs/articles/开发流程设计.md:1)
- [`docs/articles/AITASK项目工程文件目录结构.md`](docs/articles/AITASK项目工程文件目录结构.md:1)
- [`kilocode/system-prompt-conflict-detector`](kilocode/system-prompt-conflict-detector:1)
- [`kilocode/system-prompt-archspec-manager`](kilocode/system-prompt-archspec-manager:1)

<!-- 用途：记录模板变更历史 -->
# 变更记录
| 版本 | 修改人 | 日期（YYYYMMDDhhmmss） | 说明 |
| --- | --- | --- | --- |
| 1.0 | Conflict-Detector | YYYYMMDDhhmmss | 初始模板

<!-- 用途：模板维护信息 -->
# 模板维护信息
- 作者：Conflict-Detector
- 创建时间：YYYYMMDDhhmmss
- 联系方式：kilocode/Conflict-Detector（或填写邮箱）
- 修改流程：提交 PR -> Review -> 合并 -> 更新版本号

<!-- 用途：示例填充，包含 1 个完整冲突项的记录示例 -->
# 示例填充（含 1 个冲突项）
<!-- 用途：示例帮助阅读者理解如何填写 -->

## 冲突示例：CD-001
| ID | 类型 | 描述 | 影响范围 | 严重度 | 建议修复 | 责任人 | 优先级 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| CD-001 | 接口 | GET /users 返回字段 userId 与规范中 user_id 命名不一致 | 用户服务（User API） | 高 | 参见下方 new_task 示例 | 张三（接口 owner） | P1 |

### 证据
- 架构说明：[`AITASK/001-示例/v1/20250101010101-架构说明.md`](AITASK/001-示例/v1/20250101010101-架构说明.md:1) 行 123
- 规范说明：[`AITASK/001-示例/v1/20250101010101-规范说明.md`](AITASK/001-示例/v1/20250101010101-规范说明.md:1) 行 45

### 建议修复（具体）
- 建议将架构字段改为 `user_id`；如无法兼容，则在接口中新增兼容字段并注明废弃计划。

### 对应 new_task（示例）
```yaml
title: 修复 CD-001：统一 GET /users userId 字段名
mode: code
assignee: 张三
todos:
- [ ] 确认变更范围并更新架构说明
- [ ] 更新规范说明并通知相关团队
- [ ] 修改服务实现并添加兼容逻辑
- [ ] 添加回归测试并验证
- [ ] 提交 PR 并关联 CD-001
description: |
  本任务用于修复 CD-001：统一 GET /users 返回字段命名，详见报告与参考文档。
```

<!-- 用途：说明本模板编码与行结束要求 -->
# 附录：文件与格式要求
- 文件编码：UTF-8（无 BOM）
- 换行：LF（Unix 风格）

<!-- 用途：结束语 -->
---
本模板由 Conflict-Detector 生成，用于标准化架构与规范一致性验收报告结构。请在使用前依据项目实际情况调整输入路径与样例内容。