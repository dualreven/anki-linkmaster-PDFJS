function _mergeNamespaces(T,t){for(var _=0;_<t.length;_++){const e=t[_];if(typeof e!="string"&&!Array.isArray(e)){for(const r in e)if(r!=="default"&&!(r in T)){const R=Object.getOwnPropertyDescriptor(e,r);R&&Object.defineProperty(T,r,R.get?R:{enumerable:!0,get:()=>e[r]})}}}return Object.freeze(Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}))}function getDefaultExportFromCjs(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}function getAugmentedNamespace(T){if(T.__esModule)return T;var t=T.default;if(typeof t=="function"){var _=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};_.prototype=t.prototype}else _={};return Object.defineProperty(_,"__esModule",{value:!0}),Object.keys(T).forEach(function(e){var r=Object.getOwnPropertyDescriptor(T,e);Object.defineProperty(_,e,r.get?r:{enumerable:!0,get:function(){return T[e]}})}),_}function commonjsRequire(T){throw new Error('Could not dynamically require "'+T+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$2={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){function _classPrivateGetter(T,t,_){return _(_assertClassBrand(T,t))}function _defineProperty(T,t,_){return(t=_toPropertyKey(t))in T?Object.defineProperty(T,t,{value:_,enumerable:!0,configurable:!0,writable:!0}):T[t]=_,T}function _toPropertyKey(T){var t=_toPrimitive(T,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive(T,t){if(typeof T!="object"||!T)return T;var _=T[Symbol.toPrimitive];if(_!==void 0){var e=_.call(T,t);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(T)}function _classPrivateMethodInitSpec(T,t){_checkPrivateRedeclaration(T,t),t.add(T)}function _classPrivateFieldInitSpec(T,t,_){_checkPrivateRedeclaration(T,t),t.set(T,_)}function _checkPrivateRedeclaration(T,t){if(t.has(T))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(T,t){return T.get(_assertClassBrand(T,t))}function _classPrivateFieldSet(T,t,_){return T.set(_assertClassBrand(T,t),_),_}function _assertClassBrand(T,t,_){if(typeof T=="function"?T===t:T.has(t))return arguments.length<3?t:_;throw new TypeError("Private element is not present on this object")}(function(t,_){module.exports=t.pdfjsLib=_()})(globalThis,()=>(()=>{var __webpack_modules__=[,(T,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=N,t.bytesToString=at,t.createValidAbsoluteUrl=v,t.getModificationDate=Lt,t.getUuid=jt,t.getVerbosityLevel=et,t.info=_t,t.isArrayBuffer=kt,t.isArrayEqual=Mt,t.isNodeJS=void 0,t.normalizeUnicode=Ut,t.objectFromMap=W,t.objectSize=At,t.setVerbosityLevel=$,t.shadow=s,t.string32=ft,t.stringToBytes=dt,t.stringToPDFString=st,t.stringToUTF8String=it,t.unreachable=b,t.utf8StringToString=St,t.warn=X;const _=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=_;const e=[1,0,0,1,0,0];t.IDENTITY_MATRIX=e;const r=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=r;const R=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=R;const L=1.35;t.LINE_FACTOR=L;const V=.35;t.LINE_DESCENT_FACTOR=V;const D=V/L;t.BASELINE_FACTOR=D;const f={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=f;const A={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=A;const M="pdfjs_internal_editor_";t.AnnotationEditorPrefix=M;const p={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorType=p;const m={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.AnnotationEditorParamsType=m;const S={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=S;const u={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=u;const d={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=d;const n={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=n;const l={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=l;const F={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=F;const y={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=y;const a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=a;const o={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=o;const w={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=w;const Y={O:"PageOpen",C:"PageClose"};t.PageActionEventType=Y;const B={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=B;const g={NONE:0,BINARY:1};t.CMapCompressionType=g;const P={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=P;const q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=q;let Q=B.WARNINGS;function $(pt){Number.isInteger(pt)&&(Q=pt)}function et(){return Q}function _t(pt){Q>=B.INFOS&&console.log(`Info: ${pt}`)}function X(pt){Q>=B.WARNINGS&&console.log(`Warning: ${pt}`)}function b(pt){throw new Error(pt)}function N(pt,tt){pt||b(tt)}function rt(pt){switch(pt==null?void 0:pt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function v(pt){let tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!pt)return null;try{if(J&&typeof pt=="string"){if(J.addDefaultProtocol&&pt.startsWith("www.")){const x=pt.match(/\./g);(x==null?void 0:x.length)>=2&&(pt=`http://${pt}`)}if(J.tryConvertEncoding)try{pt=it(pt)}catch{}}const gt=tt?new URL(pt,tt):new URL(pt);if(rt(gt))return gt}catch{}return null}function s(pt,tt,J){let gt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Object.defineProperty(pt,tt,{value:J,enumerable:!gt,configurable:!0,writable:!1}),J}const i=function(){function tt(J,gt){this.constructor===tt&&b("Cannot initialize BaseException."),this.message=J,this.name=gt}return tt.prototype=new Error,tt.constructor=tt,tt}();t.BaseException=i;class h extends i{constructor(tt,J){super(tt,"PasswordException"),this.code=J}}t.PasswordException=h;class E extends i{constructor(tt,J){super(tt,"UnknownErrorException"),this.details=J}}t.UnknownErrorException=E;class C extends i{constructor(tt){super(tt,"InvalidPDFException")}}t.InvalidPDFException=C;class U extends i{constructor(tt){super(tt,"MissingPDFException")}}t.MissingPDFException=U;class H extends i{constructor(tt,J){super(tt,"UnexpectedResponseException"),this.status=J}}t.UnexpectedResponseException=H;class K extends i{constructor(tt){super(tt,"FormatError")}}t.FormatError=K;class ot extends i{constructor(tt){super(tt,"AbortException")}}t.AbortException=ot;function at(pt){(typeof pt!="object"||(pt==null?void 0:pt.length)===void 0)&&b("Invalid argument for bytesToString");const tt=pt.length,J=8192;if(tt<J)return String.fromCharCode.apply(null,pt);const gt=[];for(let x=0;x<tt;x+=J){const nt=Math.min(x+J,tt),vt=pt.subarray(x,nt);gt.push(String.fromCharCode.apply(null,vt))}return gt.join("")}function dt(pt){typeof pt!="string"&&b("Invalid argument for stringToBytes");const tt=pt.length,J=new Uint8Array(tt);for(let gt=0;gt<tt;++gt)J[gt]=pt.charCodeAt(gt)&255;return J}function ft(pt){return String.fromCharCode(pt>>24&255,pt>>16&255,pt>>8&255,pt&255)}function At(pt){return Object.keys(pt).length}function W(pt){const tt=Object.create(null);for(const[J,gt]of pt)tt[J]=gt;return tt}function k(){const pt=new Uint8Array(4);return pt[0]=1,new Uint32Array(pt.buffer,0,1)[0]===1}function G(){try{return new Function(""),!0}catch{return!1}}class O{static get isLittleEndian(){return s(this,"isLittleEndian",k())}static get isEvalSupported(){return s(this,"isEvalSupported",G())}static get isOffscreenCanvasSupported(){return s(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?s(this,"platform",{isWin:!1,isMac:!1}):s(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var tt,J;return s(this,"isCSSRoundSupported",(tt=globalThis.CSS)===null||tt===void 0||(J=tt.supports)===null||J===void 0?void 0:J.call(tt,"width: round(1.5px, 1px)"))}}t.FeatureTest=O;const j=[...Array(256).keys()].map(pt=>pt.toString(16).padStart(2,"0"));class lt{static makeHexColor(tt,J,gt){return`#${j[tt]}${j[J]}${j[gt]}`}static scaleMinMax(tt,J){let gt;tt[0]?(tt[0]<0&&(gt=J[0],J[0]=J[1],J[1]=gt),J[0]*=tt[0],J[1]*=tt[0],tt[3]<0&&(gt=J[2],J[2]=J[3],J[3]=gt),J[2]*=tt[3],J[3]*=tt[3]):(gt=J[0],J[0]=J[2],J[2]=gt,gt=J[1],J[1]=J[3],J[3]=gt,tt[1]<0&&(gt=J[2],J[2]=J[3],J[3]=gt),J[2]*=tt[1],J[3]*=tt[1],tt[2]<0&&(gt=J[0],J[0]=J[1],J[1]=gt),J[0]*=tt[2],J[1]*=tt[2]),J[0]+=tt[4],J[1]+=tt[4],J[2]+=tt[5],J[3]+=tt[5]}static transform(tt,J){return[tt[0]*J[0]+tt[2]*J[1],tt[1]*J[0]+tt[3]*J[1],tt[0]*J[2]+tt[2]*J[3],tt[1]*J[2]+tt[3]*J[3],tt[0]*J[4]+tt[2]*J[5]+tt[4],tt[1]*J[4]+tt[3]*J[5]+tt[5]]}static applyTransform(tt,J){const gt=tt[0]*J[0]+tt[1]*J[2]+J[4],x=tt[0]*J[1]+tt[1]*J[3]+J[5];return[gt,x]}static applyInverseTransform(tt,J){const gt=J[0]*J[3]-J[1]*J[2],x=(tt[0]*J[3]-tt[1]*J[2]+J[2]*J[5]-J[4]*J[3])/gt,nt=(-tt[0]*J[1]+tt[1]*J[0]+J[4]*J[1]-J[5]*J[0])/gt;return[x,nt]}static getAxialAlignedBoundingBox(tt,J){const gt=this.applyTransform(tt,J),x=this.applyTransform(tt.slice(2,4),J),nt=this.applyTransform([tt[0],tt[3]],J),vt=this.applyTransform([tt[2],tt[1]],J);return[Math.min(gt[0],x[0],nt[0],vt[0]),Math.min(gt[1],x[1],nt[1],vt[1]),Math.max(gt[0],x[0],nt[0],vt[0]),Math.max(gt[1],x[1],nt[1],vt[1])]}static inverseTransform(tt){const J=tt[0]*tt[3]-tt[1]*tt[2];return[tt[3]/J,-tt[1]/J,-tt[2]/J,tt[0]/J,(tt[2]*tt[5]-tt[4]*tt[3])/J,(tt[4]*tt[1]-tt[5]*tt[0])/J]}static singularValueDecompose2dScale(tt){const J=[tt[0],tt[2],tt[1],tt[3]],gt=tt[0]*J[0]+tt[1]*J[2],x=tt[0]*J[1]+tt[1]*J[3],nt=tt[2]*J[0]+tt[3]*J[2],vt=tt[2]*J[1]+tt[3]*J[3],xt=(gt+vt)/2,It=Math.sqrt((gt+vt)**2-4*(gt*vt-nt*x))/2,Gt=xt+It||1,bt=xt-It||1;return[Math.sqrt(Gt),Math.sqrt(bt)]}static normalizeRect(tt){const J=tt.slice(0);return tt[0]>tt[2]&&(J[0]=tt[2],J[2]=tt[0]),tt[1]>tt[3]&&(J[1]=tt[3],J[3]=tt[1]),J}static intersect(tt,J){const gt=Math.max(Math.min(tt[0],tt[2]),Math.min(J[0],J[2])),x=Math.min(Math.max(tt[0],tt[2]),Math.max(J[0],J[2]));if(gt>x)return null;const nt=Math.max(Math.min(tt[1],tt[3]),Math.min(J[1],J[3])),vt=Math.min(Math.max(tt[1],tt[3]),Math.max(J[1],J[3]));return nt>vt?null:[gt,nt,x,vt]}static bezierBoundingBox(tt,J,gt,x,nt,vt,xt,It){const Gt=[],bt=[[],[]];let c,I,z,Z,ct,ht,mt,Tt;for(let Ct=0;Ct<2;++Ct){if(Ct===0?(I=6*tt-12*gt+6*nt,c=-3*tt+9*gt-9*nt+3*xt,z=3*gt-3*tt):(I=6*J-12*x+6*vt,c=-3*J+9*x-9*vt+3*It,z=3*x-3*J),Math.abs(c)<1e-12){if(Math.abs(I)<1e-12)continue;Z=-z/I,0<Z&&Z<1&&Gt.push(Z);continue}mt=I*I-4*z*c,Tt=Math.sqrt(mt),!(mt<0)&&(ct=(-I+Tt)/(2*c),0<ct&&ct<1&&Gt.push(ct),ht=(-I-Tt)/(2*c),0<ht&&ht<1&&Gt.push(ht))}let Et=Gt.length,Pt;const Dt=Et;for(;Et--;)Z=Gt[Et],Pt=1-Z,bt[0][Et]=Pt*Pt*Pt*tt+3*Pt*Pt*Z*gt+3*Pt*Z*Z*nt+Z*Z*Z*xt,bt[1][Et]=Pt*Pt*Pt*J+3*Pt*Pt*Z*x+3*Pt*Z*Z*vt+Z*Z*Z*It;return bt[0][Dt]=tt,bt[1][Dt]=J,bt[0][Dt+1]=xt,bt[1][Dt+1]=It,bt[0].length=bt[1].length=Dt+2,[Math.min(...bt[0]),Math.min(...bt[1]),Math.max(...bt[0]),Math.max(...bt[1])]}}t.Util=lt;const ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function st(pt){if(pt[0]>="ï"){let J;if(pt[0]==="þ"&&pt[1]==="ÿ"?J="utf-16be":pt[0]==="ÿ"&&pt[1]==="þ"?J="utf-16le":pt[0]==="ï"&&pt[1]==="»"&&pt[2]==="¿"&&(J="utf-8"),J)try{const gt=new TextDecoder(J,{fatal:!0}),x=dt(pt);return gt.decode(x)}catch(gt){X(`stringToPDFString: "${gt}".`)}}const tt=[];for(let J=0,gt=pt.length;J<gt;J++){const x=ut[pt.charCodeAt(J)];tt.push(x?String.fromCharCode(x):pt.charAt(J))}return tt.join("")}function it(pt){return decodeURIComponent(escape(pt))}function St(pt){return unescape(encodeURIComponent(pt))}function kt(pt){return typeof pt=="object"&&(pt==null?void 0:pt.byteLength)!==void 0}function Mt(pt,tt){if(pt.length!==tt.length)return!1;for(let J=0,gt=pt.length;J<gt;J++)if(pt[J]!==tt[J])return!1;return!0}function Lt(){let pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return[pt.getUTCFullYear().toString(),(pt.getUTCMonth()+1).toString().padStart(2,"0"),pt.getUTCDate().toString().padStart(2,"0"),pt.getUTCHours().toString().padStart(2,"0"),pt.getUTCMinutes().toString().padStart(2,"0"),pt.getUTCSeconds().toString().padStart(2,"0")].join("")}var Rt=new WeakMap;class Ft{constructor(){_classPrivateFieldInitSpec(this,Rt,!1),this.promise=new Promise((tt,J)=>{this.resolve=gt=>{_classPrivateFieldSet(Rt,this,!0),tt(gt)},this.reject=gt=>{_classPrivateFieldSet(Rt,this,!0),J(gt)}})}get settled(){return _classPrivateFieldGet(Rt,this)}}t.PromiseCapability=Ft;let yt=null,Wt=null;function Ut(pt){return yt||(yt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Wt=new Map([["ﬅ","ſt"]])),pt.replaceAll(yt,(tt,J,gt)=>J?J.normalize("NFKC"):Wt.get(gt))}function jt(){var pt,tt;if(typeof crypto<"u"&&typeof((pt=crypto)===null||pt===void 0?void 0:pt.randomUUID)=="function")return crypto.randomUUID();const J=new Uint8Array(32);if(typeof crypto<"u"&&typeof((tt=crypto)===null||tt===void 0?void 0:tt.getRandomValues)=="function")crypto.getRandomValues(J);else for(let gt=0;gt<32;gt++)J[gt]=Math.floor(Math.random()*255);return at(J)}const $t="pdfjs_internal_id_";t.AnnotationPrefix=$t},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(T){var t,_;if(typeof T=="string"||T instanceof URL?T={url:T}:(0,_util.isArrayBuffer)(T)&&(T={data:T}),typeof T!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!T.url&&!T.data&&!T.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new PDFDocumentLoadingTask,{docId:r}=e,R=T.url?getUrlProp(T.url):null,L=T.data?getDataProp(T.data):null,V=T.httpHeaders||null,D=T.withCredentials===!0,f=(t=T.password)!==null&&t!==void 0?t:null,A=T.range instanceof PDFDataRangeTransport?T.range:null,M=Number.isInteger(T.rangeChunkSize)&&T.rangeChunkSize>0?T.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let p=T.worker instanceof PDFWorker?T.worker:null;const m=T.verbosity,S=typeof T.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(T.docBaseUrl)?T.docBaseUrl:null,u=typeof T.cMapUrl=="string"?T.cMapUrl:null,d=T.cMapPacked!==!1,n=T.CMapReaderFactory||DefaultCMapReaderFactory,l=typeof T.standardFontDataUrl=="string"?T.standardFontDataUrl:null,F=T.StandardFontDataFactory||DefaultStandardFontDataFactory,y=T.stopAtErrors!==!0,a=Number.isInteger(T.maxImageSize)&&T.maxImageSize>-1?T.maxImageSize:-1,o=T.isEvalSupported!==!1,w=typeof T.isOffscreenCanvasSupported=="boolean"?T.isOffscreenCanvasSupported:!_util.isNodeJS,Y=Number.isInteger(T.canvasMaxAreaInBytes)?T.canvasMaxAreaInBytes:-1,B=typeof T.disableFontFace=="boolean"?T.disableFontFace:_util.isNodeJS,g=T.fontExtraProperties===!0,P=T.enableXfa===!0,q=T.ownerDocument||globalThis.document,Q=T.disableRange===!0,$=T.disableStream===!0,et=T.disableAutoFetch===!0,_t=T.pdfBug===!0,X=A?A.length:(_=T.length)!==null&&_!==void 0?_:NaN,b=typeof T.useSystemFonts=="boolean"?T.useSystemFonts:!_util.isNodeJS&&!B,N=typeof T.useWorkerFetch=="boolean"?T.useWorkerFetch:n===_display_utils.DOMCMapReaderFactory&&F===_display_utils.DOMStandardFontDataFactory&&u&&l&&(0,_display_utils.isValidFetchUrl)(u,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(l,document.baseURI),rt=T.canvasFactory||new DefaultCanvasFactory({ownerDocument:q}),v=T.filterFactory||new DefaultFilterFactory({docId:r,ownerDocument:q}),s=null;(0,_util.setVerbosityLevel)(m);const i={canvasFactory:rt,filterFactory:v};if(N||(i.cMapReaderFactory=new n({baseUrl:u,isCompressed:d}),i.standardFontDataFactory=new F({baseUrl:l})),!p){const C={verbosity:m,port:_worker_options.GlobalWorkerOptions.workerPort};p=C.port?PDFWorker.fromPort(C):new PDFWorker(C),e._worker=p}const h={docId:r,apiVersion:"3.11.174",data:L,password:f,disableAutoFetch:et,rangeChunkSize:M,length:X,docBaseUrl:S,enableXfa:P,evaluatorOptions:{maxImageSize:a,disableFontFace:B,ignoreErrors:y,isEvalSupported:o,isOffscreenCanvasSupported:w,canvasMaxAreaInBytes:Y,fontExtraProperties:g,useSystemFonts:b,cMapUrl:N?u:null,standardFontDataUrl:N?l:null}},E={ignoreErrors:y,isEvalSupported:o,disableFontFace:B,fontExtraProperties:g,enableXfa:P,ownerDocument:q,disableAutoFetch:et,pdfBug:_t,styleElement:s};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const C=_fetchDocument(p,h),U=new Promise(function(H){let K;A?K=new _transport_stream.PDFDataTransportStream({length:X,initialData:A.initialData,progressiveDone:A.progressiveDone,contentDispositionFilename:A.contentDispositionFilename,disableRange:Q,disableStream:$},A):L||(K=(at=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(at):(0,_display_utils.isValidFetchUrl)(at.url)?new _displayFetch_stream.PDFFetchStream(at):new _displayNetwork.PDFNetworkStream(at))({url:R,length:X,httpHeaders:V,withCredentials:D,rangeChunkSize:M,disableRange:Q,disableStream:$})),H(K)});return Promise.all([C,U]).then(function(H){let[K,ot]=H;if(e.destroyed)throw new Error("Loading aborted");const at=new _message_handler.MessageHandler(r,K,p.port),dt=new WorkerTransport(at,e,ot,E,i);e._transport=dt,at.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(T,t){if(T.destroyed)throw new Error("Worker was destroyed");const _=await T.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(T.destroyed)throw new Error("Worker was destroyed");return _}function getUrlProp(T){if(T instanceof URL)return T.href;try{return new URL(T,window.location).href}catch{if(_util.isNodeJS&&typeof T=="string")return T}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(T){if(_util.isNodeJS&&typeof Buffer<"u"&&T instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(T instanceof Uint8Array&&T.byteLength===T.buffer.byteLength)return T;if(typeof T=="string")return(0,_util.stringToBytes)(T);if(typeof T=="object"&&!isNaN(T==null?void 0:T.length)||(0,_util.isArrayBuffer)(T))return new Uint8Array(T);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{constructor(){var t,_;this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${_docId._=(t=_docId._,_=t++,t),_}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{var t,_;(t=this._worker)!==null&&t!==void 0&&t.port&&(this._worker._pendingDestroy=!0),await((_=this._transport)===null||_===void 0?void 0:_.destroy())}catch(r){var e;throw(e=this._worker)!==null&&e!==void 0&&e.port&&delete this._worker._pendingDestroy,r}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}var _docId={_:0};exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,_){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this.length=t,this.initialData=_,this.progressiveDone=e,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,_){for(const e of this._rangeListeners)e(t,_)}onDataProgress(t,_){this._readyCapability.promise.then(()=>{for(const e of this._progressListeners)e(t,_)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const _ of this._progressiveReadListeners)_(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,_){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,_){this._pdfInfo=t,this._transport=_,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(e=>{if(!e)return e;const r=[];for(const R in e)r.push(...e[R]);return r}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;var _delayedCleanupTimeout=new WeakMap,_pendingCleanup=new WeakMap,_PDFPageProxy_brand=new WeakSet;class PDFPageProxy{constructor(t,_,e){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_classPrivateMethodInitSpec(this,_PDFPageProxy_brand),_classPrivateFieldInitSpec(this,_delayedCleanupTimeout,null),_classPrivateFieldInitSpec(this,_pendingCleanup,!1),this._pageIndex=t,this._pageInfo=_,this._transport=e,this._stats=r?new _display_utils.StatTimer:null,this._pdfBug=r,this.commonObjs=e.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:t,rotation:_=this.rotate,offsetX:e=0,offsetY:r=0,dontFlip:R=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:_,offsetX:e,offsetY:r,dontFlip:R})}getAnnotations(){let{intent:t="display"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const _=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,_.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)===null||t===void 0?void 0:t.children[this._pageIndex])||null}render(t){var _;let{canvasContext:e,viewport:r,intent:R="display",annotationMode:L=_util.AnnotationMode.ENABLE,transform:V=null,background:D=null,optionalContentConfigPromise:f=null,annotationCanvasMap:A=null,pageColors:M=null,printAnnotationStorage:p=null}=t;(_=this._stats)===null||_===void 0||_.time("Overall");const m=this._transport.getRenderingIntent(R,L,p);_classPrivateFieldSet(_pendingCleanup,this,!1),_assertClassBrand(_PDFPageProxy_brand,this,_abortDelayedCleanup).call(this),f||(f=this._transport.getOptionalContentConfig());let S=this._intentStates.get(m.cacheKey);S||(S=Object.create(null),this._intentStates.set(m.cacheKey,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const u=!!(m.renderingIntent&_util.RenderingIntentFlag.PRINT);if(!S.displayReadyCapability){var d;S.displayReadyCapability=new _util.PromiseCapability,S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)===null||d===void 0||d.time("Page Request"),this._pumpOperatorList(m)}const n=y=>{var a,o;S.renderTasks.delete(l),(this._maybeCleanupAfterRender||u)&&_classPrivateFieldSet(_pendingCleanup,this,!0),_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!u),y?(l.capability.reject(y),this._abortOperatorList({intentState:S,reason:y instanceof Error?y:new Error(y)})):l.capability.resolve(),(a=this._stats)===null||a===void 0||a.timeEnd("Rendering"),(o=this._stats)===null||o===void 0||o.timeEnd("Overall")},l=new InternalRenderTask({callback:n,params:{canvasContext:e,viewport:r,transform:V,background:D},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:A,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!u,pdfBug:this._pdfBug,pageColors:M});(S.renderTasks||(S.renderTasks=new Set)).add(l);const F=l.task;return Promise.all([S.displayReadyCapability.promise,f]).then(y=>{var a;let[o,w]=y;if(this.destroyed){n();return}(a=this._stats)===null||a===void 0||a.time("Rendering"),l.initializeGraphics({transparency:o,optionalContentConfig:w}),l.operatorListChanged()}).catch(n),F}getOperatorList(){let{intent:t="display",annotationMode:_=_util.AnnotationMode.ENABLE,printAnnotationStorage:e=null}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};function r(){L.operatorList.lastChunk&&(L.opListReadCapability.resolve(L.operatorList),L.renderTasks.delete(V))}const R=this._transport.getRenderingIntent(t,_,e,!0);let L=this._intentStates.get(R.cacheKey);L||(L=Object.create(null),this._intentStates.set(R.cacheKey,L));let V;if(!L.opListReadCapability){var D;V=Object.create(null),V.operatorListChanged=r,L.opListReadCapability=new _util.PromiseCapability,(L.renderTasks||(L.renderTasks=new Set)).add(V),L.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(D=this._stats)===null||D===void 0||D.time("Page Request"),this._pumpOperatorList(R)}return L.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:t=!1,disableNormalization:_=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:_===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(e=>_xfa_text.XfaText.textContent(e));const _=this.streamTextContent(t);return new Promise(function(e,r){function R(){L.read().then(function(D){let{value:f,done:A}=D;if(A){e(V);return}Object.assign(V.styles,f.styles),V.items.push(...f.items),R()},r)}const L=_.getReader(),V={items:[],styles:Object.create(null)};R()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const _ of this._intentStates.values())if(this._abortOperatorList({intentState:_,reason:new Error("Page was destroyed."),force:!0}),!_.opListReadCapability)for(const e of _.renderTasks)t.push(e.completed),e.cancel();return this.objs.clear(),_classPrivateFieldSet(_pendingCleanup,this,!1),_assertClassBrand(_PDFPageProxy_brand,this,_abortDelayedCleanup).call(this),Promise.all(t)}cleanup(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;_classPrivateFieldSet(_pendingCleanup,this,!0);const _=_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!1);return t&&_&&this._stats&&(this._stats=new _display_utils.StatTimer),_}_startRenderPage(t,_){var e,r;const R=this._intentStates.get(_);R&&((e=this._stats)===null||e===void 0||e.timeEnd("Page Request"),(r=R.displayReadyCapability)===null||r===void 0||r.resolve(t))}_renderPageChunk(t,_){for(let e=0,r=t.length;e<r;e++)_.operatorList.fnArray.push(t.fnArray[e]),_.operatorList.argsArray.push(t.argsArray[e]);_.operatorList.lastChunk=t.lastChunk,_.operatorList.separateAnnots=t.separateAnnots;for(const e of _.renderTasks)e.operatorListChanged();t.lastChunk&&_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!0)}_pumpOperatorList(t){let{renderingIntent:_,cacheKey:e,annotationStorageSerializable:r}=t;const{map:R,transfers:L}=r,D=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:_,cacheKey:e,annotationStorage:R},L).getReader(),f=this._intentStates.get(e);f.streamReader=D;const A=()=>{D.read().then(M=>{let{value:p,done:m}=M;if(m){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,f),A())},M=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const p of f.renderTasks)p.operatorListChanged();_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!0)}if(f.displayReadyCapability)f.displayReadyCapability.reject(M);else if(f.opListReadCapability)f.opListReadCapability.reject(M);else throw M}})};A()}_abortOperatorList(t){let{intentState:_,reason:e,force:r=!1}=t;if(_.streamReader){if(_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null),!r){if(_.renderTasks.size>0)return;if(e instanceof _display_utils.RenderingCancelledException){let R=RENDERING_CANCELLED_TIMEOUT;e.extraDelay>0&&e.extraDelay<1e3&&(R+=e.extraDelay),_.streamReaderCancelTimeout=setTimeout(()=>{_.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:_,reason:e,force:!0})},R);return}}if(_.streamReader.cancel(new _util.AbortException(e.message)).catch(()=>{}),_.streamReader=null,!this._transport.destroyed){for(const[R,L]of this._intentStates)if(L===_){this._intentStates.delete(R);break}this.cleanup()}}}get stats(){return this._stats}}function _tryCleanup(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(_assertClassBrand(_PDFPageProxy_brand,this,_abortDelayedCleanup).call(this),!_classPrivateFieldGet(_pendingCleanup,this)||this.destroyed)return!1;if(T)return _classPrivateFieldSet(_delayedCleanupTimeout,this,setTimeout(()=>{_classPrivateFieldSet(_delayedCleanupTimeout,this,null),_assertClassBrand(_PDFPageProxy_brand,this,_tryCleanup).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:t,operatorList:_}of this._intentStates.values())if(t.size>0||!_.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_classPrivateFieldSet(_pendingCleanup,this,!1),!0}function _abortDelayedCleanup(){_classPrivateFieldGet(_delayedCleanupTimeout,this)&&(clearTimeout(_classPrivateFieldGet(_delayedCleanupTimeout,this)),_classPrivateFieldSet(_delayedCleanupTimeout,this,null))}exports.PDFPageProxy=PDFPageProxy;var _listeners=new WeakMap,_deferred=new WeakMap;class LoopbackPort{constructor(){_classPrivateFieldInitSpec(this,_listeners,new Set),_classPrivateFieldInitSpec(this,_deferred,Promise.resolve())}postMessage(t,_){const e={data:structuredClone(t,_?{transfer:_}:null)};_classPrivateFieldGet(_deferred,this).then(()=>{for(const r of _classPrivateFieldGet(_listeners,this))r.call(this,e)})}addEventListener(t,_){_classPrivateFieldGet(_listeners,this).add(_)}removeEventListener(t,_){_classPrivateFieldGet(_listeners,this).delete(_)}terminate(){_classPrivateFieldGet(_listeners,this).clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){var _document;const T=(_document=document)===null||_document===void 0||(_document=_document.currentScript)===null||_document===void 0?void 0:_document.src;T&&(PDFWorkerUtil.fallbackWorkerSrc=T.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(T,t){let _;try{if(_=new URL(T),!_.origin||_.origin==="null")return!1}catch{return!1}const e=new URL(t,_);return _.origin===e.origin},PDFWorkerUtil.createCDNWrapper=function(T){const t=`importScripts("${T}");`;return URL.createObjectURL(new Blob([t]))}}class PDFWorker{constructor(){let{name:T=null,port:t=null,verbosity:_=(0,_util.getVerbosityLevel)()}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.name=T,this.destroyed=!1,this.verbosity=_,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,t){var e;if((e=_workerPorts._)!==null&&e!==void 0&&e.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(_workerPorts._||(_workerPorts._=new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(T){this._port=T,this._messageHandler=new _message_handler.MessageHandler("main","worker",T),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:T}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,T)||(T=PDFWorkerUtil.createCDNWrapper(new URL(T,window.location).href));const t=new Worker(T),_=new _message_handler.MessageHandler("main","worker",t),e=()=>{t.removeEventListener("error",r),_.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||e()};t.addEventListener("error",r),_.on("test",L=>{if(t.removeEventListener("error",r),this.destroyed){e();return}L?(this._messageHandler=_,this._port=t,this._webWorker=t,this._readyCapability.resolve(),_.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),_.destroy(),t.terminate())}),_.on("ready",L=>{if(t.removeEventListener("error",r),this.destroyed){e();return}try{R()}catch{this._setupFakeWorker()}});const R=()=>{const L=new Uint8Array;_.send("test",L,[L.buffer])};R();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(T=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const _=`fake${PDFWorkerUtil.fakeWorkerId++}`,e=new _message_handler.MessageHandler(_+"_worker",_,t);T.setup(e,t);const r=new _message_handler.MessageHandler(_,_+"_worker",t);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})}).catch(T=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${T.message}".`))})}destroy(){var T;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(T=_workerPorts._)===null||T===void 0||T.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(T){var t;if(!(T!=null&&T.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const _=(t=_assertClassBrand(PDFWorker,this,_workerPorts)._)===null||t===void 0?void 0:t.get(T.port);if(_){if(_._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return _}return new PDFWorker(T)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{var T;return((T=globalThis.pdfjsWorker)===null||T===void 0?void 0:T.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}var _workerPorts={_:void 0};exports.PDFWorker=PDFWorker;var _methodPromises=new WeakMap,_pageCache=new WeakMap,_pagePromises=new WeakMap,_passwordCapability=new WeakMap,_WorkerTransport_brand=new WeakSet;class WorkerTransport{constructor(t,_,e,r,R){_classPrivateMethodInitSpec(this,_WorkerTransport_brand),_classPrivateFieldInitSpec(this,_methodPromises,new Map),_classPrivateFieldInitSpec(this,_pageCache,new Map),_classPrivateFieldInitSpec(this,_pagePromises,new Map),_classPrivateFieldInitSpec(this,_passwordCapability,null),this.messageHandler=t,this.loadingTask=_,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this._params=r,this.canvasFactory=R.canvasFactory,this.filterFactory=R.filterFactory,this.cMapReaderFactory=R.cMapReaderFactory,this.standardFontDataFactory=R.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=e,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(t){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_util.AnnotationMode.ENABLE,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,R=_util.RenderingIntentFlag.DISPLAY,L=_annotation_storage.SerializableEmpty;switch(t){case"any":R=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":R=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(_){case _util.AnnotationMode.DISABLE:R+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:R+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:R+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,L=(R&_util.RenderingIntentFlag.PRINT&&e instanceof _annotation_storage.PrintAnnotationStorage?e:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${_}`)}return r&&(R+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:R,cacheKey:`${R}_${L.hash}`,annotationStorageSerializable:L}}destroy(){var t;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(t=_classPrivateFieldGet(_passwordCapability,this))===null||t===void 0||t.reject(new Error("Worker was destroyed during onPassword callback"));const _=[];for(const r of _classPrivateFieldGet(_pageCache,this).values())_.push(r._destroy());_classPrivateFieldGet(_pageCache,this).clear(),_classPrivateFieldGet(_pagePromises,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return _.push(e),Promise.all(_).then(()=>{var r;this.commonObjs.clear(),this.fontLoader.clear(),_classPrivateFieldGet(_methodPromises,this).clear(),this.filterFactory.destroy(),(r=this._networkStream)===null||r===void 0||r.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:_}=this;t.on("GetReader",(e,r)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=R=>{this._lastProgress={loaded:R.loaded,total:R.total}},r.onPull=()=>{this._fullReader.read().then(function(R){let{value:L,done:V}=R;if(V){r.close();return}(0,_util.assert)(L instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(L),1,[L])}).catch(R=>{r.error(R)})},r.onCancel=R=>{this._fullReader.cancel(R),r.ready.catch(L=>{if(!this.destroyed)throw L})}}),t.on("ReaderHeadersReady",e=>{const r=new _util.PromiseCapability,R=this._fullReader;return R.headersReady.then(()=>{if(!R.isStreamingSupported||!R.isRangeSupported){if(this._lastProgress){var L;(L=_.onProgress)===null||L===void 0||L.call(_,this._lastProgress)}R.onProgress=V=>{var D;(D=_.onProgress)===null||D===void 0||D.call(_,{loaded:V.loaded,total:V.total})}}r.resolve({isStreamingSupported:R.isStreamingSupported,isRangeSupported:R.isRangeSupported,contentLength:R.contentLength})},r.reject),r.promise}),t.on("GetRangeReader",(e,r)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const R=this._networkStream.getRangeReader(e.begin,e.end);if(!R){r.close();return}r.onPull=()=>{R.read().then(function(L){let{value:V,done:D}=L;if(D){r.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(V),1,[V])}).catch(L=>{r.error(L)})},r.onCancel=L=>{R.cancel(L),r.ready.catch(V=>{if(!this.destroyed)throw V})}}),t.on("GetDoc",e=>{let{pdfInfo:r}=e;this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,_._capability.resolve(new PDFDocumentProxy(r,this))}),t.on("DocException",function(e){let r;switch(e.name){case"PasswordException":r=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":r=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":r=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":r=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":r=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}_._capability.reject(r)}),t.on("PasswordRequest",e=>{if(_classPrivateFieldSet(_passwordCapability,this,new _util.PromiseCapability),_.onPassword){const r=R=>{R instanceof Error?_classPrivateFieldGet(_passwordCapability,this).reject(R):_classPrivateFieldGet(_passwordCapability,this).resolve({password:R})};try{_.onPassword(r,e.code)}catch(R){_classPrivateFieldGet(_passwordCapability,this).reject(R)}}else _classPrivateFieldGet(_passwordCapability,this).reject(new _util.PasswordException(e.message,e.code));return _classPrivateFieldGet(_passwordCapability,this).promise}),t.on("DataLoaded",e=>{var r;(r=_.onProgress)===null||r===void 0||r.call(_,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),t.on("StartRenderPage",e=>{if(this.destroyed)return;_classPrivateFieldGet(_pageCache,this).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),t.on("commonobj",e=>{var r;let[R,L,V]=e;if(!this.destroyed&&!this.commonObjs.has(R))switch(L){case"Font":const D=this._params;if("error"in V){const M=V.error;(0,_util.warn)(`Error during font loading: ${M}`),this.commonObjs.resolve(R,M);break}const f=D.pdfBug&&(r=globalThis.FontInspector)!==null&&r!==void 0&&r.enabled?(M,p)=>globalThis.FontInspector.fontAdded(M,p):null,A=new _font_loader.FontFaceObject(V,{isEvalSupported:D.isEvalSupported,disableFontFace:D.disableFontFace,ignoreErrors:D.ignoreErrors,inspectFont:f});this.fontLoader.bind(A).catch(M=>t.sendWithPromise("FontFallback",{id:R})).finally(()=>{!D.fontExtraProperties&&A.data&&(A.data=null),this.commonObjs.resolve(R,A)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(R,V);break;default:throw new Error(`Got unknown common object type ${L}`)}}),t.on("obj",e=>{let[r,R,L,V]=e;if(this.destroyed)return;const D=_classPrivateFieldGet(_pageCache,this).get(R);if(!D.objs.has(r))switch(L){case"Image":if(D.objs.resolve(r,V),V){let A;if(V.bitmap){const{width:M,height:p}=V;A=M*p*4}else{var f;A=((f=V.data)===null||f===void 0?void 0:f.length)||0}A>_util.MAX_IMAGE_SIZE_TO_CACHE&&(D._maybeCleanupAfterRender=!0)}break;case"Pattern":D.objs.resolve(r,V);break;default:throw new Error(`Got unknown object type ${L}`)}}),t.on("DocProgress",e=>{var r;this.destroyed||(r=_.onProgress)===null||r===void 0||r.call(_,{loaded:e.loaded,total:e.total})}),t.on("FetchBuiltInCMap",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var t,_;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfers:r}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:(t=(_=this._fullReader)===null||_===void 0?void 0:_.filename)!==null&&t!==void 0?t:null},r).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const _=t-1,e=_classPrivateFieldGet(_pagePromises,this).get(_);if(e)return e;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:_}).then(R=>{if(this.destroyed)throw new Error("Transport destroyed");const L=new PDFPageProxy(_,R,this,this._params.pdfBug);return _classPrivateFieldGet(_pageCache,this).set(_,L),L});return _classPrivateFieldGet(_pagePromises,this).set(_,r),r}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,_){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:_})}getFieldObjects(){return _assertClassBrand(_WorkerTransport_brand,this,_cacheSimpleMethod).call(this,"GetFieldObjects")}hasJSActions(){return _assertClassBrand(_WorkerTransport_brand,this,_cacheSimpleMethod).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return _assertClassBrand(_WorkerTransport_brand,this,_cacheSimpleMethod).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",_=_classPrivateFieldGet(_methodPromises,this).get(t);if(_)return _;const e=this.messageHandler.sendWithPromise(t,null).then(r=>{var R,L,V,D;return{info:r[0],metadata:r[1]?new _metadata.Metadata(r[1]):null,contentDispositionFilename:(R=(L=this._fullReader)===null||L===void 0?void 0:L.filename)!==null&&R!==void 0?R:null,contentLength:(V=(D=this._fullReader)===null||D===void 0?void 0:D.contentLength)!==null&&V!==void 0?V:null}});return _classPrivateFieldGet(_methodPromises,this).set(t,e),e}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const _ of _classPrivateFieldGet(_pageCache,this).values())if(!_.cleanup())throw new Error(`startCleanup: Page ${_.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),_classPrivateFieldGet(_methodPromises,this).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:t,enableXfa:_}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t,enableXfa:_})}}function _cacheSimpleMethod(T){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const _=_classPrivateFieldGet(_methodPromises,this).get(T);if(_)return _;const e=this.messageHandler.sendWithPromise(T,t);return _classPrivateFieldGet(_methodPromises,this).set(T,e),e}var _objs=new WeakMap,_PDFObjects_brand=new WeakSet;class PDFObjects{constructor(){_classPrivateMethodInitSpec(this,_PDFObjects_brand),_classPrivateFieldInitSpec(this,_objs,Object.create(null))}get(t){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(_){const r=_assertClassBrand(_PDFObjects_brand,this,_ensureObj).call(this,t);return r.capability.promise.then(()=>_(r.data)),null}const e=_classPrivateFieldGet(_objs,this)[t];if(!(e!=null&&e.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return e.data}has(t){const _=_classPrivateFieldGet(_objs,this)[t];return(_==null?void 0:_.capability.settled)||!1}resolve(t){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const e=_assertClassBrand(_PDFObjects_brand,this,_ensureObj).call(this,t);e.data=_,e.capability.resolve()}clear(){for(const _ in _classPrivateFieldGet(_objs,this)){var t;const{data:e}=_classPrivateFieldGet(_objs,this)[_];e==null||(t=e.bitmap)===null||t===void 0||t.close()}_classPrivateFieldSet(_objs,this,Object.create(null))}}function _ensureObj(T){var t;return(t=_classPrivateFieldGet(_objs,this))[T]||(t[T]={capability:new _util.PromiseCapability,data:null})}var _internalRenderTask=new WeakMap;class RenderTask{constructor(t){_classPrivateFieldInitSpec(this,_internalRenderTask,null),_classPrivateFieldSet(_internalRenderTask,this,t),this.onContinue=null}get promise(){return _classPrivateFieldGet(_internalRenderTask,this).capability.promise}cancel(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;_classPrivateFieldGet(_internalRenderTask,this).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=_classPrivateFieldGet(_internalRenderTask,this).operatorList;if(!t)return!1;const{annotationCanvasMap:_}=_classPrivateFieldGet(_internalRenderTask,this);return t.form||t.canvas&&(_==null?void 0:_.size)>0}}exports.RenderTask=RenderTask;class InternalRenderTask{constructor(t){let{callback:_,params:e,objs:r,commonObjs:R,annotationCanvasMap:L,operatorList:V,pageIndex:D,canvasFactory:f,filterFactory:A,useRequestAnimationFrame:M=!1,pdfBug:p=!1,pageColors:m=null}=t;this.callback=_,this.params=e,this.objs=r,this.commonObjs=R,this.annotationCanvasMap=L,this.operatorListIdx=null,this.operatorList=V,this._pageIndex=D,this.canvasFactory=f,this.filterFactory=A,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=M===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(t){var _,e;let{transparency:r=!1,optionalContentConfig:R}=t;if(this.cancelled)return;if(this._canvas){if(_canvasInUse._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");_canvasInUse._.add(this._canvas)}this._pdfBug&&(_=globalThis.StepperManager)!==null&&_!==void 0&&_.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:L,viewport:V,transform:D,background:f}=this.params;this.gfx=new _canvas.CanvasGraphics(L,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:R},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:D,viewport:V,transparency:r,background:f}),this.operatorListIdx=0,this.graphicsReady=!0,(e=this.graphicsReadyCallback)===null||e===void 0||e.call(this)}cancel(){var t;let _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.running=!1,this.cancelled=!0,(t=this.gfx)===null||t===void 0||t.endDrawing(),_canvasInUse._.delete(this._canvas),this.callback(_||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)===null||t===void 0||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),_canvasInUse._.delete(this._canvas),this.callback())))}}var _canvasInUse={_:new WeakSet};const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var e=_(1),r=_(4),R=_(8);const L=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=L;var V=new WeakMap,D=new WeakMap,f=new WeakSet;class A{constructor(){_classPrivateMethodInitSpec(this,f),_classPrivateFieldInitSpec(this,V,!1),_classPrivateFieldInitSpec(this,D,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(u,d){const n=_classPrivateFieldGet(D,this).get(u);return n===void 0?d:Object.assign(d,n)}getRawValue(u){return _classPrivateFieldGet(D,this).get(u)}remove(u){if(_classPrivateFieldGet(D,this).delete(u),_classPrivateFieldGet(D,this).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const d of _classPrivateFieldGet(D,this).values())if(d instanceof r.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(u,d){const n=_classPrivateFieldGet(D,this).get(u);let l=!1;if(n!==void 0)for(const[F,y]of Object.entries(d))n[F]!==y&&(l=!0,n[F]=y);else l=!0,_classPrivateFieldGet(D,this).set(u,d);l&&_assertClassBrand(f,this,M).call(this),d instanceof r.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(d.constructor._type)}has(u){return _classPrivateFieldGet(D,this).has(u)}getAll(){return _classPrivateFieldGet(D,this).size>0?(0,e.objectFromMap)(_classPrivateFieldGet(D,this)):null}setAll(u){for(const[d,n]of Object.entries(u))this.setValue(d,n)}get size(){return _classPrivateFieldGet(D,this).size}resetModified(){_classPrivateFieldGet(V,this)&&(_classPrivateFieldSet(V,this,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new m(this)}get serializable(){if(_classPrivateFieldGet(D,this).size===0)return L;const u=new Map,d=new R.MurmurHash3_64,n=[],l=Object.create(null);let F=!1;for(const[y,a]of _classPrivateFieldGet(D,this)){const o=a instanceof r.AnnotationEditor?a.serialize(!1,l):a;o&&(u.set(y,o),d.update(`${y}:${JSON.stringify(o)}`),F||(F=!!o.bitmap))}if(F)for(const y of u.values())y.bitmap&&n.push(y.bitmap);return u.size>0?{map:u,hash:d.hexdigest(),transfers:n}:L}}function M(){_classPrivateFieldGet(V,this)||(_classPrivateFieldSet(V,this,!0),typeof this.onSetModified=="function"&&this.onSetModified())}t.AnnotationStorage=A;var p=new WeakMap;class m extends A{constructor(u){super(),_classPrivateFieldInitSpec(this,p,void 0);const{map:d,hash:n,transfers:l}=u.serializable,F=structuredClone(d,l?{transfer:l}:null);_classPrivateFieldSet(p,this,{map:F,hash:n,transfers:l})}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return _classPrivateFieldGet(p,this)}}t.PrintAnnotationStorage=m},(T,t,_)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var r=_(5),R=_(1),L=_(6),V=new WeakMap,D=new WeakMap,f=new WeakMap,A=new WeakMap,M=new WeakMap,p=new WeakMap,m=new WeakMap,S=new WeakMap,u=new WeakMap,d=new WeakMap,n=new WeakMap,l=new WeakMap,F=new WeakMap,y=new WeakMap,a=new WeakSet;class o{constructor(b){_classPrivateMethodInitSpec(this,a),_classPrivateFieldInitSpec(this,V,""),_classPrivateFieldInitSpec(this,D,!1),_classPrivateFieldInitSpec(this,f,null),_classPrivateFieldInitSpec(this,A,null),_classPrivateFieldInitSpec(this,M,null),_classPrivateFieldInitSpec(this,p,!1),_classPrivateFieldInitSpec(this,m,null),_classPrivateFieldInitSpec(this,S,this.focusin.bind(this)),_classPrivateFieldInitSpec(this,u,this.focusout.bind(this)),_classPrivateFieldInitSpec(this,d,!1),_classPrivateFieldInitSpec(this,n,!1),_classPrivateFieldInitSpec(this,l,!1),_defineProperty(this,"_initialOptions",Object.create(null)),_defineProperty(this,"_uiManager",null),_defineProperty(this,"_focusEventsAllowed",!0),_defineProperty(this,"_l10nPromise",null),_classPrivateFieldInitSpec(this,F,!1),_classPrivateFieldInitSpec(this,y,o._zIndex++),this.constructor===o&&(0,R.unreachable)("Cannot initialize AnnotationEditor."),this.parent=b.parent,this.id=b.id,this.width=this.height=null,this.pageIndex=b.parent.pageIndex,this.name=b.name,this.div=null,this._uiManager=b.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=b.isCentered,this._structTreeParentId=null;const{rotation:N,rawDims:{pageWidth:rt,pageHeight:v,pageX:s,pageY:i}}=this.parent.viewport;this.rotation=N,this.pageRotation=(360+N-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[rt,v],this.pageTranslation=[s,i];const[h,E]=this.parentDimensions;this.x=b.x/h,this.y=b.y/E,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,R.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(b){const N=new _t({id:b.parent.getNextId(),parent:b.parent,uiManager:b._uiManager});N.annotationElementId=b.annotationElementId,N.deleted=!0,N._uiManager.addToAnnotationStorage(N)}static initialize(b){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(o._l10nPromise||(o._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(v=>[v,b.get(v)]))),N!=null&&N.strings)for(const v of N.strings)o._l10nPromise.set(v,b.get(v));if(o._borderLineWidth!==-1)return;const rt=getComputedStyle(document.documentElement);o._borderLineWidth=parseFloat(rt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(b,N){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(b){return!1}static paste(b,N){(0,R.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return _classPrivateFieldGet(F,this)}set _isDraggable(b){var N;_classPrivateFieldSet(F,this,b),(N=this.div)===null||N===void 0||N.classList.toggle("draggable",b)}center(){const[b,N]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*N/(b*2),this.y+=this.width*b/(N*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*N/(b*2),this.y-=this.width*b/(N*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(b){this._uiManager.addCommands(b)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=_classPrivateFieldGet(y,this)}setParent(b){b!==null&&(this.pageIndex=b.pageIndex,this.pageDimensions=b.pageDimensions),this.parent=b}focusin(b){this._focusEventsAllowed&&(_classPrivateFieldGet(d,this)?_classPrivateFieldSet(d,this,!1):this.parent.setSelected(this))}focusout(b){var N;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const rt=b.relatedTarget;rt!=null&&rt.closest(`#${this.id}`)||(b.preventDefault(),(N=this.parent)!==null&&N!==void 0&&N.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(b,N,rt,v){const[s,i]=this.parentDimensions;[rt,v]=this.screenToPageTranslation(rt,v),this.x=(b+rt)/s,this.y=(N+v)/i,this.fixAndSetPosition()}translate(b,N){_assertClassBrand(a,this,w).call(this,this.parentDimensions,b,N)}translateInPage(b,N){_assertClassBrand(a,this,w).call(this,this.pageDimensions,b,N),this.div.scrollIntoView({block:"nearest"})}drag(b,N){const[rt,v]=this.parentDimensions;if(this.x+=b/rt,this.y+=N/v,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:C,y:U}=this.div.getBoundingClientRect();this.parent.findNewParent(this,C,U)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:i}=this;const[h,E]=_assertClassBrand(a,this,Y).call(this);s+=h,i+=E,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*i).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[b,N]=this.pageDimensions;let{x:rt,y:v,width:s,height:i}=this;switch(s*=b,i*=N,rt*=b,v*=N,this.rotation){case 0:rt=Math.max(0,Math.min(b-s,rt)),v=Math.max(0,Math.min(N-i,v));break;case 90:rt=Math.max(0,Math.min(b-i,rt)),v=Math.min(N,Math.max(s,v));break;case 180:rt=Math.min(b,Math.max(s,rt)),v=Math.min(N,Math.max(i,v));break;case 270:rt=Math.min(b,Math.max(i,rt)),v=Math.max(0,Math.min(N-s,v));break}this.x=rt/=b,this.y=v/=N;const[h,E]=_assertClassBrand(a,this,Y).call(this);rt+=h,v+=E;const{style:C}=this.div;C.left=`${(100*rt).toFixed(2)}%`,C.top=`${(100*v).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(b,N){return B.call(o,b,N,this.parentRotation)}pageTranslationToScreen(b,N){return B.call(o,b,N,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:b,pageDimensions:[N,rt]}=this,v=N*b,s=rt*b;return R.FeatureTest.isCSSRoundSupported?[Math.round(v),Math.round(s)]:[v,s]}setDims(b,N){var rt;const[v,s]=this.parentDimensions;this.div.style.width=`${(100*b/v).toFixed(2)}%`,_classPrivateFieldGet(p,this)||(this.div.style.height=`${(100*N/s).toFixed(2)}%`),(rt=_classPrivateFieldGet(f,this))===null||rt===void 0||rt.classList.toggle("small",b<o.SMALL_EDITOR_SIZE||N<o.SMALL_EDITOR_SIZE)}fixDims(){const{style:b}=this.div,{height:N,width:rt}=b,v=rt.endsWith("%"),s=!_classPrivateFieldGet(p,this)&&N.endsWith("%");if(v&&s)return;const[i,h]=this.parentDimensions;v||(b.width=`${(100*parseFloat(rt)/i).toFixed(2)}%`),!_classPrivateFieldGet(p,this)&&!s&&(b.height=`${(100*parseFloat(N)/h).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(_classPrivateFieldGet(f,this))return;const b=_classPrivateFieldSet(f,this,document.createElement("button"));b.className="altText";const N=await o._l10nPromise.get("editor_alt_text_button_label");b.textContent=N,b.setAttribute("aria-label",N),b.tabIndex="0",b.addEventListener("contextmenu",L.noContextMenu),b.addEventListener("pointerdown",rt=>rt.stopPropagation()),b.addEventListener("click",rt=>{rt.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),b.addEventListener("keydown",rt=>{rt.target===b&&rt.key==="Enter"&&(rt.preventDefault(),this._uiManager.editAltText(this))}),_assertClassBrand(a,this,$).call(this),this.div.append(b),o.SMALL_EDITOR_SIZE||(o.SMALL_EDITOR_SIZE=Math.min(128,Math.round(b.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:_classPrivateFieldGet(V,this),decorative:_classPrivateFieldGet(D,this)}}set altTextData(b){let{altText:N,decorative:rt}=b;_classPrivateFieldGet(V,this)===N&&_classPrivateFieldGet(D,this)===rt||(_classPrivateFieldSet(V,this,N),_classPrivateFieldSet(D,this,rt),_assertClassBrand(a,this,$).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",_classPrivateFieldGet(S,this)),this.div.addEventListener("focusout",_classPrivateFieldGet(u,this));const[b,N]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*N/b).toFixed(2)}%`,this.div.style.maxHeight=`${(100*b/N).toFixed(2)}%`);const[rt,v]=this.getInitialTranslation();return this.translate(rt,v),(0,r.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(b){const{isMac:N}=R.FeatureTest.platform;if(b.button!==0||b.ctrlKey&&N){b.preventDefault();return}_classPrivateFieldSet(d,this,!0),_assertClassBrand(a,this,et).call(this,b)}moveInDOM(){var b;(b=this.parent)===null||b===void 0||b.moveEditorInDOM(this)}_setParentAndPosition(b,N,rt){b.changeParent(this),this.x=N,this.y=rt,this.fixAndSetPosition()}getRect(b,N){const rt=this.parentScale,[v,s]=this.pageDimensions,[i,h]=this.pageTranslation,E=b/rt,C=N/rt,U=this.x*v,H=this.y*s,K=this.width*v,ot=this.height*s;switch(this.rotation){case 0:return[U+E+i,s-H-C-ot+h,U+E+K+i,s-H-C+h];case 90:return[U+C+i,s-H+E+h,U+C+ot+i,s-H+E+K+h];case 180:return[U-E-K+i,s-H+C+h,U-E+i,s-H+C+ot+h];case 270:return[U-C-ot+i,s-H-E-K+h,U-C+i,s-H-E+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(b,N){const[rt,v,s,i]=b,h=s-rt,E=i-v;switch(this.rotation){case 0:return[rt,N-i,h,E];case 90:return[rt,N-v,E,h];case 180:return[s,N-v,h,E];case 270:return[s,N-i,E,h];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){_classPrivateFieldSet(l,this,!0)}disableEditMode(){_classPrivateFieldSet(l,this,!1)}isInEditMode(){return _classPrivateFieldGet(l,this)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var b,N;(b=this.div)===null||b===void 0||b.addEventListener("focusin",_classPrivateFieldGet(S,this)),(N=this.div)===null||N===void 0||N.addEventListener("focusout",_classPrivateFieldGet(u,this))}serialize(){(0,R.unreachable)("An editor must be serializable")}static deserialize(b,N,rt){const v=new this.prototype.constructor({parent:N,id:N.getNextId(),uiManager:rt});v.rotation=b.rotation;const[s,i]=v.pageDimensions,[h,E,C,U]=v.getRectInCurrentCoords(b.rect,i);return v.x=h/s,v.y=E/i,v.width=C/s,v.height=U/i,v}remove(){var b;this.div.removeEventListener("focusin",_classPrivateFieldGet(S,this)),this.div.removeEventListener("focusout",_classPrivateFieldGet(u,this)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(b=_classPrivateFieldGet(f,this))===null||b===void 0||b.remove(),_classPrivateFieldSet(f,this,null),_classPrivateFieldSet(A,this,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(_assertClassBrand(a,this,P).call(this),_classPrivateFieldGet(m,this).classList.remove("hidden"))}select(){var b;this.makeResizable(),(b=this.div)===null||b===void 0||b.classList.add("selectedEditor")}unselect(){var b,N,rt;(b=_classPrivateFieldGet(m,this))===null||b===void 0||b.classList.add("hidden"),(N=this.div)===null||N===void 0||N.classList.remove("selectedEditor"),(rt=this.div)!==null&&rt!==void 0&&rt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(b,N){}disableEditing(){_classPrivateFieldGet(f,this)&&(_classPrivateFieldGet(f,this).hidden=!0)}enableEditing(){_classPrivateFieldGet(f,this)&&(_classPrivateFieldGet(f,this).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return _classPrivateFieldGet(n,this)}set isEditing(b){_classPrivateFieldSet(n,this,b),this.parent&&(b?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(b,N){_classPrivateFieldSet(p,this,!0);const rt=b/N,{style:v}=this.div;v.aspectRatio=rt,v.height="auto"}static get MIN_SIZE(){return 16}}e=o;function w(X,b,N){let[rt,v]=X;[b,N]=this.screenToPageTranslation(b,N),this.x+=b/rt,this.y+=N/v,this.fixAndSetPosition()}function Y(){const[X,b]=this.parentDimensions,{_borderLineWidth:N}=e,rt=N/X,v=N/b;switch(this.rotation){case 90:return[-rt,v];case 180:return[rt,v];case 270:return[rt,-v];default:return[-rt,-v]}}function B(X,b,N){switch(N){case 90:return[b,-X];case 180:return[-X,-b];case 270:return[-b,X];default:return[X,b]}}function g(X){switch(X){case 90:{const[b,N]=this.pageDimensions;return[0,-b/N,N/b,0]}case 180:return[-1,0,0,-1];case 270:{const[b,N]=this.pageDimensions;return[0,b/N,-N/b,0]}default:return[1,0,0,1]}}function P(){if(_classPrivateFieldGet(m,this))return;_classPrivateFieldSet(m,this,document.createElement("div")),_classPrivateFieldGet(m,this).classList.add("resizers");const X=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||X.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const b of X){const N=document.createElement("div");_classPrivateFieldGet(m,this).append(N),N.classList.add("resizer",b),N.addEventListener("pointerdown",_assertClassBrand(a,this,q).bind(this,b)),N.addEventListener("contextmenu",L.noContextMenu)}this.div.prepend(_classPrivateFieldGet(m,this))}function q(X,b){b.preventDefault();const{isMac:N}=R.FeatureTest.platform;if(b.button!==0||b.ctrlKey&&N)return;const rt=_assertClassBrand(a,this,Q).bind(this,X),v=this._isDraggable;this._isDraggable=!1;const s={passive:!0,capture:!0};window.addEventListener("pointermove",rt,s);const i=this.x,h=this.y,E=this.width,C=this.height,U=this.parent.div.style.cursor,H=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(b.target).cursor;const K=()=>{this._isDraggable=v,window.removeEventListener("pointerup",K),window.removeEventListener("blur",K),window.removeEventListener("pointermove",rt,s),this.parent.div.style.cursor=U,this.div.style.cursor=H;const ot=this.x,at=this.y,dt=this.width,ft=this.height;ot===i&&at===h&&dt===E&&ft===C||this.addCommands({cmd:()=>{this.width=dt,this.height=ft,this.x=ot,this.y=at;const[At,W]=this.parentDimensions;this.setDims(At*dt,W*ft),this.fixAndSetPosition()},undo:()=>{this.width=E,this.height=C,this.x=i,this.y=h;const[At,W]=this.parentDimensions;this.setDims(At*E,W*C),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",K),window.addEventListener("blur",K)}function Q(X,b){const[N,rt]=this.parentDimensions,v=this.x,s=this.y,i=this.width,h=this.height,E=e.MIN_SIZE/N,C=e.MIN_SIZE/rt,U=Ft=>Math.round(Ft*1e4)/1e4,H=_assertClassBrand(a,this,g).call(this,this.rotation),K=(Ft,yt)=>[H[0]*Ft+H[2]*yt,H[1]*Ft+H[3]*yt],ot=_assertClassBrand(a,this,g).call(this,360-this.rotation),at=(Ft,yt)=>[ot[0]*Ft+ot[2]*yt,ot[1]*Ft+ot[3]*yt];let dt,ft,At=!1,W=!1;switch(X){case"topLeft":At=!0,dt=(Ft,yt)=>[0,0],ft=(Ft,yt)=>[Ft,yt];break;case"topMiddle":dt=(Ft,yt)=>[Ft/2,0],ft=(Ft,yt)=>[Ft/2,yt];break;case"topRight":At=!0,dt=(Ft,yt)=>[Ft,0],ft=(Ft,yt)=>[0,yt];break;case"middleRight":W=!0,dt=(Ft,yt)=>[Ft,yt/2],ft=(Ft,yt)=>[0,yt/2];break;case"bottomRight":At=!0,dt=(Ft,yt)=>[Ft,yt],ft=(Ft,yt)=>[0,0];break;case"bottomMiddle":dt=(Ft,yt)=>[Ft/2,yt],ft=(Ft,yt)=>[Ft/2,0];break;case"bottomLeft":At=!0,dt=(Ft,yt)=>[0,yt],ft=(Ft,yt)=>[Ft,0];break;case"middleLeft":W=!0,dt=(Ft,yt)=>[0,yt/2],ft=(Ft,yt)=>[Ft,yt/2];break}const k=dt(i,h),G=ft(i,h);let O=K(...G);const j=U(v+O[0]),lt=U(s+O[1]);let ut=1,st=1,[it,St]=this.screenToPageTranslation(b.movementX,b.movementY);if([it,St]=at(it/N,St/rt),At){const Ft=Math.hypot(i,h);ut=st=Math.max(Math.min(Math.hypot(G[0]-k[0]-it,G[1]-k[1]-St)/Ft,1/i,1/h),E/i,C/h)}else W?ut=Math.max(E,Math.min(1,Math.abs(G[0]-k[0]-it)))/i:st=Math.max(C,Math.min(1,Math.abs(G[1]-k[1]-St)))/h;const kt=U(i*ut),Mt=U(h*st);O=K(...ft(kt,Mt));const Lt=j-O[0],Rt=lt-O[1];this.width=kt,this.height=Mt,this.x=Lt,this.y=Rt,this.setDims(N*kt,rt*Mt),this.fixAndSetPosition()}async function $(){const X=_classPrivateFieldGet(f,this);if(!X)return;if(!_classPrivateFieldGet(V,this)&&!_classPrivateFieldGet(D,this)){var b;X.classList.remove("done"),(b=_classPrivateFieldGet(A,this))===null||b===void 0||b.remove();return}e._l10nPromise.get("editor_alt_text_edit_button_label").then(rt=>{X.setAttribute("aria-label",rt)});let N=_classPrivateFieldGet(A,this);if(!N){_classPrivateFieldSet(A,this,N=document.createElement("span")),N.className="tooltip",N.setAttribute("role","tooltip");const rt=N.id=`alt-text-tooltip-${this.id}`;X.setAttribute("aria-describedby",rt);const v=100;X.addEventListener("mouseenter",()=>{_classPrivateFieldSet(M,this,setTimeout(()=>{_classPrivateFieldSet(M,this,null),_classPrivateFieldGet(A,this).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},v))}),X.addEventListener("mouseleave",()=>{var s;clearTimeout(_classPrivateFieldGet(M,this)),_classPrivateFieldSet(M,this,null),(s=_classPrivateFieldGet(A,this))===null||s===void 0||s.classList.remove("show")})}X.classList.add("done"),N.innerText=_classPrivateFieldGet(D,this)?await e._l10nPromise.get("editor_alt_text_decorative_tooltip"):_classPrivateFieldGet(V,this),N.parentNode||X.append(N)}function et(X){if(!this._isDraggable)return;const b=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let N,rt;b&&(N={passive:!0,capture:!0},rt=s=>{const[i,h]=this.screenToPageTranslation(s.movementX,s.movementY);this._uiManager.dragSelectedEditors(i,h)},window.addEventListener("pointermove",rt,N));const v=()=>{if(window.removeEventListener("pointerup",v),window.removeEventListener("blur",v),b&&window.removeEventListener("pointermove",rt,N),_classPrivateFieldSet(d,this,!1),!this._uiManager.endDragSession()){const{isMac:s}=R.FeatureTest.platform;X.ctrlKey&&!s||X.shiftKey||X.metaKey&&s?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",v),window.addEventListener("blur",v)}_defineProperty(o,"_borderLineWidth",-1),_defineProperty(o,"_colorManager",new r.ColorManager),_defineProperty(o,"_zIndex",1),_defineProperty(o,"SMALL_EDITOR_SIZE",0),t.AnnotationEditor=o;class _t extends o{constructor(b){super(b),this.annotationElementId=b.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(T,t,_)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=L,t.opacityToHex=V;var r=_(1),R=_(6);function L(gt,x,nt){for(const vt of nt)x.addEventListener(vt,gt[vt].bind(gt))}function V(gt){return Math.round(Math.min(255,Math.max(1,255*gt))).toString(16).padStart(2,"0")}var D=new WeakMap;class f{constructor(){_classPrivateFieldInitSpec(this,D,0)}getId(){var x,nt;return`${r.AnnotationEditorPrefix}${_classPrivateFieldSet(D,this,(x=_classPrivateFieldGet(D,this),nt=x++,x)),nt}`}}var A=new WeakMap,M=new WeakMap,p=new WeakMap,m=new WeakSet;class S{constructor(){_classPrivateMethodInitSpec(this,m),_classPrivateFieldInitSpec(this,A,(0,r.getUuid)()),_classPrivateFieldInitSpec(this,M,0),_classPrivateFieldInitSpec(this,p,null)}static get _isSVGFittingCanvas(){const x='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',vt=new OffscreenCanvas(1,3).getContext("2d"),xt=new Image;xt.src=x;const It=xt.decode().then(()=>(vt.drawImage(xt,0,0,1,1,0,0,1,3),new Uint32Array(vt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,r.shadow)(this,"_isSVGFittingCanvas",It)}async getFromFile(x){const{lastModified:nt,name:vt,size:xt,type:It}=x;return _assertClassBrand(m,this,u).call(this,`${nt}_${vt}_${xt}_${It}`,x)}async getFromUrl(x){return _assertClassBrand(m,this,u).call(this,x,x)}async getFromId(x){_classPrivateFieldGet(p,this)||_classPrivateFieldSet(p,this,new Map);const nt=_classPrivateFieldGet(p,this).get(x);return nt?nt.bitmap?(nt.refCounter+=1,nt):nt.file?this.getFromFile(nt.file):this.getFromUrl(nt.url):null}getSvgUrl(x){const nt=_classPrivateFieldGet(p,this).get(x);return nt!=null&&nt.isSvg?nt.svgUrl:null}deleteId(x){_classPrivateFieldGet(p,this)||_classPrivateFieldSet(p,this,new Map);const nt=_classPrivateFieldGet(p,this).get(x);nt&&(nt.refCounter-=1,nt.refCounter===0&&(nt.bitmap=null))}isValidId(x){return x.startsWith(`image_${_classPrivateFieldGet(A,this)}_`)}}e=S;async function u(gt,x){var nt;_classPrivateFieldGet(p,this)||_classPrivateFieldSet(p,this,new Map);let vt=_classPrivateFieldGet(p,this).get(gt);if(vt===null)return null;if((nt=vt)!==null&&nt!==void 0&&nt.bitmap)return vt.refCounter+=1,vt;try{var xt,It;vt||(vt={bitmap:null,id:`image_${_classPrivateFieldGet(A,this)}_${_classPrivateFieldSet(M,this,(xt=_classPrivateFieldGet(M,this),It=xt++,xt)),It}`,refCounter:0,isSvg:!1});let Gt;if(typeof x=="string"){vt.url=x;const bt=await fetch(x);if(!bt.ok)throw new Error(bt.statusText);Gt=await bt.blob()}else Gt=vt.file=x;if(Gt.type==="image/svg+xml"){const bt=e._isSVGFittingCanvas,c=new FileReader,I=new Image,z=new Promise((Z,ct)=>{I.onload=()=>{vt.bitmap=I,vt.isSvg=!0,Z()},c.onload=async()=>{const ht=vt.svgUrl=c.result;I.src=await bt?`${ht}#svgView(preserveAspectRatio(none))`:ht},I.onerror=c.onerror=ct});c.readAsDataURL(Gt),await z}else vt.bitmap=await createImageBitmap(Gt);vt.refCounter=1}catch(Gt){console.error(Gt),vt=null}return _classPrivateFieldGet(p,this).set(gt,vt),vt&&_classPrivateFieldGet(p,this).set(vt.id,vt),vt}var d=new WeakMap,n=new WeakMap,l=new WeakMap,F=new WeakMap;class y{constructor(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:128;_classPrivateFieldInitSpec(this,d,[]),_classPrivateFieldInitSpec(this,n,!1),_classPrivateFieldInitSpec(this,l,void 0),_classPrivateFieldInitSpec(this,F,-1),_classPrivateFieldSet(l,this,x)}add(x){let{cmd:nt,undo:vt,mustExec:xt,type:It=NaN,overwriteIfSameType:Gt=!1,keepUndo:bt=!1}=x;if(xt&&nt(),_classPrivateFieldGet(n,this))return;const c={cmd:nt,undo:vt,type:It};if(_classPrivateFieldGet(F,this)===-1){_classPrivateFieldGet(d,this).length>0&&(_classPrivateFieldGet(d,this).length=0),_classPrivateFieldSet(F,this,0),_classPrivateFieldGet(d,this).push(c);return}if(Gt&&_classPrivateFieldGet(d,this)[_classPrivateFieldGet(F,this)].type===It){bt&&(c.undo=_classPrivateFieldGet(d,this)[_classPrivateFieldGet(F,this)].undo),_classPrivateFieldGet(d,this)[_classPrivateFieldGet(F,this)]=c;return}const I=_classPrivateFieldGet(F,this)+1;I===_classPrivateFieldGet(l,this)?_classPrivateFieldGet(d,this).splice(0,1):(_classPrivateFieldSet(F,this,I),I<_classPrivateFieldGet(d,this).length&&_classPrivateFieldGet(d,this).splice(I)),_classPrivateFieldGet(d,this).push(c)}undo(){_classPrivateFieldGet(F,this)!==-1&&(_classPrivateFieldSet(n,this,!0),_classPrivateFieldGet(d,this)[_classPrivateFieldGet(F,this)].undo(),_classPrivateFieldSet(n,this,!1),_classPrivateFieldSet(F,this,_classPrivateFieldGet(F,this)-1))}redo(){_classPrivateFieldGet(F,this)<_classPrivateFieldGet(d,this).length-1&&(_classPrivateFieldSet(F,this,_classPrivateFieldGet(F,this)+1),_classPrivateFieldSet(n,this,!0),_classPrivateFieldGet(d,this)[_classPrivateFieldGet(F,this)].cmd(),_classPrivateFieldSet(n,this,!1))}hasSomethingToUndo(){return _classPrivateFieldGet(F,this)!==-1}hasSomethingToRedo(){return _classPrivateFieldGet(F,this)<_classPrivateFieldGet(d,this).length-1}destroy(){_classPrivateFieldSet(d,this,null)}}t.CommandManager=y;var a=new WeakSet;class o{constructor(x){_classPrivateMethodInitSpec(this,a),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:nt}=r.FeatureTest.platform;for(const[vt,xt,It={}]of x)for(const Gt of vt){const bt=Gt.startsWith("mac+");nt&&bt?(this.callbacks.set(Gt.slice(4),{callback:xt,options:It}),this.allKeys.add(Gt.split("+").at(-1))):!nt&&!bt&&(this.callbacks.set(Gt,{callback:xt,options:It}),this.allKeys.add(Gt.split("+").at(-1)))}}exec(x,nt){if(!this.allKeys.has(nt.key))return;const vt=this.callbacks.get(_assertClassBrand(a,this,w).call(this,nt));if(!vt)return;const{callback:xt,options:{bubbles:It=!1,args:Gt=[],checker:bt=null}}=vt;bt&&!bt(x,nt)||(xt.bind(x,...Gt)(),It||(nt.stopPropagation(),nt.preventDefault()))}}function w(gt){gt.altKey&&this.buffer.push("alt"),gt.ctrlKey&&this.buffer.push("ctrl"),gt.metaKey&&this.buffer.push("meta"),gt.shiftKey&&this.buffer.push("shift"),this.buffer.push(gt.key);const x=this.buffer.join("+");return this.buffer.length=0,x}t.KeyboardManager=o;class Y{get _colors(){const x=new Map([["CanvasText",null],["Canvas",null]]);return(0,R.getColorValues)(x),(0,r.shadow)(this,"_colors",x)}convert(x){const nt=(0,R.getRGB)(x);if(!window.matchMedia("(forced-colors: active)").matches)return nt;for(const[vt,xt]of this._colors)if(xt.every((It,Gt)=>It===nt[Gt]))return Y._colorsMapping.get(vt);return nt}getHexCode(x){const nt=this._colors.get(x);return nt?r.Util.makeHexColor(...nt):x}}_defineProperty(Y,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),t.ColorManager=Y;var B=new WeakMap,g=new WeakMap,P=new WeakMap,q=new WeakMap,Q=new WeakMap,$=new WeakMap,et=new WeakMap,_t=new WeakMap,X=new WeakMap,b=new WeakMap,N=new WeakMap,rt=new WeakMap,v=new WeakMap,s=new WeakMap,i=new WeakMap,h=new WeakMap,E=new WeakMap,C=new WeakMap,U=new WeakMap,H=new WeakMap,K=new WeakMap,ot=new WeakMap,at=new WeakMap,dt=new WeakMap,ft=new WeakMap,At=new WeakMap,W=new WeakMap,k=new WeakMap,G=new WeakMap,O=new WeakMap,j=new WeakMap,lt=new WeakMap,ut=new WeakMap,st=new WeakMap,it=new WeakSet;class St{static get _keyboardManager(){const x=St.prototype,nt=It=>{const{activeElement:Gt}=document;return Gt&&_classPrivateFieldGet(ut,It).contains(Gt)&&It.hasSomethingToControl()},vt=this.TRANSLATE_SMALL,xt=this.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new o([[["ctrl+a","mac+meta+a"],x.selectAll],[["ctrl+z","mac+meta+z"],x.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],x.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],x.delete],[["Escape","mac+Escape"],x.unselectAll],[["ArrowLeft","mac+ArrowLeft"],x.translateSelectedEditors,{args:[-vt,0],checker:nt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],x.translateSelectedEditors,{args:[-xt,0],checker:nt}],[["ArrowRight","mac+ArrowRight"],x.translateSelectedEditors,{args:[vt,0],checker:nt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],x.translateSelectedEditors,{args:[xt,0],checker:nt}],[["ArrowUp","mac+ArrowUp"],x.translateSelectedEditors,{args:[0,-vt],checker:nt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],x.translateSelectedEditors,{args:[0,-xt],checker:nt}],[["ArrowDown","mac+ArrowDown"],x.translateSelectedEditors,{args:[0,vt],checker:nt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],x.translateSelectedEditors,{args:[0,xt],checker:nt}]]))}constructor(x,nt,vt,xt,It,Gt){_classPrivateMethodInitSpec(this,it),_classPrivateFieldInitSpec(this,B,null),_classPrivateFieldInitSpec(this,g,new Map),_classPrivateFieldInitSpec(this,P,new Map),_classPrivateFieldInitSpec(this,q,null),_classPrivateFieldInitSpec(this,Q,null),_classPrivateFieldInitSpec(this,$,new y),_classPrivateFieldInitSpec(this,et,0),_classPrivateFieldInitSpec(this,_t,new Set),_classPrivateFieldInitSpec(this,X,null),_classPrivateFieldInitSpec(this,b,null),_classPrivateFieldInitSpec(this,N,new Set),_classPrivateFieldInitSpec(this,rt,null),_classPrivateFieldInitSpec(this,v,new f),_classPrivateFieldInitSpec(this,s,!1),_classPrivateFieldInitSpec(this,i,!1),_classPrivateFieldInitSpec(this,h,null),_classPrivateFieldInitSpec(this,E,r.AnnotationEditorType.NONE),_classPrivateFieldInitSpec(this,C,new Set),_classPrivateFieldInitSpec(this,U,null),_classPrivateFieldInitSpec(this,H,this.blur.bind(this)),_classPrivateFieldInitSpec(this,K,this.focus.bind(this)),_classPrivateFieldInitSpec(this,ot,this.copy.bind(this)),_classPrivateFieldInitSpec(this,at,this.cut.bind(this)),_classPrivateFieldInitSpec(this,dt,this.paste.bind(this)),_classPrivateFieldInitSpec(this,ft,this.keydown.bind(this)),_classPrivateFieldInitSpec(this,At,this.onEditingAction.bind(this)),_classPrivateFieldInitSpec(this,W,this.onPageChanging.bind(this)),_classPrivateFieldInitSpec(this,k,this.onScaleChanging.bind(this)),_classPrivateFieldInitSpec(this,G,this.onRotationChanging.bind(this)),_classPrivateFieldInitSpec(this,O,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}),_classPrivateFieldInitSpec(this,j,[0,0]),_classPrivateFieldInitSpec(this,lt,null),_classPrivateFieldInitSpec(this,ut,null),_classPrivateFieldInitSpec(this,st,null),_classPrivateFieldSet(ut,this,x),_classPrivateFieldSet(st,this,nt),_classPrivateFieldSet(q,this,vt),this._eventBus=xt,this._eventBus._on("editingaction",_classPrivateFieldGet(At,this)),this._eventBus._on("pagechanging",_classPrivateFieldGet(W,this)),this._eventBus._on("scalechanging",_classPrivateFieldGet(k,this)),this._eventBus._on("rotationchanging",_classPrivateFieldGet(G,this)),_classPrivateFieldSet(Q,this,It.annotationStorage),_classPrivateFieldSet(rt,this,It.filterFactory),_classPrivateFieldSet(U,this,Gt),this.viewParameters={realScale:R.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){_assertClassBrand(it,this,Rt).call(this),_assertClassBrand(it,this,Mt).call(this),this._eventBus._off("editingaction",_classPrivateFieldGet(At,this)),this._eventBus._off("pagechanging",_classPrivateFieldGet(W,this)),this._eventBus._off("scalechanging",_classPrivateFieldGet(k,this)),this._eventBus._off("rotationchanging",_classPrivateFieldGet(G,this));for(const x of _classPrivateFieldGet(P,this).values())x.destroy();_classPrivateFieldGet(P,this).clear(),_classPrivateFieldGet(g,this).clear(),_classPrivateFieldGet(N,this).clear(),_classPrivateFieldSet(B,this,null),_classPrivateFieldGet(C,this).clear(),_classPrivateFieldGet($,this).destroy(),_classPrivateFieldGet(q,this).destroy()}get hcmFilter(){return(0,r.shadow)(this,"hcmFilter",_classPrivateFieldGet(U,this)?_classPrivateFieldGet(rt,this).addHCMFilter(_classPrivateFieldGet(U,this).foreground,_classPrivateFieldGet(U,this).background):"none")}get direction(){return(0,r.shadow)(this,"direction",getComputedStyle(_classPrivateFieldGet(ut,this)).direction)}editAltText(x){var nt;(nt=_classPrivateFieldGet(q,this))===null||nt===void 0||nt.editAltText(this,x)}onPageChanging(x){let{pageNumber:nt}=x;_classPrivateFieldSet(et,this,nt-1)}focusMainContainer(){_classPrivateFieldGet(ut,this).focus()}findParent(x,nt){for(const vt of _classPrivateFieldGet(P,this).values()){const{x:xt,y:It,width:Gt,height:bt}=vt.div.getBoundingClientRect();if(x>=xt&&x<=xt+Gt&&nt>=It&&nt<=It+bt)return vt}return null}disableUserSelect(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;_classPrivateFieldGet(st,this).classList.toggle("noUserSelect",x)}addShouldRescale(x){_classPrivateFieldGet(N,this).add(x)}removeShouldRescale(x){_classPrivateFieldGet(N,this).delete(x)}onScaleChanging(x){let{scale:nt}=x;this.commitOrRemove(),this.viewParameters.realScale=nt*R.PixelsPerInch.PDF_TO_CSS_UNITS;for(const vt of _classPrivateFieldGet(N,this))vt.onScaleChanging()}onRotationChanging(x){let{pagesRotation:nt}=x;this.commitOrRemove(),this.viewParameters.rotation=nt}addToAnnotationStorage(x){!x.isEmpty()&&_classPrivateFieldGet(Q,this)&&!_classPrivateFieldGet(Q,this).has(x.id)&&_classPrivateFieldGet(Q,this).setValue(x.id,x)}blur(){if(!this.hasSelection)return;const{activeElement:x}=document;for(const nt of _classPrivateFieldGet(C,this))if(nt.div.contains(x)){_classPrivateFieldSet(h,this,[nt,x]),nt._focusEventsAllowed=!1;break}}focus(){if(!_classPrivateFieldGet(h,this))return;const[x,nt]=_classPrivateFieldGet(h,this);_classPrivateFieldSet(h,this,null),nt.addEventListener("focusin",()=>{x._focusEventsAllowed=!0},{once:!0}),nt.focus()}addEditListeners(){_assertClassBrand(it,this,Lt).call(this),_assertClassBrand(it,this,Ft).call(this)}removeEditListeners(){_assertClassBrand(it,this,Rt).call(this),_assertClassBrand(it,this,yt).call(this)}copy(x){var nt;if(x.preventDefault(),(nt=_classPrivateFieldGet(B,this))===null||nt===void 0||nt.commitOrRemove(),!this.hasSelection)return;const vt=[];for(const xt of _classPrivateFieldGet(C,this)){const It=xt.serialize(!0);It&&vt.push(It)}vt.length!==0&&x.clipboardData.setData("application/pdfjs",JSON.stringify(vt))}cut(x){this.copy(x),this.delete()}paste(x){x.preventDefault();const{clipboardData:nt}=x;for(const It of nt.items)for(const Gt of _classPrivateFieldGet(b,this))if(Gt.isHandlingMimeForPasting(It.type)){Gt.paste(It,this.currentLayer);return}let vt=nt.getData("application/pdfjs");if(!vt)return;try{vt=JSON.parse(vt)}catch(It){(0,r.warn)(`paste: "${It.message}".`);return}if(!Array.isArray(vt))return;this.unselectAll();const xt=this.currentLayer;try{const It=[];for(const c of vt){const I=xt.deserialize(c);if(!I)return;It.push(I)}const Gt=()=>{for(const c of It)_assertClassBrand(it,this,pt).call(this,c);_assertClassBrand(it,this,J).call(this,It)},bt=()=>{for(const c of It)c.remove()};this.addCommands({cmd:Gt,undo:bt,mustExec:!0})}catch(It){(0,r.warn)(`paste: "${It.message}".`)}}keydown(x){var nt;(nt=this.getActive())!==null&&nt!==void 0&&nt.shouldGetKeyboardEvents()||St._keyboardManager.exec(this,x)}onEditingAction(x){["undo","redo","delete","selectAll"].includes(x.name)&&this[x.name]()}setEditingState(x){x?(_assertClassBrand(it,this,kt).call(this),_assertClassBrand(it,this,Lt).call(this),_assertClassBrand(it,this,Ft).call(this),_assertClassBrand(it,this,Wt).call(this,{isEditing:_classPrivateFieldGet(E,this)!==r.AnnotationEditorType.NONE,isEmpty:_assertClassBrand(it,this,tt).call(this),hasSomethingToUndo:_classPrivateFieldGet($,this).hasSomethingToUndo(),hasSomethingToRedo:_classPrivateFieldGet($,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(_assertClassBrand(it,this,Mt).call(this),_assertClassBrand(it,this,Rt).call(this),_assertClassBrand(it,this,yt).call(this),_assertClassBrand(it,this,Wt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(x){if(!_classPrivateFieldGet(b,this)){_classPrivateFieldSet(b,this,x);for(const nt of _classPrivateFieldGet(b,this))_assertClassBrand(it,this,Ut).call(this,nt.defaultPropertiesToUpdate)}}getId(){return _classPrivateFieldGet(v,this).getId()}get currentLayer(){return _classPrivateFieldGet(P,this).get(_classPrivateFieldGet(et,this))}getLayer(x){return _classPrivateFieldGet(P,this).get(x)}get currentPageIndex(){return _classPrivateFieldGet(et,this)}addLayer(x){_classPrivateFieldGet(P,this).set(x.pageIndex,x),_classPrivateFieldGet(s,this)?x.enable():x.disable()}removeLayer(x){_classPrivateFieldGet(P,this).delete(x.pageIndex)}updateMode(x){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(_classPrivateFieldGet(E,this)!==x){if(_classPrivateFieldSet(E,this,x),x===r.AnnotationEditorType.NONE){this.setEditingState(!1),_assertClassBrand(it,this,$t).call(this);return}this.setEditingState(!0),_assertClassBrand(it,this,jt).call(this),this.unselectAll();for(const vt of _classPrivateFieldGet(P,this).values())vt.updateMode(x);if(nt){for(const vt of _classPrivateFieldGet(g,this).values())if(vt.annotationElementId===nt){this.setSelected(vt),vt.enterInEditMode();break}}}}updateToolbar(x){x!==_classPrivateFieldGet(E,this)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:x})}updateParams(x,nt){if(_classPrivateFieldGet(b,this)){if(x===r.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(x);return}for(const vt of _classPrivateFieldGet(C,this))vt.updateParams(x,nt);for(const vt of _classPrivateFieldGet(b,this))vt.updateDefaultParams(x,nt)}}enableWaiting(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(_classPrivateFieldGet(i,this)!==x){_classPrivateFieldSet(i,this,x);for(const nt of _classPrivateFieldGet(P,this).values())x?nt.disableClick():nt.enableClick(),nt.div.classList.toggle("waiting",x)}}getEditors(x){const nt=[];for(const vt of _classPrivateFieldGet(g,this).values())vt.pageIndex===x&&nt.push(vt);return nt}getEditor(x){return _classPrivateFieldGet(g,this).get(x)}addEditor(x){_classPrivateFieldGet(g,this).set(x.id,x)}removeEditor(x){if(_classPrivateFieldGet(g,this).delete(x.id),this.unselect(x),!x.annotationElementId||!_classPrivateFieldGet(_t,this).has(x.annotationElementId)){var nt;(nt=_classPrivateFieldGet(Q,this))===null||nt===void 0||nt.remove(x.id)}}addDeletedAnnotationElement(x){_classPrivateFieldGet(_t,this).add(x.annotationElementId),x.deleted=!0}isDeletedAnnotationElement(x){return _classPrivateFieldGet(_t,this).has(x)}removeDeletedAnnotationElement(x){_classPrivateFieldGet(_t,this).delete(x.annotationElementId),x.deleted=!1}setActiveEditor(x){_classPrivateFieldGet(B,this)!==x&&(_classPrivateFieldSet(B,this,x),x&&_assertClassBrand(it,this,Ut).call(this,x.propertiesToUpdate))}toggleSelected(x){if(_classPrivateFieldGet(C,this).has(x)){_classPrivateFieldGet(C,this).delete(x),x.unselect(),_assertClassBrand(it,this,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}_classPrivateFieldGet(C,this).add(x),x.select(),_assertClassBrand(it,this,Ut).call(this,x.propertiesToUpdate),_assertClassBrand(it,this,Wt).call(this,{hasSelectedEditor:!0})}setSelected(x){for(const nt of _classPrivateFieldGet(C,this))nt!==x&&nt.unselect();_classPrivateFieldGet(C,this).clear(),_classPrivateFieldGet(C,this).add(x),x.select(),_assertClassBrand(it,this,Ut).call(this,x.propertiesToUpdate),_assertClassBrand(it,this,Wt).call(this,{hasSelectedEditor:!0})}isSelected(x){return _classPrivateFieldGet(C,this).has(x)}unselect(x){x.unselect(),_classPrivateFieldGet(C,this).delete(x),_assertClassBrand(it,this,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return _classPrivateFieldGet(C,this).size!==0}undo(){_classPrivateFieldGet($,this).undo(),_assertClassBrand(it,this,Wt).call(this,{hasSomethingToUndo:_classPrivateFieldGet($,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_assertClassBrand(it,this,tt).call(this)})}redo(){_classPrivateFieldGet($,this).redo(),_assertClassBrand(it,this,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:_classPrivateFieldGet($,this).hasSomethingToRedo(),isEmpty:_assertClassBrand(it,this,tt).call(this)})}addCommands(x){_classPrivateFieldGet($,this).add(x),_assertClassBrand(it,this,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_assertClassBrand(it,this,tt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const x=[..._classPrivateFieldGet(C,this)],nt=()=>{for(const xt of x)xt.remove()},vt=()=>{for(const xt of x)_assertClassBrand(it,this,pt).call(this,xt)};this.addCommands({cmd:nt,undo:vt,mustExec:!0})}commitOrRemove(){var x;(x=_classPrivateFieldGet(B,this))===null||x===void 0||x.commitOrRemove()}hasSomethingToControl(){return _classPrivateFieldGet(B,this)||this.hasSelection}selectAll(){for(const x of _classPrivateFieldGet(C,this))x.commit();_assertClassBrand(it,this,J).call(this,_classPrivateFieldGet(g,this).values())}unselectAll(){if(_classPrivateFieldGet(B,this)){_classPrivateFieldGet(B,this).commitOrRemove();return}if(this.hasSelection){for(const x of _classPrivateFieldGet(C,this))x.unselect();_classPrivateFieldGet(C,this).clear(),_assertClassBrand(it,this,Wt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(x,nt){if((arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1)||this.commitOrRemove(),!this.hasSelection)return;_classPrivateFieldGet(j,this)[0]+=x,_classPrivateFieldGet(j,this)[1]+=nt;const[xt,It]=_classPrivateFieldGet(j,this),Gt=[..._classPrivateFieldGet(C,this)],bt=1e3;_classPrivateFieldGet(lt,this)&&clearTimeout(_classPrivateFieldGet(lt,this)),_classPrivateFieldSet(lt,this,setTimeout(()=>{_classPrivateFieldSet(lt,this,null),_classPrivateFieldGet(j,this)[0]=_classPrivateFieldGet(j,this)[1]=0,this.addCommands({cmd:()=>{for(const c of Gt)_classPrivateFieldGet(g,this).has(c.id)&&c.translateInPage(xt,It)},undo:()=>{for(const c of Gt)_classPrivateFieldGet(g,this).has(c.id)&&c.translateInPage(-xt,-It)},mustExec:!1})},bt));for(const c of Gt)c.translateInPage(x,nt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_classPrivateFieldSet(X,this,new Map);for(const x of _classPrivateFieldGet(C,this))_classPrivateFieldGet(X,this).set(x,{savedX:x.x,savedY:x.y,savedPageIndex:x.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!_classPrivateFieldGet(X,this))return!1;this.disableUserSelect(!1);const x=_classPrivateFieldGet(X,this);_classPrivateFieldSet(X,this,null);let nt=!1;for(const[{x:xt,y:It,pageIndex:Gt},bt]of x)bt.newX=xt,bt.newY=It,bt.newPageIndex=Gt,nt||(nt=xt!==bt.savedX||It!==bt.savedY||Gt!==bt.savedPageIndex);if(!nt)return!1;const vt=(xt,It,Gt,bt)=>{if(_classPrivateFieldGet(g,this).has(xt.id)){const c=_classPrivateFieldGet(P,this).get(bt);c?xt._setParentAndPosition(c,It,Gt):(xt.pageIndex=bt,xt.x=It,xt.y=Gt)}};return this.addCommands({cmd:()=>{for(const[xt,{newX:It,newY:Gt,newPageIndex:bt}]of x)vt(xt,It,Gt,bt)},undo:()=>{for(const[xt,{savedX:It,savedY:Gt,savedPageIndex:bt}]of x)vt(xt,It,Gt,bt)},mustExec:!0}),!0}dragSelectedEditors(x,nt){if(_classPrivateFieldGet(X,this))for(const vt of _classPrivateFieldGet(X,this).keys())vt.drag(x,nt)}rebuild(x){if(x.parent===null){const nt=this.getLayer(x.pageIndex);nt?(nt.changeParent(x),nt.addOrRebuild(x)):(this.addEditor(x),this.addToAnnotationStorage(x),x.rebuild())}else x.parent.addOrRebuild(x)}isActive(x){return _classPrivateFieldGet(B,this)===x}getActive(){return _classPrivateFieldGet(B,this)}getMode(){return _classPrivateFieldGet(E,this)}get imageManager(){return(0,r.shadow)(this,"imageManager",new S)}}function kt(){window.addEventListener("focus",_classPrivateFieldGet(K,this)),window.addEventListener("blur",_classPrivateFieldGet(H,this))}function Mt(){window.removeEventListener("focus",_classPrivateFieldGet(K,this)),window.removeEventListener("blur",_classPrivateFieldGet(H,this))}function Lt(){window.addEventListener("keydown",_classPrivateFieldGet(ft,this),{capture:!0})}function Rt(){window.removeEventListener("keydown",_classPrivateFieldGet(ft,this),{capture:!0})}function Ft(){document.addEventListener("copy",_classPrivateFieldGet(ot,this)),document.addEventListener("cut",_classPrivateFieldGet(at,this)),document.addEventListener("paste",_classPrivateFieldGet(dt,this))}function yt(){document.removeEventListener("copy",_classPrivateFieldGet(ot,this)),document.removeEventListener("cut",_classPrivateFieldGet(at,this)),document.removeEventListener("paste",_classPrivateFieldGet(dt,this))}function Wt(gt){Object.entries(gt).some(nt=>{let[vt,xt]=nt;return _classPrivateFieldGet(O,this)[vt]!==xt})&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(_classPrivateFieldGet(O,this),gt)})}function Ut(gt){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:gt})}function jt(){if(!_classPrivateFieldGet(s,this)){_classPrivateFieldSet(s,this,!0);for(const gt of _classPrivateFieldGet(P,this).values())gt.enable()}}function $t(){if(this.unselectAll(),_classPrivateFieldGet(s,this)){_classPrivateFieldSet(s,this,!1);for(const gt of _classPrivateFieldGet(P,this).values())gt.disable()}}function pt(gt){const x=_classPrivateFieldGet(P,this).get(gt.pageIndex);x?x.addOrRebuild(gt):this.addEditor(gt)}function tt(){if(_classPrivateFieldGet(g,this).size===0)return!0;if(_classPrivateFieldGet(g,this).size===1)for(const gt of _classPrivateFieldGet(g,this).values())return gt.isEmpty();return!1}function J(gt){_classPrivateFieldGet(C,this).clear();for(const x of gt)x.isEmpty()||(_classPrivateFieldGet(C,this).add(x),x.select());_assertClassBrand(it,this,Wt).call(this,{hasSelectedEditor:!0})}_defineProperty(St,"TRANSLATE_SMALL",1),_defineProperty(St,"TRANSLATE_BIG",10),t.AnnotationEditorUIManager=St},(T,t,_)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=U,t.getColorValues=dt,t.getCurrentTransform=ft,t.getCurrentTransformInverse=At,t.getFilenameFromUrl=v,t.getPdfFilenameFromUrl=s,t.getRGB=at,t.getXfaPageViewport=ot,t.isDataScheme=N,t.isPdfFile=rt,t.isValidFetchUrl=h,t.loadScript=C,t.noContextMenu=E,t.setLayerDimensions=W;var r=_(7),R=_(1);const L="http://www.w3.org/2000/svg";class V{}e=V,_defineProperty(V,"CSS",96),_defineProperty(V,"PDF",72),_defineProperty(V,"PDF_TO_CSS_UNITS",e.CSS/e.PDF),t.PixelsPerInch=V;var D=new WeakMap,f=new WeakMap,A=new WeakMap,M=new WeakMap,p=new WeakMap,m=new WeakMap,S=new WeakMap,u=new WeakMap,d=new WeakMap,n=new WeakMap,l=new WeakMap,F=new WeakSet;class y extends r.BaseFilterFactory{constructor(){let{docId:G,ownerDocument:O=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),_classPrivateMethodInitSpec(this,F),_classPrivateFieldInitSpec(this,D,void 0),_classPrivateFieldInitSpec(this,f,void 0),_classPrivateFieldInitSpec(this,A,void 0),_classPrivateFieldInitSpec(this,M,void 0),_classPrivateFieldInitSpec(this,p,void 0),_classPrivateFieldInitSpec(this,m,void 0),_classPrivateFieldInitSpec(this,S,void 0),_classPrivateFieldInitSpec(this,u,void 0),_classPrivateFieldInitSpec(this,d,void 0),_classPrivateFieldInitSpec(this,n,void 0),_classPrivateFieldInitSpec(this,l,0),_classPrivateFieldSet(A,this,G),_classPrivateFieldSet(M,this,O)}addFilter(G){var O,j;if(!G)return"none";let lt=_classPrivateGetter(F,this,a).get(G);if(lt)return lt;let ut,st,it,St;if(G.length===1){const Rt=G[0],Ft=new Array(256);for(let yt=0;yt<256;yt++)Ft[yt]=Rt[yt]/255;St=ut=st=it=Ft.join(",")}else{const[Rt,Ft,yt]=G,Wt=new Array(256),Ut=new Array(256),jt=new Array(256);for(let $t=0;$t<256;$t++)Wt[$t]=Rt[$t]/255,Ut[$t]=Ft[$t]/255,jt[$t]=yt[$t]/255;ut=Wt.join(","),st=Ut.join(","),it=jt.join(","),St=`${ut}${st}${it}`}if(lt=_classPrivateGetter(F,this,a).get(St),lt)return _classPrivateGetter(F,this,a).set(G,lt),lt;const kt=`g_${_classPrivateFieldGet(A,this)}_transfer_map_${_classPrivateFieldSet(l,this,(O=_classPrivateFieldGet(l,this),j=O++,O)),j}`,Mt=`url(#${kt})`;_classPrivateGetter(F,this,a).set(G,Mt),_classPrivateGetter(F,this,a).set(St,Mt);const Lt=_assertClassBrand(F,this,Y).call(this,kt);return _assertClassBrand(F,this,g).call(this,ut,st,it,Lt),Mt}addHCMFilter(G,O){var j;const lt=`${G}-${O}`;if(_classPrivateFieldGet(m,this)===lt)return _classPrivateFieldGet(S,this);if(_classPrivateFieldSet(m,this,lt),_classPrivateFieldSet(S,this,"none"),(j=_classPrivateFieldGet(p,this))===null||j===void 0||j.remove(),!G||!O)return _classPrivateFieldGet(S,this);const ut=_assertClassBrand(F,this,P).call(this,G);G=R.Util.makeHexColor(...ut);const st=_assertClassBrand(F,this,P).call(this,O);if(O=R.Util.makeHexColor(...st),_classPrivateGetter(F,this,o).style.color="",G==="#000000"&&O==="#ffffff"||G===O)return _classPrivateFieldGet(S,this);const it=new Array(256);for(let Rt=0;Rt<=255;Rt++){const Ft=Rt/255;it[Rt]=Ft<=.03928?Ft/12.92:((Ft+.055)/1.055)**2.4}const St=it.join(","),kt=`g_${_classPrivateFieldGet(A,this)}_hcm_filter`,Mt=_classPrivateFieldSet(u,this,_assertClassBrand(F,this,Y).call(this,kt));_assertClassBrand(F,this,g).call(this,St,St,St,Mt),_assertClassBrand(F,this,w).call(this,Mt);const Lt=(Rt,Ft)=>{const yt=ut[Rt]/255,Wt=st[Rt]/255,Ut=new Array(Ft+1);for(let jt=0;jt<=Ft;jt++)Ut[jt]=yt+jt/Ft*(Wt-yt);return Ut.join(",")};return _assertClassBrand(F,this,g).call(this,Lt(0,5),Lt(1,5),Lt(2,5),Mt),_classPrivateFieldSet(S,this,`url(#${kt})`),_classPrivateFieldGet(S,this)}addHighlightHCMFilter(G,O,j,lt){var ut;const st=`${G}-${O}-${j}-${lt}`;if(_classPrivateFieldGet(d,this)===st)return _classPrivateFieldGet(n,this);if(_classPrivateFieldSet(d,this,st),_classPrivateFieldSet(n,this,"none"),(ut=_classPrivateFieldGet(u,this))===null||ut===void 0||ut.remove(),!G||!O)return _classPrivateFieldGet(n,this);const[it,St]=[G,O].map(_assertClassBrand(F,this,P).bind(this));let kt=Math.round(.2126*it[0]+.7152*it[1]+.0722*it[2]),Mt=Math.round(.2126*St[0]+.7152*St[1]+.0722*St[2]),[Lt,Rt]=[j,lt].map(_assertClassBrand(F,this,P).bind(this));Mt<kt&&([kt,Mt,Lt,Rt]=[Mt,kt,Rt,Lt]),_classPrivateGetter(F,this,o).style.color="";const Ft=(Ut,jt,$t)=>{const pt=new Array(256),tt=(Mt-kt)/$t,J=Ut/255,gt=(jt-Ut)/(255*$t);let x=0;for(let nt=0;nt<=$t;nt++){const vt=Math.round(kt+nt*tt),xt=J+nt*gt;for(let It=x;It<=vt;It++)pt[It]=xt;x=vt+1}for(let nt=x;nt<256;nt++)pt[nt]=pt[x-1];return pt.join(",")},yt=`g_${_classPrivateFieldGet(A,this)}_hcm_highlight_filter`,Wt=_classPrivateFieldSet(u,this,_assertClassBrand(F,this,Y).call(this,yt));return _assertClassBrand(F,this,w).call(this,Wt),_assertClassBrand(F,this,g).call(this,Ft(Lt[0],Rt[0],5),Ft(Lt[1],Rt[1],5),Ft(Lt[2],Rt[2],5),Wt),_classPrivateFieldSet(n,this,`url(#${yt})`),_classPrivateFieldGet(n,this)}destroy(){arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&(_classPrivateFieldGet(S,this)||_classPrivateFieldGet(n,this))||(_classPrivateFieldGet(f,this)&&(_classPrivateFieldGet(f,this).parentNode.parentNode.remove(),_classPrivateFieldSet(f,this,null)),_classPrivateFieldGet(D,this)&&(_classPrivateFieldGet(D,this).clear(),_classPrivateFieldSet(D,this,null)),_classPrivateFieldSet(l,this,0))}}function a(k){return _classPrivateFieldGet(D,k)||_classPrivateFieldSet(D,k,new Map)}function o(k){if(!_classPrivateFieldGet(f,k)){const G=_classPrivateFieldGet(M,k).createElement("div"),{style:O}=G;O.visibility="hidden",O.contain="strict",O.width=O.height=0,O.position="absolute",O.top=O.left=0,O.zIndex=-1;const j=_classPrivateFieldGet(M,k).createElementNS(L,"svg");j.setAttribute("width",0),j.setAttribute("height",0),_classPrivateFieldSet(f,k,_classPrivateFieldGet(M,k).createElementNS(L,"defs")),G.append(j),j.append(_classPrivateFieldGet(f,k)),_classPrivateFieldGet(M,k).body.append(G)}return _classPrivateFieldGet(f,k)}function w(k){const G=_classPrivateFieldGet(M,this).createElementNS(L,"feColorMatrix");G.setAttribute("type","matrix"),G.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),k.append(G)}function Y(k){const G=_classPrivateFieldGet(M,this).createElementNS(L,"filter");return G.setAttribute("color-interpolation-filters","sRGB"),G.setAttribute("id",k),_classPrivateGetter(F,this,o).append(G),G}function B(k,G,O){const j=_classPrivateFieldGet(M,this).createElementNS(L,G);j.setAttribute("type","discrete"),j.setAttribute("tableValues",O),k.append(j)}function g(k,G,O,j){const lt=_classPrivateFieldGet(M,this).createElementNS(L,"feComponentTransfer");j.append(lt),_assertClassBrand(F,this,B).call(this,lt,"feFuncR",k),_assertClassBrand(F,this,B).call(this,lt,"feFuncG",G),_assertClassBrand(F,this,B).call(this,lt,"feFuncB",O)}function P(k){return _classPrivateGetter(F,this,o).style.color=k,at(getComputedStyle(_classPrivateGetter(F,this,o)).getPropertyValue("color"))}t.DOMFilterFactory=y;class q extends r.BaseCanvasFactory{constructor(){let{ownerDocument:G=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._document=G}_createCanvas(G,O){const j=this._document.createElement("canvas");return j.width=G,j.height=O,j}}t.DOMCanvasFactory=q;async function Q(k){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(h(k,document.baseURI)){const O=await fetch(k);if(!O.ok)throw new Error(O.statusText);return G?new Uint8Array(await O.arrayBuffer()):(0,R.stringToBytes)(await O.text())}return new Promise((O,j)=>{const lt=new XMLHttpRequest;lt.open("GET",k,!0),G&&(lt.responseType="arraybuffer"),lt.onreadystatechange=()=>{if(lt.readyState===XMLHttpRequest.DONE){if(lt.status===200||lt.status===0){let ut;if(G&&lt.response?ut=new Uint8Array(lt.response):!G&&lt.responseText&&(ut=(0,R.stringToBytes)(lt.responseText)),ut){O(ut);return}}j(new Error(lt.statusText))}},lt.send(null)})}class $ extends r.BaseCMapReaderFactory{_fetchData(G,O){return Q(G,this.isCompressed).then(j=>({cMapData:j,compressionType:O}))}}t.DOMCMapReaderFactory=$;class et extends r.BaseStandardFontDataFactory{_fetchData(G){return Q(G,!0)}}t.DOMStandardFontDataFactory=et;class _t extends r.BaseSVGFactory{_createSVG(G){return document.createElementNS(L,G)}}t.DOMSVGFactory=_t;class X{constructor(G){let{viewBox:O,scale:j,rotation:lt,offsetX:ut=0,offsetY:st=0,dontFlip:it=!1}=G;this.viewBox=O,this.scale=j,this.rotation=lt,this.offsetX=ut,this.offsetY=st;const St=(O[2]+O[0])/2,kt=(O[3]+O[1])/2;let Mt,Lt,Rt,Ft;switch(lt%=360,lt<0&&(lt+=360),lt){case 180:Mt=-1,Lt=0,Rt=0,Ft=1;break;case 90:Mt=0,Lt=1,Rt=1,Ft=0;break;case 270:Mt=0,Lt=-1,Rt=-1,Ft=0;break;case 0:Mt=1,Lt=0,Rt=0,Ft=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}it&&(Rt=-Rt,Ft=-Ft);let yt,Wt,Ut,jt;Mt===0?(yt=Math.abs(kt-O[1])*j+ut,Wt=Math.abs(St-O[0])*j+st,Ut=(O[3]-O[1])*j,jt=(O[2]-O[0])*j):(yt=Math.abs(St-O[0])*j+ut,Wt=Math.abs(kt-O[1])*j+st,Ut=(O[2]-O[0])*j,jt=(O[3]-O[1])*j),this.transform=[Mt*j,Lt*j,Rt*j,Ft*j,yt-Mt*j*St-Rt*j*kt,Wt-Lt*j*St-Ft*j*kt],this.width=Ut,this.height=jt}get rawDims(){const{viewBox:G}=this;return(0,R.shadow)(this,"rawDims",{pageWidth:G[2]-G[0],pageHeight:G[3]-G[1],pageX:G[0],pageY:G[1]})}clone(){let{scale:G=this.scale,rotation:O=this.rotation,offsetX:j=this.offsetX,offsetY:lt=this.offsetY,dontFlip:ut=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new X({viewBox:this.viewBox.slice(),scale:G,rotation:O,offsetX:j,offsetY:lt,dontFlip:ut})}convertToViewportPoint(G,O){return R.Util.applyTransform([G,O],this.transform)}convertToViewportRectangle(G){const O=R.Util.applyTransform([G[0],G[1]],this.transform),j=R.Util.applyTransform([G[2],G[3]],this.transform);return[O[0],O[1],j[0],j[1]]}convertToPdfPoint(G,O){return R.Util.applyInverseTransform([G,O],this.transform)}}t.PageViewport=X;class b extends R.BaseException{constructor(G){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(G,"RenderingCancelledException"),this.extraDelay=O}}t.RenderingCancelledException=b;function N(k){const G=k.length;let O=0;for(;O<G&&k[O].trim()==="";)O++;return k.substring(O,O+5).toLowerCase()==="data:"}function rt(k){return typeof k=="string"&&/\.pdf$/i.test(k)}function v(k){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)||([k]=k.split(/[#?]/,1)),k.substring(k.lastIndexOf("/")+1)}function s(k){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"document.pdf";if(typeof k!="string")return G;if(N(k))return(0,R.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),G;const O=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,j=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,lt=O.exec(k);let ut=j.exec(lt[1])||j.exec(lt[2])||j.exec(lt[3]);if(ut&&(ut=ut[0],ut.includes("%")))try{ut=j.exec(decodeURIComponent(ut))[0]}catch{}return ut||G}class i{constructor(){_defineProperty(this,"started",Object.create(null)),_defineProperty(this,"times",[])}time(G){G in this.started&&(0,R.warn)(`Timer is already running for ${G}`),this.started[G]=Date.now()}timeEnd(G){G in this.started||(0,R.warn)(`Timer has not been started for ${G}`),this.times.push({name:G,start:this.started[G],end:Date.now()}),delete this.started[G]}toString(){const G=[];let O=0;for(const{name:j}of this.times)O=Math.max(j.length,O);for(const{name:j,start:lt,end:ut}of this.times)G.push(`${j.padEnd(O)} ${ut-lt}ms
`);return G.join("")}}t.StatTimer=i;function h(k,G){try{const{protocol:O}=G?new URL(k,G):new URL(k);return O==="http:"||O==="https:"}catch{return!1}}function E(k){k.preventDefault()}function C(k){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise((O,j)=>{const lt=document.createElement("script");lt.src=k,lt.onload=function(ut){G&&lt.remove(),O(ut)},lt.onerror=function(){j(new Error(`Cannot load script at: ${lt.src}`))},(document.head||document.documentElement).append(lt)})}function U(k){console.log("Deprecated API usage: "+k)}let H;class K{static toDateObject(G){if(!G||typeof G!="string")return null;H||(H=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const O=H.exec(G);if(!O)return null;const j=parseInt(O[1],10);let lt=parseInt(O[2],10);lt=lt>=1&&lt<=12?lt-1:0;let ut=parseInt(O[3],10);ut=ut>=1&&ut<=31?ut:1;let st=parseInt(O[4],10);st=st>=0&&st<=23?st:0;let it=parseInt(O[5],10);it=it>=0&&it<=59?it:0;let St=parseInt(O[6],10);St=St>=0&&St<=59?St:0;const kt=O[7]||"Z";let Mt=parseInt(O[8],10);Mt=Mt>=0&&Mt<=23?Mt:0;let Lt=parseInt(O[9],10)||0;return Lt=Lt>=0&&Lt<=59?Lt:0,kt==="-"?(st+=Mt,it+=Lt):kt==="+"&&(st-=Mt,it-=Lt),new Date(Date.UTC(j,lt,ut,st,it,St))}}t.PDFDateString=K;function ot(k,G){let{scale:O=1,rotation:j=0}=G;const{width:lt,height:ut}=k.attributes.style,st=[0,0,parseInt(lt),parseInt(ut)];return new X({viewBox:st,scale:O,rotation:j})}function at(k){if(k.startsWith("#")){const G=parseInt(k.slice(1),16);return[(G&16711680)>>16,(G&65280)>>8,G&255]}return k.startsWith("rgb(")?k.slice(4,-1).split(",").map(G=>parseInt(G)):k.startsWith("rgba(")?k.slice(5,-1).split(",").map(G=>parseInt(G)).slice(0,3):((0,R.warn)(`Not a valid color format: "${k}"`),[0,0,0])}function dt(k){const G=document.createElement("span");G.style.visibility="hidden",document.body.append(G);for(const O of k.keys()){G.style.color=O;const j=window.getComputedStyle(G).color;k.set(O,at(j))}G.remove()}function ft(k){const{a:G,b:O,c:j,d:lt,e:ut,f:st}=k.getTransform();return[G,O,j,lt,ut,st]}function At(k){const{a:G,b:O,c:j,d:lt,e:ut,f:st}=k.getTransform().invertSelf();return[G,O,j,lt,ut,st]}function W(k,G){let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;if(G instanceof X){const{pageWidth:lt,pageHeight:ut}=G.rawDims,{style:st}=k,it=R.FeatureTest.isCSSRoundSupported,St=`var(--scale-factor) * ${lt}px`,kt=`var(--scale-factor) * ${ut}px`,Mt=it?`round(${St}, 1px)`:`calc(${St})`,Lt=it?`round(${kt}, 1px)`:`calc(${kt})`;!O||G.rotation%180===0?(st.width=Mt,st.height=Lt):(st.width=Lt,st.height=Mt)}j&&k.setAttribute("data-main-rotation",G.rotation)}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var e=_(1);class r{constructor(){this.constructor===r&&(0,e.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(A){return"none"}addHCMFilter(A,M){return"none"}addHighlightHCMFilter(A,M,p,m){return"none"}destroy(){}}t.BaseFilterFactory=r;class R{constructor(){this.constructor===R&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(A,M){if(A<=0||M<=0)throw new Error("Invalid canvas size");const p=this._createCanvas(A,M);return{canvas:p,context:p.getContext("2d")}}reset(A,M,p){if(!A.canvas)throw new Error("Canvas is not specified");if(M<=0||p<=0)throw new Error("Invalid canvas size");A.canvas.width=M,A.canvas.height=p}destroy(A){if(!A.canvas)throw new Error("Canvas is not specified");A.canvas.width=0,A.canvas.height=0,A.canvas=null,A.context=null}_createCanvas(A,M){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=R;class L{constructor(A){let{baseUrl:M=null,isCompressed:p=!0}=A;this.constructor===L&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=M,this.isCompressed=p}async fetch(A){let{name:M}=A;if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!M)throw new Error("CMap name must be specified.");const p=this.baseUrl+M+(this.isCompressed?".bcmap":""),m=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(p,m).catch(S=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${p}`)})}_fetchData(A,M){(0,e.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=L;class V{constructor(A){let{baseUrl:M=null}=A;this.constructor===V&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=M}async fetch(A){let{filename:M}=A;if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!M)throw new Error("Font filename must be specified.");const p=`${this.baseUrl}${M}`;return this._fetchData(p).catch(m=>{throw new Error(`Unable to load font data at: ${p}`)})}_fetchData(A){(0,e.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=V;class D{constructor(){this.constructor===D&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(A,M){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(A<=0||M<=0)throw new Error("Invalid SVG dimensions");const m=this._createSVG("svg:svg");return m.setAttribute("version","1.1"),p||(m.setAttribute("width",`${A}px`),m.setAttribute("height",`${M}px`)),m.setAttribute("preserveAspectRatio","none"),m.setAttribute("viewBox",`0 0 ${A} ${M}`),m}createElement(A){if(typeof A!="string")throw new Error("Invalid SVG element type");return this._createSVG(A)}_createSVG(A){(0,e.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=D},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var e=_(1);const r=3285377520,R=4294901760,L=65535;class V{constructor(f){this.h1=f?f&4294967295:r,this.h2=f?f&4294967295:r}update(f){let A,M;if(typeof f=="string"){A=new Uint8Array(f.length*2),M=0;for(let w=0,Y=f.length;w<Y;w++){const B=f.charCodeAt(w);B<=255?A[M++]=B:(A[M++]=B>>>8,A[M++]=B&255)}}else if((0,e.isArrayBuffer)(f))A=f.slice(),M=A.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const p=M>>2,m=M-p*4,S=new Uint32Array(A.buffer,0,p);let u=0,d=0,n=this.h1,l=this.h2;const F=3432918353,y=461845907,a=F&L,o=y&L;for(let w=0;w<p;w++)w&1?(u=S[w],u=u*F&R|u*a&L,u=u<<15|u>>>17,u=u*y&R|u*o&L,n^=u,n=n<<13|n>>>19,n=n*5+3864292196):(d=S[w],d=d*F&R|d*a&L,d=d<<15|d>>>17,d=d*y&R|d*o&L,l^=d,l=l<<13|l>>>19,l=l*5+3864292196);switch(u=0,m){case 3:u^=A[p*4+2]<<16;case 2:u^=A[p*4+1]<<8;case 1:u^=A[p*4],u=u*F&R|u*a&L,u=u<<15|u>>>17,u=u*y&R|u*o&L,p&1?n^=u:l^=u}this.h1=n,this.h2=l}hexdigest(){let f=this.h1,A=this.h2;return f^=A>>>1,f=f*3981806797&R|f*36045&L,A=A*4283543511&R|((A<<16|f>>>16)*2950163797&R)>>>16,f^=A>>>1,f=f*444984403&R|f*60499&L,A=A*3301882366&R|((A<<16|f>>>16)*3120437893&R)>>>16,f^=A>>>1,(f>>>0).toString(16).padStart(8,"0")+(A>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=V},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var e=_(1),r=new WeakMap;class R{constructor(D){let{ownerDocument:f=globalThis.document,styleElement:A=null}=D;_classPrivateFieldInitSpec(this,r,new Set),this._document=f,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(D){this.nativeFontFaces.add(D),this._document.fonts.add(D)}removeNativeFontFace(D){this.nativeFontFaces.delete(D),this._document.fonts.delete(D)}insertRule(D){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const f=this.styleElement.sheet;f.insertRule(D,f.cssRules.length)}clear(){for(const D of this.nativeFontFaces)this._document.fonts.delete(D);this.nativeFontFaces.clear(),_classPrivateFieldGet(r,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(D){if(!(!D||_classPrivateFieldGet(r,this).has(D.loadedName))){if((0,e.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:f,src:A,style:M}=D,p=new FontFace(f,A,M);this.addNativeFontFace(p);try{await p.load(),_classPrivateFieldGet(r,this).add(f)}catch{(0,e.warn)(`Cannot load system font: ${D.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(p)}return}(0,e.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(D){if(D.attached||D.missingFile&&!D.systemFontInfo)return;if(D.attached=!0,D.systemFontInfo){await this.loadSystemFont(D.systemFontInfo);return}if(this.isFontLoadingAPISupported){const A=D.createNativeFontFace();if(A){this.addNativeFontFace(A);try{await A.loaded}catch(M){throw(0,e.warn)(`Failed to load font '${A.family}': '${M}'.`),D.disableFontFace=!0,M}}return}const f=D.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(A=>{const M=this._queueLoadingCallback(A);this._prepareFontLoadEvent(D,M)})}}get isFontLoadingAPISupported(){var D;const f=!!((D=this._document)!==null&&D!==void 0&&D.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",f)}get isSyncFontLoadingSupported(){let D=!1;return(e.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(D=!0),(0,e.shadow)(this,"isSyncFontLoadingSupported",D)}_queueLoadingCallback(D){function f(){for((0,e.assert)(!M.done,"completeRequest() cannot be called twice."),M.done=!0;A.length>0&&A[0].done;){const p=A.shift();setTimeout(p.callback,0)}}const{loadingRequests:A}=this,M={done:!1,complete:f,callback:D};return A.push(M),M}get _loadTestFont(){const D=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,e.shadow)(this,"_loadTestFont",D)}_prepareFontLoadEvent(D,f){function A(P,q){return P.charCodeAt(q)<<24|P.charCodeAt(q+1)<<16|P.charCodeAt(q+2)<<8|P.charCodeAt(q+3)&255}function M(P,q,Q,$){const et=P.substring(0,q),_t=P.substring(q+Q);return et+$+_t}let p,m;const S=this._document.createElement("canvas");S.width=1,S.height=1;const u=S.getContext("2d");let d=0;function n(P,q){if(++d>30){(0,e.warn)("Load test font never loaded."),q();return}if(u.font="30px "+P,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){q();return}setTimeout(n.bind(null,P,q))}const l=`lt${Date.now()}${this.loadTestFontId++}`;let F=this._loadTestFont;F=M(F,976,l.length,l);const a=16,o=1482184792;let w=A(F,a);for(p=0,m=l.length-3;p<m;p+=4)w=w-o+A(l,p)|0;p<l.length&&(w=w-o+A(l+"XXX",p)|0),F=M(F,a,4,(0,e.string32)(w));const Y=`url(data:font/opentype;base64,${btoa(F)});`,B=`@font-face {font-family:"${l}";src:${Y}}`;this.insertRule(B);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const P of[D.loadedName,l]){const q=this._document.createElement("span");q.textContent="Hi",q.style.fontFamily=P,g.append(q)}this._document.body.append(g),n(l,()=>{g.remove(),f.complete()})}}t.FontLoader=R;class L{constructor(D,f){let{isEvalSupported:A=!0,disableFontFace:M=!1,ignoreErrors:p=!1,inspectFont:m=null}=f;this.compiledGlyphs=Object.create(null);for(const S in D)this[S]=D[S];this.isEvalSupported=A!==!1,this.disableFontFace=M===!0,this.ignoreErrors=p===!0,this._inspectFont=m}createNativeFontFace(){var D;if(!this.data||this.disableFontFace)return null;let f;if(!this.cssFontInfo)f=new FontFace(this.loadedName,this.data,{});else{const A={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(A.style=`oblique ${this.cssFontInfo.italicAngle}deg`),f=new FontFace(this.cssFontInfo.fontFamily,this.data,A)}return(D=this._inspectFont)===null||D===void 0||D.call(this,this),f}createFontFaceRule(){var D;if(!this.data||this.disableFontFace)return null;const f=(0,e.bytesToString)(this.data),A=`url(data:${this.mimetype};base64,${btoa(f)});`;let M;if(!this.cssFontInfo)M=`@font-face {font-family:"${this.loadedName}";src:${A}}`;else{let p=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(p+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),M=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${p}src:${A}}`}return(D=this._inspectFont)===null||D===void 0||D.call(this,this,A),M}getPathGenerator(D,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let A;try{A=D.get(this.loadedName+"_path_"+f)}catch(M){if(!this.ignoreErrors)throw M;return(0,e.warn)(`getPathGenerator - ignoring character: "${M}".`),this.compiledGlyphs[f]=function(p,m){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const M=[];for(const p of A){const m=p.args!==void 0?p.args.join(","):"";M.push("c.",p.cmd,"(",m,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",M.join(""))}return this.compiledGlyphs[f]=function(M,p){for(const m of A)m.cmd==="scale"&&(m.args=[p,-p]),M[m.cmd].apply(M,m.args)}}}t.FontFaceObject=L},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var e=_(7);_(1);const r=function(f){return new Promise((A,M)=>{require$$5.readFile(f,(m,S)=>{if(m||!S){M(new Error(m));return}A(new Uint8Array(S))})})};class R extends e.BaseFilterFactory{}t.NodeFilterFactory=R;class L extends e.BaseCanvasFactory{_createCanvas(A,M){return require$$5.createCanvas(A,M)}}t.NodeCanvasFactory=L;class V extends e.BaseCMapReaderFactory{_fetchData(A,M){return r(A).then(p=>({cMapData:p,compressionType:M}))}}t.NodeCMapReaderFactory=V;class D extends e.BaseStandardFontDataFactory{_fetchData(A){return r(A)}}t.NodeStandardFontDataFactory=D},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var e=_(1),r=_(6),R=_(12),L=_(13);const V=16,D=100,f=4096,A=15,M=10,p=1e3,m=16;function S(v,s){if(v._removeMirroring)throw new Error("Context is already forwarding operations.");v.__originalSave=v.save,v.__originalRestore=v.restore,v.__originalRotate=v.rotate,v.__originalScale=v.scale,v.__originalTranslate=v.translate,v.__originalTransform=v.transform,v.__originalSetTransform=v.setTransform,v.__originalResetTransform=v.resetTransform,v.__originalClip=v.clip,v.__originalMoveTo=v.moveTo,v.__originalLineTo=v.lineTo,v.__originalBezierCurveTo=v.bezierCurveTo,v.__originalRect=v.rect,v.__originalClosePath=v.closePath,v.__originalBeginPath=v.beginPath,v._removeMirroring=()=>{v.save=v.__originalSave,v.restore=v.__originalRestore,v.rotate=v.__originalRotate,v.scale=v.__originalScale,v.translate=v.__originalTranslate,v.transform=v.__originalTransform,v.setTransform=v.__originalSetTransform,v.resetTransform=v.__originalResetTransform,v.clip=v.__originalClip,v.moveTo=v.__originalMoveTo,v.lineTo=v.__originalLineTo,v.bezierCurveTo=v.__originalBezierCurveTo,v.rect=v.__originalRect,v.closePath=v.__originalClosePath,v.beginPath=v.__originalBeginPath,delete v._removeMirroring},v.save=function(){s.save(),this.__originalSave()},v.restore=function(){s.restore(),this.__originalRestore()},v.translate=function(h,E){s.translate(h,E),this.__originalTranslate(h,E)},v.scale=function(h,E){s.scale(h,E),this.__originalScale(h,E)},v.transform=function(h,E,C,U,H,K){s.transform(h,E,C,U,H,K),this.__originalTransform(h,E,C,U,H,K)},v.setTransform=function(h,E,C,U,H,K){s.setTransform(h,E,C,U,H,K),this.__originalSetTransform(h,E,C,U,H,K)},v.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},v.rotate=function(h){s.rotate(h),this.__originalRotate(h)},v.clip=function(h){s.clip(h),this.__originalClip(h)},v.moveTo=function(i,h){s.moveTo(i,h),this.__originalMoveTo(i,h)},v.lineTo=function(i,h){s.lineTo(i,h),this.__originalLineTo(i,h)},v.bezierCurveTo=function(i,h,E,C,U,H){s.bezierCurveTo(i,h,E,C,U,H),this.__originalBezierCurveTo(i,h,E,C,U,H)},v.rect=function(i,h,E,C){s.rect(i,h,E,C),this.__originalRect(i,h,E,C)},v.closePath=function(){s.closePath(),this.__originalClosePath()},v.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class u{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,i,h){let E;return this.cache[s]!==void 0?(E=this.cache[s],this.canvasFactory.reset(E,i,h)):(E=this.canvasFactory.create(i,h),this.cache[s]=E),E}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const i=this.cache[s];this.canvasFactory.destroy(i),delete this.cache[s]}}}function d(v,s,i,h,E,C,U,H,K,ot){const[at,dt,ft,At,W,k]=(0,r.getCurrentTransform)(v);if(dt===0&&ft===0){const j=U*at+W,lt=Math.round(j),ut=H*At+k,st=Math.round(ut),it=(U+K)*at+W,St=Math.abs(Math.round(it)-lt)||1,kt=(H+ot)*At+k,Mt=Math.abs(Math.round(kt)-st)||1;return v.setTransform(Math.sign(at),0,0,Math.sign(At),lt,st),v.drawImage(s,i,h,E,C,0,0,St,Mt),v.setTransform(at,dt,ft,At,W,k),[St,Mt]}if(at===0&&At===0){const j=H*ft+W,lt=Math.round(j),ut=U*dt+k,st=Math.round(ut),it=(H+ot)*ft+W,St=Math.abs(Math.round(it)-lt)||1,kt=(U+K)*dt+k,Mt=Math.abs(Math.round(kt)-st)||1;return v.setTransform(0,Math.sign(dt),Math.sign(ft),0,lt,st),v.drawImage(s,i,h,E,C,0,0,Mt,St),v.setTransform(at,dt,ft,At,W,k),[Mt,St]}v.drawImage(s,i,h,E,C,U,H,K,ot);const G=Math.hypot(at,dt),O=Math.hypot(ft,At);return[G*K,O*ot]}function n(v){const{width:s,height:i}=v;if(s>p||i>p)return null;const h=1e3,E=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),C=s+1;let U=new Uint8Array(C*(i+1)),H,K,ot;const at=s+7&-8;let dt=new Uint8Array(at*i),ft=0;for(const O of v.data){let j=128;for(;j>0;)dt[ft++]=O&j?0:255,j>>=1}let At=0;for(ft=0,dt[ft]!==0&&(U[0]=1,++At),K=1;K<s;K++)dt[ft]!==dt[ft+1]&&(U[K]=dt[ft]?2:1,++At),ft++;for(dt[ft]!==0&&(U[K]=2,++At),H=1;H<i;H++){ft=H*at,ot=H*C,dt[ft-at]!==dt[ft]&&(U[ot]=dt[ft]?1:8,++At);let O=(dt[ft]?4:0)+(dt[ft-at]?8:0);for(K=1;K<s;K++)O=(O>>2)+(dt[ft+1]?4:0)+(dt[ft-at+1]?8:0),E[O]&&(U[ot+K]=E[O],++At),ft++;if(dt[ft-at]!==dt[ft]&&(U[ot+K]=dt[ft]?2:4,++At),At>h)return null}for(ft=at*(i-1),ot=H*C,dt[ft]!==0&&(U[ot]=8,++At),K=1;K<s;K++)dt[ft]!==dt[ft+1]&&(U[ot+K]=dt[ft]?4:8,++At),ft++;if(dt[ft]!==0&&(U[ot+K]=4,++At),At>h)return null;const W=new Int32Array([0,C,-1,0,-C,0,0,0,1]),k=new Path2D;for(H=0;At&&H<=i;H++){let O=H*C;const j=O+s;for(;O<j&&!U[O];)O++;if(O===j)continue;k.moveTo(O%C,H);const lt=O;let ut=U[O];do{const st=W[ut];do O+=st;while(!U[O]);const it=U[O];it!==5&&it!==10?(ut=it,U[O]=0):(ut=it&51*ut>>4,U[O]&=ut>>2|ut<<2),k.lineTo(O%C,O/C|0),U[O]||--At}while(lt!==O);--H}return dt=null,U=null,function(O){O.save(),O.scale(1/s,-1/i),O.translate(0,-i),O.fill(k),O.beginPath(),O.restore()}}class l{constructor(s,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,i])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,i){this.x=s,this.y=i}updatePathMinMax(s,i,h){[i,h]=e.Util.applyTransform([i,h],s),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,h),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,h)}updateRectMinMax(s,i){const h=e.Util.applyTransform(i,s),E=e.Util.applyTransform(i.slice(2),s);this.minX=Math.min(this.minX,h[0],E[0]),this.minY=Math.min(this.minY,h[1],E[1]),this.maxX=Math.max(this.maxX,h[0],E[0]),this.maxY=Math.max(this.maxY,h[1],E[1])}updateScalingPathMinMax(s,i){e.Util.scaleMinMax(s,i),this.minX=Math.min(this.minX,i[0]),this.maxX=Math.max(this.maxX,i[1]),this.minY=Math.min(this.minY,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(s,i,h,E,C,U,H,K,ot,at){const dt=e.Util.bezierBoundingBox(i,h,E,C,U,H,K,ot);if(at){at[0]=Math.min(at[0],dt[0],dt[2]),at[1]=Math.max(at[1],dt[0],dt[2]),at[2]=Math.min(at[2],dt[1],dt[3]),at[3]=Math.max(at[3],dt[1],dt[3]);return}this.updateRectMinMax(s,dt)}getPathBoundingBox(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:R.PathType.FILL,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const h=[this.minX,this.minY,this.maxX,this.maxY];if(s===R.PathType.STROKE){i||(0,e.unreachable)("Stroke bounding box must include transform.");const E=e.Util.singularValueDecompose2dScale(i),C=E[0]*this.lineWidth/2,U=E[1]*this.lineWidth/2;h[0]-=C,h[1]-=U,h[2]+=C,h[3]+=U}return h}updateClipFromPath(){const s=e.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:R.PathType.FILL,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return e.Util.intersect(this.clipBox,this.getPathBoundingBox(s,i))}}function F(v,s){if(typeof ImageData<"u"&&s instanceof ImageData){v.putImageData(s,0,0);return}const i=s.height,h=s.width,E=i%m,C=(i-E)/m,U=E===0?C:C+1,H=v.createImageData(h,m);let K=0,ot;const at=s.data,dt=H.data;let ft,At,W,k;if(s.kind===e.ImageKind.GRAYSCALE_1BPP){const G=at.byteLength,O=new Uint32Array(dt.buffer,0,dt.byteLength>>2),j=O.length,lt=h+7>>3,ut=4294967295,st=e.FeatureTest.isLittleEndian?4278190080:255;for(ft=0;ft<U;ft++){for(W=ft<C?m:E,ot=0,At=0;At<W;At++){const it=G-K;let St=0;const kt=it>lt?h:it*8-7,Mt=kt&-8;let Lt=0,Rt=0;for(;St<Mt;St+=8)Rt=at[K++],O[ot++]=Rt&128?ut:st,O[ot++]=Rt&64?ut:st,O[ot++]=Rt&32?ut:st,O[ot++]=Rt&16?ut:st,O[ot++]=Rt&8?ut:st,O[ot++]=Rt&4?ut:st,O[ot++]=Rt&2?ut:st,O[ot++]=Rt&1?ut:st;for(;St<kt;St++)Lt===0&&(Rt=at[K++],Lt=128),O[ot++]=Rt&Lt?ut:st,Lt>>=1}for(;ot<j;)O[ot++]=0;v.putImageData(H,0,ft*m)}}else if(s.kind===e.ImageKind.RGBA_32BPP){for(At=0,k=h*m*4,ft=0;ft<C;ft++)dt.set(at.subarray(K,K+k)),K+=k,v.putImageData(H,0,At),At+=m;ft<U&&(k=h*E*4,dt.set(at.subarray(K,K+k)),v.putImageData(H,0,At))}else if(s.kind===e.ImageKind.RGB_24BPP)for(W=m,k=h*W,ft=0;ft<U;ft++){for(ft>=C&&(W=E,k=h*W),ot=0,At=k;At--;)dt[ot++]=at[K++],dt[ot++]=at[K++],dt[ot++]=at[K++],dt[ot++]=255;v.putImageData(H,0,ft*m)}else throw new Error(`bad image kind: ${s.kind}`)}function y(v,s){if(s.bitmap){v.drawImage(s.bitmap,0,0);return}const i=s.height,h=s.width,E=i%m,C=(i-E)/m,U=E===0?C:C+1,H=v.createImageData(h,m);let K=0;const ot=s.data,at=H.data;for(let dt=0;dt<U;dt++){const ft=dt<C?m:E;({srcPos:K}=(0,L.convertBlackAndWhiteToRGBA)({src:ot,srcPos:K,dest:at,width:h,height:ft,nonBlackColor:0})),v.putImageData(H,0,dt*m)}}function a(v,s){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const h of i)v[h]!==void 0&&(s[h]=v[h]);v.setLineDash!==void 0&&(s.setLineDash(v.getLineDash()),s.lineDashOffset=v.lineDashOffset)}function o(v){if(v.strokeStyle=v.fillStyle="#000000",v.fillRule="nonzero",v.globalAlpha=1,v.lineWidth=1,v.lineCap="butt",v.lineJoin="miter",v.miterLimit=10,v.globalCompositeOperation="source-over",v.font="10px sans-serif",v.setLineDash!==void 0&&(v.setLineDash([]),v.lineDashOffset=0),!e.isNodeJS){const{filter:s}=v;s!=="none"&&s!==""&&(v.filter="none")}}function w(v,s,i,h){const E=v.length;for(let C=3;C<E;C+=4){const U=v[C];if(U===0)v[C-3]=s,v[C-2]=i,v[C-1]=h;else if(U<255){const H=255-U;v[C-3]=v[C-3]*U+s*H>>8,v[C-2]=v[C-2]*U+i*H>>8,v[C-1]=v[C-1]*U+h*H>>8}}}function Y(v,s,i){const h=v.length,E=1/255;for(let C=3;C<h;C+=4){const U=i?i[v[C]]:v[C];s[C]=s[C]*U*E|0}}function B(v,s,i){const h=v.length;for(let E=3;E<h;E+=4){const C=v[E-3]*77+v[E-2]*152+v[E-1]*28;s[E]=i?s[E]*i[C>>8]>>8:s[E]*C>>16}}function g(v,s,i,h,E,C,U,H,K,ot,at){const dt=!!C,ft=dt?C[0]:0,At=dt?C[1]:0,W=dt?C[2]:0,k=E==="Luminosity"?B:Y,O=Math.min(h,Math.ceil(1048576/i));for(let j=0;j<h;j+=O){const lt=Math.min(O,h-j),ut=v.getImageData(H-ot,j+(K-at),i,lt),st=s.getImageData(H,j+K,i,lt);dt&&w(ut.data,ft,At,W),k(ut.data,st.data,U),s.putImageData(st,H,j+K)}}function P(v,s,i,h){const E=h[0],C=h[1],U=h[2]-E,H=h[3]-C;U===0||H===0||(g(s.context,i,U,H,s.subtype,s.backdrop,s.transferMap,E,C,s.offsetX,s.offsetY),v.save(),v.globalAlpha=1,v.globalCompositeOperation="source-over",v.setTransform(1,0,0,1,0,0),v.drawImage(i.canvas,0,0),v.restore())}function q(v,s){const i=e.Util.singularValueDecompose2dScale(v);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const h=Math.fround((globalThis.devicePixelRatio||1)*r.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:i[0]<=h||i[1]<=h}const Q=["butt","round","square"],$=["miter","round","bevel"],et={},_t={};var X=new WeakSet;class b{constructor(s,i,h,E,C,U,H,K){let{optionalContentConfig:ot,markedContentStack:at=null}=U;_classPrivateMethodInitSpec(this,X),this.ctx=s,this.current=new l(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=h,this.canvasFactory=E,this.filterFactory=C,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=at||[],this.optionalContentConfig=ot,this.cachedCanvases=new u(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=H,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=K,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):i}beginDrawing(s){let{transform:i,viewport:h,transparency:E=!1,background:C=null}=s;const U=this.ctx.canvas.width,H=this.ctx.canvas.height,K=this.ctx.fillStyle;if(this.ctx.fillStyle=C||"#ffffff",this.ctx.fillRect(0,0,U,H),this.ctx.fillStyle=K,E){const ot=this.cachedCanvases.getCanvas("transparent",U,H);this.compositeCtx=this.ctx,this.transparentCanvas=ot.canvas,this.ctx=ot.context,this.ctx.save(),this.ctx.transform(...(0,r.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),o(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...h.transform),this.viewportScale=h.scale,this.baseTransform=(0,r.getCurrentTransform)(this.ctx)}executeOperatorList(s,i,h,E){const C=s.argsArray,U=s.fnArray;let H=i||0;const K=C.length;if(K===H)return H;const ot=K-H>M&&typeof h=="function",at=ot?Date.now()+A:0;let dt=0;const ft=this.commonObjs,At=this.objs;let W;for(;;){if(E!==void 0&&H===E.nextBreakPoint)return E.breakIt(H,h),H;if(W=U[H],W!==e.OPS.dependency)this[W].apply(this,C[H]);else for(const k of C[H]){const G=k.startsWith("g_")?ft:At;if(!G.has(k))return G.get(k,h),H}if(H++,H===K)return H;if(ot&&++dt>M){if(Date.now()>at)return h(),H;dt=0}}}endDrawing(){_assertClassBrand(X,this,N).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const i of s.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);s.clear()}this._cachedBitmapsMap.clear(),_assertClassBrand(X,this,rt).call(this)}_scaleImage(s,i){const h=s.width,E=s.height;let C=Math.max(Math.hypot(i[0],i[1]),1),U=Math.max(Math.hypot(i[2],i[3]),1),H=h,K=E,ot="prescale1",at,dt;for(;C>2&&H>1||U>2&&K>1;){let ft=H,At=K;C>2&&H>1&&(ft=H>=16384?Math.floor(H/2)-1||1:Math.ceil(H/2),C/=H/ft),U>2&&K>1&&(At=K>=16384?Math.floor(K/2)-1||1:Math.ceil(K)/2,U/=K/At),at=this.cachedCanvases.getCanvas(ot,ft,At),dt=at.context,dt.clearRect(0,0,ft,At),dt.drawImage(s,0,0,H,K,0,0,ft,At),s=at.canvas,H=ft,K=At,ot=ot==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:H,paintHeight:K}}_createMaskCanvas(s){const i=this.ctx,{width:h,height:E}=s,C=this.current.fillColor,U=this.current.patternFill,H=(0,r.getCurrentTransform)(i);let K,ot,at,dt;if((s.bitmap||s.data)&&s.count>1){const St=s.bitmap||s.data.buffer;ot=JSON.stringify(U?H:[H.slice(0,4),C]),K=this._cachedBitmapsMap.get(St),K||(K=new Map,this._cachedBitmapsMap.set(St,K));const kt=K.get(ot);if(kt&&!U){const Mt=Math.round(Math.min(H[0],H[2])+H[4]),Lt=Math.round(Math.min(H[1],H[3])+H[5]);return{canvas:kt,offsetX:Mt,offsetY:Lt}}at=kt}at||(dt=this.cachedCanvases.getCanvas("maskCanvas",h,E),y(dt.context,s));let ft=e.Util.transform(H,[1/h,0,0,-1/E,0,0]);ft=e.Util.transform(ft,[1,0,0,1,0,-E]);const At=e.Util.applyTransform([0,0],ft),W=e.Util.applyTransform([h,E],ft),k=e.Util.normalizeRect([At[0],At[1],W[0],W[1]]),G=Math.round(k[2]-k[0])||1,O=Math.round(k[3]-k[1])||1,j=this.cachedCanvases.getCanvas("fillCanvas",G,O),lt=j.context,ut=Math.min(At[0],W[0]),st=Math.min(At[1],W[1]);lt.translate(-ut,-st),lt.transform(...ft),at||(at=this._scaleImage(dt.canvas,(0,r.getCurrentTransformInverse)(lt)),at=at.img,K&&U&&K.set(ot,at)),lt.imageSmoothingEnabled=q((0,r.getCurrentTransform)(lt),s.interpolate),d(lt,at,0,0,at.width,at.height,0,0,h,E),lt.globalCompositeOperation="source-in";const it=e.Util.transform((0,r.getCurrentTransformInverse)(lt),[1,0,0,1,-ut,-st]);return lt.fillStyle=U?C.getPattern(i,this,it,R.PathType.FILL):C,lt.fillRect(0,0,h,E),K&&!U&&(this.cachedCanvases.delete("fillCanvas"),K.set(ot,j.canvas)),{canvas:j.canvas,offsetX:Math.round(ut),offsetY:Math.round(st)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=Q[s]}setLineJoin(s){this.ctx.lineJoin=$[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,i){const h=this.ctx;h.setLineDash!==void 0&&(h.setLineDash(s),h.lineDashOffset=i)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[i,h]of s)switch(i){case"LW":this.setLineWidth(h);break;case"LC":this.setLineCap(h);break;case"LJ":this.setLineJoin(h);break;case"ML":this.setMiterLimit(h);break;case"D":this.setDash(h[0],h[1]);break;case"RI":this.setRenderingIntent(h);break;case"FL":this.setFlatness(h);break;case"Font":this.setFont(h[0],h[1]);break;case"CA":this.current.strokeAlpha=h;break;case"ca":this.current.fillAlpha=h,this.ctx.globalAlpha=h;break;case"BM":this.ctx.globalCompositeOperation=h;break;case"SMask":this.current.activeSMask=h?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(h);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,i=this.ctx.canvas.height,h="smaskGroupAt"+this.groupLevel,E=this.cachedCanvases.getCanvas(h,s,i);this.suspendedCtx=this.ctx,this.ctx=E.context;const C=this.ctx;C.setTransform(...(0,r.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,C),S(C,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,h=this.suspendedCtx;P(h,i,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,i,h,E,C,U){this.ctx.transform(s,i,h,E,C,U),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,i,h){const E=this.ctx,C=this.current;let U=C.x,H=C.y,K,ot;const at=(0,r.getCurrentTransform)(E),dt=at[0]===0&&at[3]===0||at[1]===0&&at[2]===0,ft=dt?h.slice(0):null;for(let At=0,W=0,k=s.length;At<k;At++)switch(s[At]|0){case e.OPS.rectangle:U=i[W++],H=i[W++];const G=i[W++],O=i[W++],j=U+G,lt=H+O;E.moveTo(U,H),G===0||O===0?E.lineTo(j,lt):(E.lineTo(j,H),E.lineTo(j,lt),E.lineTo(U,lt)),dt||C.updateRectMinMax(at,[U,H,j,lt]),E.closePath();break;case e.OPS.moveTo:U=i[W++],H=i[W++],E.moveTo(U,H),dt||C.updatePathMinMax(at,U,H);break;case e.OPS.lineTo:U=i[W++],H=i[W++],E.lineTo(U,H),dt||C.updatePathMinMax(at,U,H);break;case e.OPS.curveTo:K=U,ot=H,U=i[W+4],H=i[W+5],E.bezierCurveTo(i[W],i[W+1],i[W+2],i[W+3],U,H),C.updateCurvePathMinMax(at,K,ot,i[W],i[W+1],i[W+2],i[W+3],U,H,ft),W+=6;break;case e.OPS.curveTo2:K=U,ot=H,E.bezierCurveTo(U,H,i[W],i[W+1],i[W+2],i[W+3]),C.updateCurvePathMinMax(at,K,ot,U,H,i[W],i[W+1],i[W+2],i[W+3],ft),U=i[W+2],H=i[W+3],W+=4;break;case e.OPS.curveTo3:K=U,ot=H,U=i[W+2],H=i[W+3],E.bezierCurveTo(i[W],i[W+1],U,H,U,H),C.updateCurvePathMinMax(at,K,ot,i[W],i[W+1],U,H,U,H,ft),W+=4;break;case e.OPS.closePath:E.closePath();break}dt&&C.updateScalingPathMinMax(at,ft),C.setCurrentPoint(U,H)}closePath(){this.ctx.closePath()}stroke(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const i=this.ctx,h=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof h=="object"&&h!==null&&h!==void 0&&h.getPattern?(i.save(),i.strokeStyle=h.getPattern(i,this,(0,r.getCurrentTransformInverse)(i),R.PathType.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const i=this.ctx,h=this.current.fillColor,E=this.current.patternFill;let C=!1;E&&(i.save(),i.fillStyle=h.getPattern(i,this,(0,r.getCurrentTransformInverse)(i),R.PathType.FILL),C=!0);const U=this.current.getClippedPathBoundingBox();this.contentVisible&&U!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),C&&i.restore(),s&&this.consumePath(U)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=et}eoClip(){this.pendingClip=_t}beginText(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,i=this.ctx;if(s===void 0){i.beginPath();return}i.save(),i.beginPath();for(const h of s)i.setTransform(...h.transform),i.translate(h.x,h.y),h.addToPath(i,h.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,i){var h;const E=this.commonObjs.get(s),C=this.current;if(!E)throw new Error(`Can't find font for ${s}`);if(C.fontMatrix=E.fontMatrix||e.FONT_IDENTITY_MATRIX,(C.fontMatrix[0]===0||C.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+s),i<0?(i=-i,C.fontDirection=-1):C.fontDirection=1,this.current.font=E,this.current.fontSize=i,E.isType3Font)return;const U=E.loadedName||"sans-serif",H=((h=E.systemFontInfo)===null||h===void 0?void 0:h.css)||`"${U}", ${E.fallbackName}`;let K="normal";E.black?K="900":E.bold&&(K="bold");const ot=E.italic?"italic":"normal";let at=i;i<V?at=V:i>D&&(at=D),this.current.fontSizeScale=i/at,this.ctx.font=`${ot} ${K} ${at}px ${H}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,i){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=i}setLeadingMoveText(s,i){this.setLeading(-i),this.moveText(s,i)}setTextMatrix(s,i,h,E,C,U){this.current.textMatrix=[s,i,h,E,C,U],this.current.textMatrixScale=Math.hypot(s,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,i,h,E){const C=this.ctx,U=this.current,H=U.font,K=U.textRenderingMode,ot=U.fontSize/U.fontSizeScale,at=K&e.TextRenderingMode.FILL_STROKE_MASK,dt=!!(K&e.TextRenderingMode.ADD_TO_PATH_FLAG),ft=U.patternFill&&!H.missingFile;let At;(H.disableFontFace||dt||ft)&&(At=H.getPathGenerator(this.commonObjs,s)),H.disableFontFace||ft?(C.save(),C.translate(i,h),C.beginPath(),At(C,ot),E&&C.setTransform(...E),(at===e.TextRenderingMode.FILL||at===e.TextRenderingMode.FILL_STROKE)&&C.fill(),(at===e.TextRenderingMode.STROKE||at===e.TextRenderingMode.FILL_STROKE)&&C.stroke(),C.restore()):((at===e.TextRenderingMode.FILL||at===e.TextRenderingMode.FILL_STROKE)&&C.fillText(s,i,h),(at===e.TextRenderingMode.STROKE||at===e.TextRenderingMode.FILL_STROKE)&&C.strokeText(s,i,h)),dt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,r.getCurrentTransform)(C),x:i,y:h,fontSize:ot,addToPath:At})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const i=s.getImageData(0,0,10,10).data;let h=!1;for(let E=3;E<i.length;E+=4)if(i[E]>0&&i[E]<255){h=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",h)}showText(s){const i=this.current,h=i.font;if(h.isType3Font)return this.showType3Text(s);const E=i.fontSize;if(E===0)return;const C=this.ctx,U=i.fontSizeScale,H=i.charSpacing,K=i.wordSpacing,ot=i.fontDirection,at=i.textHScale*ot,dt=s.length,ft=h.vertical,At=ft?1:-1,W=h.defaultVMetrics,k=E*i.fontMatrix[0],G=i.textRenderingMode===e.TextRenderingMode.FILL&&!h.disableFontFace&&!i.patternFill;C.save(),C.transform(...i.textMatrix),C.translate(i.x,i.y+i.textRise),ot>0?C.scale(at,-1):C.scale(at,1);let O;if(i.patternFill){C.save();const it=i.fillColor.getPattern(C,this,(0,r.getCurrentTransformInverse)(C),R.PathType.FILL);O=(0,r.getCurrentTransform)(C),C.restore(),C.fillStyle=it}let j=i.lineWidth;const lt=i.textMatrixScale;if(lt===0||j===0){const it=i.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(it===e.TextRenderingMode.STROKE||it===e.TextRenderingMode.FILL_STROKE)&&(j=this.getSinglePixelWidth())}else j/=lt;if(U!==1&&(C.scale(U,U),j/=U),C.lineWidth=j,h.isInvalidPDFjsFont){const it=[];let St=0;for(const kt of s)it.push(kt.unicode),St+=kt.width;C.fillText(it.join(""),0,0),i.x+=St*k*at,C.restore(),this.compose();return}let ut=0,st;for(st=0;st<dt;++st){const it=s[st];if(typeof it=="number"){ut+=At*it*E/1e3;continue}let St=!1;const kt=(it.isSpace?K:0)+H,Mt=it.fontChar,Lt=it.accent;let Rt,Ft,yt=it.width;if(ft){const Ut=it.vmetric||W,jt=-(it.vmetric?Ut[1]:yt*.5)*k,$t=Ut[2]*k;yt=Ut?-Ut[0]:yt,Rt=jt/U,Ft=(ut+$t)/U}else Rt=ut/U,Ft=0;if(h.remeasure&&yt>0){const Ut=C.measureText(Mt).width*1e3/E*U;if(yt<Ut&&this.isFontSubpixelAAEnabled){const jt=yt/Ut;St=!0,C.save(),C.scale(jt,1),Rt/=jt}else yt!==Ut&&(Rt+=(yt-Ut)/2e3*E/U)}if(this.contentVisible&&(it.isInFont||h.missingFile)){if(G&&!Lt)C.fillText(Mt,Rt,Ft);else if(this.paintChar(Mt,Rt,Ft,O),Lt){const Ut=Rt+E*Lt.offset.x/U,jt=Ft-E*Lt.offset.y/U;this.paintChar(Lt.fontChar,Ut,jt,O)}}const Wt=ft?yt*k-kt*ot:yt*k+kt*ot;ut+=Wt,St&&C.restore()}ft?i.y-=ut:i.x+=ut*at,C.restore(),this.compose()}showType3Text(s){const i=this.ctx,h=this.current,E=h.font,C=h.fontSize,U=h.fontDirection,H=E.vertical?1:-1,K=h.charSpacing,ot=h.wordSpacing,at=h.textHScale*U,dt=h.fontMatrix||e.FONT_IDENTITY_MATRIX,ft=s.length,At=h.textRenderingMode===e.TextRenderingMode.INVISIBLE;let W,k,G,O;if(!(At||C===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...h.textMatrix),i.translate(h.x,h.y),i.scale(at,U),W=0;W<ft;++W){if(k=s[W],typeof k=="number"){O=H*k*C/1e3,this.ctx.translate(O,0),h.x+=O*at;continue}const j=(k.isSpace?ot:0)+K,lt=E.charProcOperatorList[k.operatorListId];if(!lt){(0,e.warn)(`Type3 character "${k.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=k,this.save(),i.scale(C,C),i.transform(...dt),this.executeOperatorList(lt),this.restore()),G=e.Util.applyTransform([k.width,0],dt)[0]*C+j,i.translate(G,0),h.x+=G*at}i.restore(),this.processingType3=null}}setCharWidth(s,i){}setCharWidthAndBounds(s,i,h,E,C,U){this.ctx.rect(h,E,C-h,U-E),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let i;if(s[0]==="TilingPattern"){const h=s[1],E=this.baseTransform||(0,r.getCurrentTransform)(this.ctx),C={createCanvasGraphics:U=>new b(U,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new R.TilingPattern(s,h,this.ctx,C,E)}else i=this._getPattern(s[1],s[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,i,h){const E=e.Util.makeHexColor(s,i,h);this.ctx.strokeStyle=E,this.current.strokeColor=E}setFillRGBColor(s,i,h){const E=e.Util.makeHexColor(s,i,h);this.ctx.fillStyle=E,this.current.fillColor=E,this.current.patternFill=!1}_getPattern(s){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,h;return this.cachedPatterns.has(s)?h=this.cachedPatterns.get(s):(h=(0,R.getShadingPattern)(this.getObject(s)),this.cachedPatterns.set(s,h)),i&&(h.matrix=i),h}shadingFill(s){if(!this.contentVisible)return;const i=this.ctx;this.save();const h=this._getPattern(s);i.fillStyle=h.getPattern(i,this,(0,r.getCurrentTransformInverse)(i),R.PathType.SHADING);const E=(0,r.getCurrentTransformInverse)(i);if(E){const{width:C,height:U}=i.canvas,[H,K,ot,at]=e.Util.getAxialAlignedBoundingBox([0,0,C,U],E);this.ctx.fillRect(H,K,ot-H,at-K)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,e.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,e.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,r.getCurrentTransform)(this.ctx),i)){const h=i[2]-i[0],E=i[3]-i[1];this.ctx.rect(i[0],i[1],h,E),this.current.updateRectMinMax((0,r.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;s.isolated||(0,e.info)("TODO: Support non-isolated groups."),s.knockout&&(0,e.warn)("Knockout groups not supported.");const h=(0,r.getCurrentTransform)(i);if(s.matrix&&i.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let E=e.Util.getAxialAlignedBoundingBox(s.bbox,(0,r.getCurrentTransform)(i));const C=[0,0,i.canvas.width,i.canvas.height];E=e.Util.intersect(E,C)||[0,0,0,0];const U=Math.floor(E[0]),H=Math.floor(E[1]);let K=Math.max(Math.ceil(E[2])-U,1),ot=Math.max(Math.ceil(E[3])-H,1),at=1,dt=1;K>f&&(at=K/f,K=f),ot>f&&(dt=ot/f,ot=f),this.current.startNewPathAndClipBox([0,0,K,ot]);let ft="groupAt"+this.groupLevel;s.smask&&(ft+="_smask_"+this.smaskCounter++%2);const At=this.cachedCanvases.getCanvas(ft,K,ot),W=At.context;W.scale(1/at,1/dt),W.translate(-U,-H),W.transform(...h),s.smask?this.smaskStack.push({canvas:At.canvas,context:W,offsetX:U,offsetY:H,scaleX:at,scaleY:dt,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(U,H),i.scale(at,dt),i.save()),a(i,W),this.ctx=W,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,h=this.groupStack.pop();if(this.ctx=h,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const E=(0,r.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...E);const C=e.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],E);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(C)}}beginAnnotation(s,i,h,E,C){if(_assertClassBrand(X,this,N).call(this),o(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const U=i[2]-i[0],H=i[3]-i[1];if(C&&this.annotationCanvasMap){h=h.slice(),h[4]-=i[0],h[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=U,i[3]=H;const[K,ot]=e.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(this.ctx)),{viewportScale:at}=this,dt=Math.ceil(U*this.outputScaleX*at),ft=Math.ceil(H*this.outputScaleY*at);this.annotationCanvas=this.canvasFactory.create(dt,ft);const{canvas:At,context:W}=this.annotationCanvas;this.annotationCanvasMap.set(s,At),this.annotationCanvas.savedCtx=this.ctx,this.ctx=W,this.ctx.save(),this.ctx.setTransform(K,0,0,-ot,0,H*ot),o(this.ctx)}else o(this.ctx),this.ctx.rect(i[0],i[1],U,H),this.ctx.clip(),this.endPath()}this.current=new l(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...h),this.transform(...E)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),_assertClassBrand(X,this,rt).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const i=s.count;s=this.getObject(s.data,s),s.count=i;const h=this.ctx,E=this.processingType3;if(E&&(E.compiled===void 0&&(E.compiled=n(s)),E.compiled)){E.compiled(h);return}const C=this._createMaskCanvas(s),U=C.canvas;h.save(),h.setTransform(1,0,0,1,0,0),h.drawImage(U,C.offsetX,C.offsetY),h.restore(),this.compose()}paintImageMaskXObjectRepeat(s,i){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,C=arguments.length>4?arguments[4]:void 0,U=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;s=this.getObject(s.data,s);const H=this.ctx;H.save();const K=(0,r.getCurrentTransform)(H);H.transform(i,h,E,C,0,0);const ot=this._createMaskCanvas(s);H.setTransform(1,0,0,1,ot.offsetX-K[4],ot.offsetY-K[5]);for(let at=0,dt=U.length;at<dt;at+=2){const ft=e.Util.transform(K,[i,h,E,C,U[at],U[at+1]]),[At,W]=e.Util.applyTransform([0,0],ft);H.drawImage(ot.canvas,At,W)}H.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const i=this.ctx,h=this.current.fillColor,E=this.current.patternFill;for(const C of s){const{data:U,width:H,height:K,transform:ot}=C,at=this.cachedCanvases.getCanvas("maskCanvas",H,K),dt=at.context;dt.save();const ft=this.getObject(U,C);y(dt,ft),dt.globalCompositeOperation="source-in",dt.fillStyle=E?h.getPattern(dt,this,(0,r.getCurrentTransformInverse)(i),R.PathType.FILL):h,dt.fillRect(0,0,H,K),dt.restore(),i.save(),i.transform(...ot),i.scale(1,-1),d(i,at.canvas,0,0,H,K,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const i=this.getObject(s);if(!i){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(s,i,h,E){if(!this.contentVisible)return;const C=this.getObject(s);if(!C){(0,e.warn)("Dependent image isn't ready yet");return}const U=C.width,H=C.height,K=[];for(let ot=0,at=E.length;ot<at;ot+=2)K.push({transform:[i,0,0,h,E[ot],E[ot+1]],x:0,y:0,w:U,h:H});this.paintInlineImageXObjectGroup(C,K)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:i,width:h,height:E}=s,C=this.cachedCanvases.getCanvas("inlineImage",h,E),U=C.context;return U.filter=this.current.transferMaps,U.drawImage(i,0,0),U.filter="none",C.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const i=s.width,h=s.height,E=this.ctx;if(this.save(),!e.isNodeJS){const{filter:H}=E;H!=="none"&&H!==""&&(E.filter="none")}E.scale(1/i,-1/h);let C;if(s.bitmap)C=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)C=s;else{const K=this.cachedCanvases.getCanvas("inlineImage",i,h).context;F(K,s),C=this.applyTransferMapsToCanvas(K)}const U=this._scaleImage(C,(0,r.getCurrentTransformInverse)(E));E.imageSmoothingEnabled=q((0,r.getCurrentTransform)(E),s.interpolate),d(E,U.img,0,0,U.paintWidth,U.paintHeight,0,-h,i,h),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,i){if(!this.contentVisible)return;const h=this.ctx;let E;if(s.bitmap)E=s.bitmap;else{const C=s.width,U=s.height,K=this.cachedCanvases.getCanvas("inlineImage",C,U).context;F(K,s),E=this.applyTransferMapsToCanvas(K)}for(const C of i)h.save(),h.transform(...C.transform),h.scale(1,-1),d(h,E,C.x,C.y,C.w,C.h,0,-1,1,1),h.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,i){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,i){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const h=this.ctx;this.pendingClip&&(i||(this.pendingClip===_t?h.clip("evenodd"):h.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),h.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,r.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const i=Math.abs(s[0]*s[3]-s[2]*s[1]),h=Math.hypot(s[0],s[2]),E=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(h,E)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:i,b:h,c:E,d:C}=this.ctx.getTransform();let U,H;if(h===0&&E===0){const K=Math.abs(i),ot=Math.abs(C);if(K===ot)if(s===0)U=H=1/K;else{const at=K*s;U=H=at<1?1/at:1}else if(s===0)U=1/K,H=1/ot;else{const at=K*s,dt=ot*s;U=at<1?1/at:1,H=dt<1?1/dt:1}}else{const K=Math.abs(i*C-h*E),ot=Math.hypot(i,h),at=Math.hypot(E,C);if(s===0)U=at/K,H=ot/K;else{const dt=s*K;U=at>dt?at/dt:1,H=ot>dt?ot/dt:1}}this._cachedScaleForStroking[0]=U,this._cachedScaleForStroking[1]=H}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:i}=this,{lineWidth:h}=this.current,[E,C]=this.getScaleForStroking();if(i.lineWidth=h||1,E===1&&C===1){i.stroke();return}const U=i.getLineDash();if(s&&i.save(),i.scale(E,C),U.length>0){const H=Math.max(E,C);i.setLineDash(U.map(K=>K/H)),i.lineDashOffset/=H}i.stroke(),s&&i.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}}function N(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function rt(){if(this.pageColors){const v=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(v!=="none"){const s=this.ctx.filter;this.ctx.filter=v,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=s}}}t.CanvasGraphics=b;for(const v in e.OPS)b.prototype[v]!==void 0&&(b.prototype[e.OPS[v]]=b.prototype[v])},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=m;var e=_(1),r=_(6);const R={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=R;function L(d,n){if(!n)return;const l=n[2]-n[0],F=n[3]-n[1],y=new Path2D;y.rect(n[0],n[1],l,F),d.clip(y)}class V{constructor(){this.constructor===V&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class D extends V{constructor(n){super(),this._type=n[1],this._bbox=n[2],this._colorStops=n[3],this._p0=n[4],this._p1=n[5],this._r0=n[6],this._r1=n[7],this.matrix=null}_createGradient(n){let l;this._type==="axial"?l=n.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(l=n.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const F of this._colorStops)l.addColorStop(F[0],F[1]);return l}getPattern(n,l,F,y){let a;if(y===R.STROKE||y===R.FILL){const o=l.current.getClippedPathBoundingBox(y,(0,r.getCurrentTransform)(n))||[0,0,0,0],w=Math.ceil(o[2]-o[0])||1,Y=Math.ceil(o[3]-o[1])||1,B=l.cachedCanvases.getCanvas("pattern",w,Y,!0),g=B.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-o[0],-o[1]),F=e.Util.transform(F,[1,0,0,1,o[0],o[1]]),g.transform(...l.baseTransform),this.matrix&&g.transform(...this.matrix),L(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),a=n.createPattern(B.canvas,"no-repeat");const P=new DOMMatrix(F);a.setTransform(P)}else L(n,this._bbox),a=this._createGradient(n);return a}}function f(d,n,l,F,y,a,o,w){const Y=n.coords,B=n.colors,g=d.data,P=d.width*4;let q;Y[l+1]>Y[F+1]&&(q=l,l=F,F=q,q=a,a=o,o=q),Y[F+1]>Y[y+1]&&(q=F,F=y,y=q,q=o,o=w,w=q),Y[l+1]>Y[F+1]&&(q=l,l=F,F=q,q=a,a=o,o=q);const Q=(Y[l]+n.offsetX)*n.scaleX,$=(Y[l+1]+n.offsetY)*n.scaleY,et=(Y[F]+n.offsetX)*n.scaleX,_t=(Y[F+1]+n.offsetY)*n.scaleY,X=(Y[y]+n.offsetX)*n.scaleX,b=(Y[y+1]+n.offsetY)*n.scaleY;if($>=b)return;const N=B[a],rt=B[a+1],v=B[a+2],s=B[o],i=B[o+1],h=B[o+2],E=B[w],C=B[w+1],U=B[w+2],H=Math.round($),K=Math.round(b);let ot,at,dt,ft,At,W,k,G;for(let O=H;O<=K;O++){if(O<_t){const it=O<$?0:($-O)/($-_t);ot=Q-(Q-et)*it,at=N-(N-s)*it,dt=rt-(rt-i)*it,ft=v-(v-h)*it}else{let it;O>b?it=1:_t===b?it=0:it=(_t-O)/(_t-b),ot=et-(et-X)*it,at=s-(s-E)*it,dt=i-(i-C)*it,ft=h-(h-U)*it}let j;O<$?j=0:O>b?j=1:j=($-O)/($-b),At=Q-(Q-X)*j,W=N-(N-E)*j,k=rt-(rt-C)*j,G=v-(v-U)*j;const lt=Math.round(Math.min(ot,At)),ut=Math.round(Math.max(ot,At));let st=P*O+lt*4;for(let it=lt;it<=ut;it++)j=(ot-it)/(ot-At),j<0?j=0:j>1&&(j=1),g[st++]=at-(at-W)*j|0,g[st++]=dt-(dt-k)*j|0,g[st++]=ft-(ft-G)*j|0,g[st++]=255}}function A(d,n,l){const F=n.coords,y=n.colors;let a,o;switch(n.type){case"lattice":const w=n.verticesPerRow,Y=Math.floor(F.length/w)-1,B=w-1;for(a=0;a<Y;a++){let g=a*w;for(let P=0;P<B;P++,g++)f(d,l,F[g],F[g+1],F[g+w],y[g],y[g+1],y[g+w]),f(d,l,F[g+w+1],F[g+1],F[g+w],y[g+w+1],y[g+1],y[g+w])}break;case"triangles":for(a=0,o=F.length;a<o;a+=3)f(d,l,F[a],F[a+1],F[a+2],y[a],y[a+1],y[a+2]);break;default:throw new Error("illegal figure")}}class M extends V{constructor(n){super(),this._coords=n[2],this._colors=n[3],this._figures=n[4],this._bounds=n[5],this._bbox=n[7],this._background=n[8],this.matrix=null}_createMeshCanvas(n,l,F){const w=Math.floor(this._bounds[0]),Y=Math.floor(this._bounds[1]),B=Math.ceil(this._bounds[2])-w,g=Math.ceil(this._bounds[3])-Y,P=Math.min(Math.ceil(Math.abs(B*n[0]*1.1)),3e3),q=Math.min(Math.ceil(Math.abs(g*n[1]*1.1)),3e3),Q=B/P,$=g/q,et={coords:this._coords,colors:this._colors,offsetX:-w,offsetY:-Y,scaleX:1/Q,scaleY:1/$},_t=P+2*2,X=q+2*2,b=F.getCanvas("mesh",_t,X,!1),N=b.context,rt=N.createImageData(P,q);if(l){const s=rt.data;for(let i=0,h=s.length;i<h;i+=4)s[i]=l[0],s[i+1]=l[1],s[i+2]=l[2],s[i+3]=255}for(const s of this._figures)A(rt,s,et);return N.putImageData(rt,2,2),{canvas:b.canvas,offsetX:w-2*Q,offsetY:Y-2*$,scaleX:Q,scaleY:$}}getPattern(n,l,F,y){L(n,this._bbox);let a;if(y===R.SHADING)a=e.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(n));else if(a=e.Util.singularValueDecompose2dScale(l.baseTransform),this.matrix){const w=e.Util.singularValueDecompose2dScale(this.matrix);a=[a[0]*w[0],a[1]*w[1]]}const o=this._createMeshCanvas(a,y===R.SHADING?null:this._background,l.cachedCanvases);return y!==R.SHADING&&(n.setTransform(...l.baseTransform),this.matrix&&n.transform(...this.matrix)),n.translate(o.offsetX,o.offsetY),n.scale(o.scaleX,o.scaleY),n.createPattern(o.canvas,"no-repeat")}}class p extends V{getPattern(){return"hotpink"}}function m(d){switch(d[0]){case"RadialAxial":return new D(d);case"Mesh":return new M(d);case"Dummy":return new p}throw new Error(`Unknown IR type: ${d[0]}`)}const S={COLORED:1,UNCOLORED:2};class u{constructor(n,l,F,y,a){this.operatorList=n[2],this.matrix=n[3]||[1,0,0,1,0,0],this.bbox=n[4],this.xstep=n[5],this.ystep=n[6],this.paintType=n[7],this.tilingType=n[8],this.color=l,this.ctx=F,this.canvasGraphicsFactory=y,this.baseTransform=a}createPatternCanvas(n){const l=this.operatorList,F=this.bbox,y=this.xstep,a=this.ystep,o=this.paintType,w=this.tilingType,Y=this.color,B=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+w);const g=F[0],P=F[1],q=F[2],Q=F[3],$=e.Util.singularValueDecompose2dScale(this.matrix),et=e.Util.singularValueDecompose2dScale(this.baseTransform),_t=[$[0]*et[0],$[1]*et[1]],X=this.getSizeAndScale(y,this.ctx.canvas.width,_t[0]),b=this.getSizeAndScale(a,this.ctx.canvas.height,_t[1]),N=n.cachedCanvases.getCanvas("pattern",X.size,b.size,!0),rt=N.context,v=B.createCanvasGraphics(rt);v.groupLevel=n.groupLevel,this.setFillAndStrokeStyleToContext(v,o,Y);let s=g,i=P,h=q,E=Q;return g<0&&(s=0,h+=Math.abs(g)),P<0&&(i=0,E+=Math.abs(P)),rt.translate(-(X.scale*s),-(b.scale*i)),v.transform(X.scale,0,0,b.scale,0,0),rt.save(),this.clipBbox(v,s,i,h,E),v.baseTransform=(0,r.getCurrentTransform)(v.ctx),v.executeOperatorList(l),v.endDrawing(),{canvas:N.canvas,scaleX:X.scale,scaleY:b.scale,offsetX:s,offsetY:i}}getSizeAndScale(n,l,F){n=Math.abs(n);const y=Math.max(u.MAX_PATTERN_SIZE,l);let a=Math.ceil(n*F);return a>=y?a=y:F=a/n,{scale:F,size:a}}clipBbox(n,l,F,y,a){const o=y-l,w=a-F;n.ctx.rect(l,F,o,w),n.current.updateRectMinMax((0,r.getCurrentTransform)(n.ctx),[l,F,y,a]),n.clip(),n.endPath()}setFillAndStrokeStyleToContext(n,l,F){const y=n.ctx,a=n.current;switch(l){case S.COLORED:const o=this.ctx;y.fillStyle=o.fillStyle,y.strokeStyle=o.strokeStyle,a.fillColor=o.fillStyle,a.strokeColor=o.strokeStyle;break;case S.UNCOLORED:const w=e.Util.makeHexColor(F[0],F[1],F[2]);y.fillStyle=w,y.strokeStyle=w,a.fillColor=w,a.strokeColor=w;break;default:throw new e.FormatError(`Unsupported paint type: ${l}`)}}getPattern(n,l,F,y){let a=F;y!==R.SHADING&&(a=e.Util.transform(a,l.baseTransform),this.matrix&&(a=e.Util.transform(a,this.matrix)));const o=this.createPatternCanvas(l);let w=new DOMMatrix(a);w=w.translate(o.offsetX,o.offsetY),w=w.scale(1/o.scaleX,1/o.scaleY);const Y=n.createPattern(o.canvas,"repeat");return Y.setTransform(w),Y}}_defineProperty(u,"MAX_PATTERN_SIZE",3e3),t.TilingPattern=u},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=R,t.convertToRGBA=r,t.grayToRGBA=V;var e=_(1);function r(D){switch(D.kind){case e.ImageKind.GRAYSCALE_1BPP:return R(D);case e.ImageKind.RGB_24BPP:return L(D)}return null}function R(D){let{src:f,srcPos:A=0,dest:M,width:p,height:m,nonBlackColor:S=4294967295,inverseDecode:u=!1}=D;const d=e.FeatureTest.isLittleEndian?4278190080:255,[n,l]=u?[S,d]:[d,S],F=p>>3,y=p&7,a=f.length;M=new Uint32Array(M.buffer);let o=0;for(let w=0;w<m;w++){for(const B=A+F;A<B;A++){const g=A<a?f[A]:255;M[o++]=g&128?l:n,M[o++]=g&64?l:n,M[o++]=g&32?l:n,M[o++]=g&16?l:n,M[o++]=g&8?l:n,M[o++]=g&4?l:n,M[o++]=g&2?l:n,M[o++]=g&1?l:n}if(y===0)continue;const Y=A<a?f[A++]:255;for(let B=0;B<y;B++)M[o++]=Y&1<<7-B?l:n}return{srcPos:A,destPos:o}}function L(D){let{src:f,srcPos:A=0,dest:M,destPos:p=0,width:m,height:S}=D,u=0;const d=f.length>>2,n=new Uint32Array(f.buffer,A,d);if(e.FeatureTest.isLittleEndian){for(;u<d-2;u+=3,p+=4){const l=n[u],F=n[u+1],y=n[u+2];M[p]=l|4278190080,M[p+1]=l>>>24|F<<8|4278190080,M[p+2]=F>>>16|y<<16|4278190080,M[p+3]=y>>>8|4278190080}for(let l=u*4,F=f.length;l<F;l+=3)M[p++]=f[l]|f[l+1]<<8|f[l+2]<<16|4278190080}else{for(;u<d-2;u+=3,p+=4){const l=n[u],F=n[u+1],y=n[u+2];M[p]=l|255,M[p+1]=l<<24|F>>>8|255,M[p+2]=F<<16|y>>>16|255,M[p+3]=y<<8|255}for(let l=u*4,F=f.length;l<F;l+=3)M[p++]=f[l]<<24|f[l+1]<<16|f[l+2]<<8|255}return{srcPos:A,destPos:p}}function V(D,f){if(e.FeatureTest.isLittleEndian)for(let A=0,M=D.length;A<M;A++)f[A]=D[A]*65793|4278190080;else for(let A=0,M=D.length;A<M;A++)f[A]=D[A]*16843008|255}},(T,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const _=Object.create(null);t.GlobalWorkerOptions=_,_.workerPort=null,_.workerSrc=""},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var e=_(1);const r={DATA:1,ERROR:2},R={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function L(p){switch(p instanceof Error||typeof p=="object"&&p!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new e.AbortException(p.message);case"MissingPDFException":return new e.MissingPDFException(p.message);case"PasswordException":return new e.PasswordException(p.message,p.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(p.message,p.status);case"UnknownErrorException":return new e.UnknownErrorException(p.message,p.details);default:return new e.UnknownErrorException(p.message,p.toString())}}var V=new WeakSet;class D{constructor(m,S,u){_classPrivateMethodInitSpec(this,V),this.sourceName=m,this.targetName=S,this.comObj=u,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=d=>{const n=d.data;if(n.targetName!==this.sourceName)return;if(n.stream){_assertClassBrand(V,this,A).call(this,n);return}if(n.callback){const F=n.callbackId,y=this.callbackCapabilities[F];if(!y)throw new Error(`Cannot resolve callback ${F}`);if(delete this.callbackCapabilities[F],n.callback===r.DATA)y.resolve(n.data);else if(n.callback===r.ERROR)y.reject(L(n.reason));else throw new Error("Unexpected callback case");return}const l=this.actionHandler[n.action];if(!l)throw new Error(`Unknown action from worker: ${n.action}`);if(n.callbackId){const F=this.sourceName,y=n.sourceName;new Promise(function(a){a(l(n.data))}).then(function(a){u.postMessage({sourceName:F,targetName:y,callback:r.DATA,callbackId:n.callbackId,data:a})},function(a){u.postMessage({sourceName:F,targetName:y,callback:r.ERROR,callbackId:n.callbackId,reason:L(a)})});return}if(n.streamId){_assertClassBrand(V,this,f).call(this,n);return}l(n.data)},u.addEventListener("message",this._onComObjOnMessage)}on(m,S){const u=this.actionHandler;if(u[m])throw new Error(`There is already an actionName called "${m}"`);u[m]=S}send(m,S,u){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,data:S},u)}sendWithPromise(m,S,u){const d=this.callbackId++,n=new e.PromiseCapability;this.callbackCapabilities[d]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,callbackId:d,data:S},u)}catch(l){n.reject(l)}return n.promise}sendWithStream(m,S,u,d){const n=this.streamId++,l=this.sourceName,F=this.targetName,y=this.comObj;return new ReadableStream({start:a=>{const o=new e.PromiseCapability;return this.streamControllers[n]={controller:a,startCall:o,pullCall:null,cancelCall:null,isClosed:!1},y.postMessage({sourceName:l,targetName:F,action:m,streamId:n,data:S,desiredSize:a.desiredSize},d),o.promise},pull:a=>{const o=new e.PromiseCapability;return this.streamControllers[n].pullCall=o,y.postMessage({sourceName:l,targetName:F,stream:R.PULL,streamId:n,desiredSize:a.desiredSize}),o.promise},cancel:a=>{(0,e.assert)(a instanceof Error,"cancel must have a valid reason");const o=new e.PromiseCapability;return this.streamControllers[n].cancelCall=o,this.streamControllers[n].isClosed=!0,y.postMessage({sourceName:l,targetName:F,stream:R.CANCEL,streamId:n,reason:L(a)}),o.promise}},u)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}function f(p){const m=p.streamId,S=this.sourceName,u=p.sourceName,d=this.comObj,n=this,l=this.actionHandler[p.action],F={enqueue(y){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=a,w>0&&this.desiredSize<=0&&(this.sinkCapability=new e.PromiseCapability,this.ready=this.sinkCapability.promise),d.postMessage({sourceName:S,targetName:u,stream:R.ENQUEUE,streamId:m,chunk:y},o)},close(){this.isCancelled||(this.isCancelled=!0,d.postMessage({sourceName:S,targetName:u,stream:R.CLOSE,streamId:m}),delete n.streamSinks[m])},error(y){(0,e.assert)(y instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,d.postMessage({sourceName:S,targetName:u,stream:R.ERROR,streamId:m,reason:L(y)}))},sinkCapability:new e.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:p.desiredSize,ready:null};F.sinkCapability.resolve(),F.ready=F.sinkCapability.promise,this.streamSinks[m]=F,new Promise(function(y){y(l(p.data,F))}).then(function(){d.postMessage({sourceName:S,targetName:u,stream:R.START_COMPLETE,streamId:m,success:!0})},function(y){d.postMessage({sourceName:S,targetName:u,stream:R.START_COMPLETE,streamId:m,reason:L(y)})})}function A(p){const m=p.streamId,S=this.sourceName,u=p.sourceName,d=this.comObj,n=this.streamControllers[m],l=this.streamSinks[m];switch(p.stream){case R.START_COMPLETE:p.success?n.startCall.resolve():n.startCall.reject(L(p.reason));break;case R.PULL_COMPLETE:p.success?n.pullCall.resolve():n.pullCall.reject(L(p.reason));break;case R.PULL:if(!l){d.postMessage({sourceName:S,targetName:u,stream:R.PULL_COMPLETE,streamId:m,success:!0});break}l.desiredSize<=0&&p.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=p.desiredSize,new Promise(function(F){var y;F((y=l.onPull)===null||y===void 0?void 0:y.call(l))}).then(function(){d.postMessage({sourceName:S,targetName:u,stream:R.PULL_COMPLETE,streamId:m,success:!0})},function(F){d.postMessage({sourceName:S,targetName:u,stream:R.PULL_COMPLETE,streamId:m,reason:L(F)})});break;case R.ENQUEUE:if((0,e.assert)(n,"enqueue should have stream controller"),n.isClosed)break;n.controller.enqueue(p.chunk);break;case R.CLOSE:if((0,e.assert)(n,"close should have stream controller"),n.isClosed)break;n.isClosed=!0,n.controller.close(),_assertClassBrand(V,this,M).call(this,n,m);break;case R.ERROR:(0,e.assert)(n,"error should have stream controller"),n.controller.error(L(p.reason)),_assertClassBrand(V,this,M).call(this,n,m);break;case R.CANCEL_COMPLETE:p.success?n.cancelCall.resolve():n.cancelCall.reject(L(p.reason)),_assertClassBrand(V,this,M).call(this,n,m);break;case R.CANCEL:if(!l)break;new Promise(function(F){var y;F((y=l.onCancel)===null||y===void 0?void 0:y.call(l,L(p.reason)))}).then(function(){d.postMessage({sourceName:S,targetName:u,stream:R.CANCEL_COMPLETE,streamId:m,success:!0})},function(F){d.postMessage({sourceName:S,targetName:u,stream:R.CANCEL_COMPLETE,streamId:m,reason:L(F)})}),l.sinkCapability.reject(L(p.reason)),l.isCancelled=!0,delete this.streamSinks[m];break;default:throw new Error("Unexpected stream case")}}async function M(p,m){var S,u,d;await Promise.allSettled([(S=p.startCall)===null||S===void 0?void 0:S.promise,(u=p.pullCall)===null||u===void 0?void 0:u.promise,(d=p.cancelCall)===null||d===void 0?void 0:d.promise]),delete this.streamControllers[m]}t.MessageHandler=D},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var e=_(1),r=new WeakMap,R=new WeakMap;class L{constructor(D){let{parsedData:f,rawData:A}=D;_classPrivateFieldInitSpec(this,r,void 0),_classPrivateFieldInitSpec(this,R,void 0),_classPrivateFieldSet(r,this,f),_classPrivateFieldSet(R,this,A)}getRaw(){return _classPrivateFieldGet(R,this)}get(D){var f;return(f=_classPrivateFieldGet(r,this).get(D))!==null&&f!==void 0?f:null}getAll(){return(0,e.objectFromMap)(_classPrivateFieldGet(r,this))}has(D){return _classPrivateFieldGet(r,this).has(D)}}t.Metadata=L},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var e=_(1),r=_(8);const R=Symbol("INTERNAL");var L=new WeakMap;class V{constructor(d,n){_classPrivateFieldInitSpec(this,L,!0),this.name=d,this.intent=n}get visible(){return _classPrivateFieldGet(L,this)}_setVisible(d,n){d!==R&&(0,e.unreachable)("Internal method `_setVisible` called."),_classPrivateFieldSet(L,this,n)}}var D=new WeakMap,f=new WeakMap,A=new WeakMap,M=new WeakMap,p=new WeakSet;class m{constructor(d){if(_classPrivateMethodInitSpec(this,p),_classPrivateFieldInitSpec(this,D,null),_classPrivateFieldInitSpec(this,f,new Map),_classPrivateFieldInitSpec(this,A,null),_classPrivateFieldInitSpec(this,M,null),this.name=null,this.creator=null,d!==null){this.name=d.name,this.creator=d.creator,_classPrivateFieldSet(M,this,d.order);for(const n of d.groups)_classPrivateFieldGet(f,this).set(n.id,new V(n.name,n.intent));if(d.baseState==="OFF")for(const n of _classPrivateFieldGet(f,this).values())n._setVisible(R,!1);for(const n of d.on)_classPrivateFieldGet(f,this).get(n)._setVisible(R,!0);for(const n of d.off)_classPrivateFieldGet(f,this).get(n)._setVisible(R,!1);_classPrivateFieldSet(A,this,this.getHash())}}isVisible(d){if(_classPrivateFieldGet(f,this).size===0)return!0;if(!d)return(0,e.warn)("Optional content group not defined."),!0;if(d.type==="OCG")return _classPrivateFieldGet(f,this).has(d.id)?_classPrivateFieldGet(f,this).get(d.id).visible:((0,e.warn)(`Optional content group not found: ${d.id}`),!0);if(d.type==="OCMD"){if(d.expression)return _assertClassBrand(p,this,S).call(this,d.expression);if(!d.policy||d.policy==="AnyOn"){for(const n of d.ids){if(!_classPrivateFieldGet(f,this).has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(_classPrivateFieldGet(f,this).get(n).visible)return!0}return!1}else if(d.policy==="AllOn"){for(const n of d.ids){if(!_classPrivateFieldGet(f,this).has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(!_classPrivateFieldGet(f,this).get(n).visible)return!1}return!0}else if(d.policy==="AnyOff"){for(const n of d.ids){if(!_classPrivateFieldGet(f,this).has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(!_classPrivateFieldGet(f,this).get(n).visible)return!0}return!1}else if(d.policy==="AllOff"){for(const n of d.ids){if(!_classPrivateFieldGet(f,this).has(n))return(0,e.warn)(`Optional content group not found: ${n}`),!0;if(_classPrivateFieldGet(f,this).get(n).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${d.policy}.`),!0}return(0,e.warn)(`Unknown group type ${d.type}.`),!0}setVisibility(d){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!_classPrivateFieldGet(f,this).has(d)){(0,e.warn)(`Optional content group not found: ${d}`);return}_classPrivateFieldGet(f,this).get(d)._setVisible(R,!!n),_classPrivateFieldSet(D,this,null)}get hasInitialVisibility(){return _classPrivateFieldGet(A,this)===null||this.getHash()===_classPrivateFieldGet(A,this)}getOrder(){return _classPrivateFieldGet(f,this).size?_classPrivateFieldGet(M,this)?_classPrivateFieldGet(M,this).slice():[..._classPrivateFieldGet(f,this).keys()]:null}getGroups(){return _classPrivateFieldGet(f,this).size>0?(0,e.objectFromMap)(_classPrivateFieldGet(f,this)):null}getGroup(d){return _classPrivateFieldGet(f,this).get(d)||null}getHash(){if(_classPrivateFieldGet(D,this)!==null)return _classPrivateFieldGet(D,this);const d=new r.MurmurHash3_64;for(const[n,l]of _classPrivateFieldGet(f,this))d.update(`${n}:${l.visible}`);return _classPrivateFieldSet(D,this,d.hexdigest())}}function S(u){const d=u.length;if(d<2)return!0;const n=u[0];for(let l=1;l<d;l++){const F=u[l];let y;if(Array.isArray(F))y=_assertClassBrand(p,this,S).call(this,F);else if(_classPrivateFieldGet(f,this).has(F))y=_classPrivateFieldGet(f,this).get(F).visible;else return(0,e.warn)(`Optional content group not found: ${F}`),!0;switch(n){case"And":if(!y)return!1;break;case"Or":if(y)return!0;break;case"Not":return!y;default:return!0}}return n==="And"}t.OptionalContentConfig=m},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var e=_(1),r=_(6);class R{constructor(f,A){let{length:M,initialData:p,progressiveDone:m=!1,contentDispositionFilename:S=null,disableRange:u=!1,disableStream:d=!1}=f;if((0,e.assert)(A,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=m,this._contentDispositionFilename=S,(p==null?void 0:p.length)>0){const n=p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength?p.buffer:new Uint8Array(p).buffer;this._queuedChunks.push(n)}this._pdfDataRangeTransport=A,this._isStreamingSupported=!d,this._isRangeSupported=!u,this._contentLength=M,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((n,l)=>{this._onReceiveData({begin:n,chunk:l})}),this._pdfDataRangeTransport.addProgressListener((n,l)=>{this._onProgress({loaded:n,total:l})}),this._pdfDataRangeTransport.addProgressiveReadListener(n=>{this._onReceiveData({chunk:n})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){let{begin:A,chunk:M}=f;const p=M instanceof Uint8Array&&M.byteLength===M.buffer.byteLength?M.buffer:new Uint8Array(M).buffer;if(A===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(p):this._queuedChunks.push(p);else{const m=this._rangeReaders.some(function(S){return S._begin!==A?!1:(S._enqueue(p),!0)});(0,e.assert)(m,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f,A;return(f=(A=this._fullRequestReader)===null||A===void 0?void 0:A._loaded)!==null&&f!==void 0?f:0}_onProgress(f){if(f.total===void 0){var A,M;(A=this._rangeReaders[0])===null||A===void 0||(M=A.onProgress)===null||M===void 0||M.call(A,{loaded:f.loaded})}else{var p,m;(p=this._fullRequestReader)===null||p===void 0||(m=p.onProgress)===null||m===void 0||m.call(p,{loaded:f.loaded,total:f.total})}}_onProgressiveDone(){var f;(f=this._fullRequestReader)===null||f===void 0||f.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const A=this._rangeReaders.indexOf(f);A>=0&&this._rangeReaders.splice(A,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new L(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,A){if(A<=this._progressiveDataLength)return null;const M=new V(this,f,A);return this._pdfDataRangeTransport.requestDataRange(f,A),this._rangeReaders.push(M),M}cancelAllRequests(f){var A;(A=this._fullRequestReader)===null||A===void 0||A.cancel(f);for(const M of this._rangeReaders.slice(0))M.cancel(f);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=R;class L{constructor(f,A){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this._stream=f,this._done=M||!1,this._filename=(0,r.isPdfFile)(p)?p:null,this._queuedChunks=A||[],this._loaded=0;for(const m of this._queuedChunks)this._loaded+=m.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=new e.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class V{constructor(f,A,M){this._stream=f,this._begin=A,this._end=M,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const A=this._queuedChunk;return this._queuedChunk=null,{value:A,done:!1}}if(this._done)return{value:void 0,done:!0};const f=new e.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var e=_(1),r=_(20);function R(M,p,m){return{method:"GET",headers:M,signal:m.signal,mode:"cors",credentials:p?"include":"same-origin",redirect:"follow"}}function L(M){const p=new Headers;for(const m in M){const S=M[m];S!==void 0&&p.append(m,S)}return p}function V(M){return M instanceof Uint8Array?M.buffer:M instanceof ArrayBuffer?M:((0,e.warn)(`getArrayBuffer - unexpected data format: ${M}`),new Uint8Array(M).buffer)}class D{constructor(p){this.source=p,this.isHttp=/^https?:/i.test(p.url),this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var p,m;return(p=(m=this._fullRequestReader)===null||m===void 0?void 0:m._loaded)!==null&&p!==void 0?p:0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f(this),this._fullRequestReader}getRangeReader(p,m){if(m<=this._progressiveDataLength)return null;const S=new A(this,p,m);return this._rangeRequestReaders.push(S),S}cancelAllRequests(p){var m;(m=this._fullRequestReader)===null||m===void 0||m.cancel(p);for(const S of this._rangeRequestReaders.slice(0))S.cancel(p)}}t.PDFFetchStream=D;class f{constructor(p){this._stream=p,this._reader=null,this._loaded=0,this._filename=null;const m=p.source;this._withCredentials=m.withCredentials||!1,this._contentLength=m.length,this._headersCapability=new e.PromiseCapability,this._disableRange=m.disableRange||!1,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._headers=L(this._stream.httpHeaders);const S=m.url;fetch(S,R(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,r.validateResponseStatus)(u.status))throw(0,r.createResponseStatusError)(u.status,S);this._reader=u.body.getReader(),this._headersCapability.resolve();const d=F=>u.headers.get(F),{allowRangeRequests:n,suggestedLength:l}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=l||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(d),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._headersCapability.promise;const{value:m,done:S}=await this._reader.read();return S?{value:m,done:S}:(this._loaded+=m.byteLength,(p=this.onProgress)===null||p===void 0||p.call(this,{loaded:this._loaded,total:this._contentLength}),{value:V(m),done:!1})}cancel(p){var m;(m=this._reader)===null||m===void 0||m.cancel(p),this._abortController.abort()}}class A{constructor(p,m,S){this._stream=p,this._reader=null,this._loaded=0;const u=p.source;this._withCredentials=u.withCredentials||!1,this._readCapability=new e.PromiseCapability,this._isStreamingSupported=!u.disableStream,this._abortController=new AbortController,this._headers=L(this._stream.httpHeaders),this._headers.append("Range",`bytes=${m}-${S-1}`);const d=u.url;fetch(d,R(this._headers,this._withCredentials,this._abortController)).then(n=>{if(!(0,r.validateResponseStatus)(n.status))throw(0,r.createResponseStatusError)(n.status,d);this._readCapability.resolve(),this._reader=n.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._readCapability.promise;const{value:m,done:S}=await this._reader.read();return S?{value:m,done:S}:(this._loaded+=m.byteLength,(p=this.onProgress)===null||p===void 0||p.call(this,{loaded:this._loaded}),{value:V(m),done:!1})}cancel(p){var m;(m=this._reader)===null||m===void 0||m.cancel(p),this._abortController.abort()}}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=D,t.extractFilenameFromHeader=V,t.validateRangeRequestCapabilities=L,t.validateResponseStatus=f;var e=_(1),r=_(21),R=_(6);function L(A){let{getResponseHeader:M,isHttp:p,rangeChunkSize:m,disableRange:S}=A;const u={allowRangeRequests:!1,suggestedLength:void 0},d=parseInt(M("Content-Length"),10);return!Number.isInteger(d)||(u.suggestedLength=d,d<=2*m)||S||!p||M("Accept-Ranges")!=="bytes"||(M("Content-Encoding")||"identity")!=="identity"||(u.allowRangeRequests=!0),u}function V(A){const M=A("Content-Disposition");if(M){let p=(0,r.getFilenameFromContentDispositionHeader)(M);if(p.includes("%"))try{p=decodeURIComponent(p)}catch{}if((0,R.isPdfFile)(p))return p}return null}function D(A,M){return A===404||A===0&&M.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+M+'".'):new e.UnexpectedResponseException(`Unexpected server response (${A}) while retrieving PDF "${M}".`,A)}function f(A){return A===200||A===206}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=r;var e=_(1);function r(R){let L=!0,V=D("filename\\*","i").exec(R);if(V){V=V[1];let u=p(V);return u=unescape(u),u=m(u),u=S(u),A(u)}if(V=M(R),V){const u=S(V);return A(u)}if(V=D("filename","i").exec(R),V){V=V[1];let u=p(V);return u=S(u),A(u)}function D(u,d){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function f(u,d){if(u){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const n=new TextDecoder(u,{fatal:!0}),l=(0,e.stringToBytes)(d);d=n.decode(l),L=!1}catch{}}return d}function A(u){return L&&/[\x80-\xff]/.test(u)&&(u=f("utf-8",u),L&&(u=f("iso-8859-1",u))),u}function M(u){const d=[];let n;const l=D("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(n=l.exec(u))!==null;){let[,y,a,o]=n;if(y=parseInt(y,10),y in d){if(y===0)break;continue}d[y]=[a,o]}const F=[];for(let y=0;y<d.length&&y in d;++y){let[a,o]=d[y];o=p(o),a&&(o=unescape(o),y===0&&(o=m(o))),F.push(o)}return F.join("")}function p(u){if(u.startsWith('"')){const d=u.slice(1).split('\\"');for(let n=0;n<d.length;++n){const l=d[n].indexOf('"');l!==-1&&(d[n]=d[n].slice(0,l),d.length=n+1),d[n]=d[n].replaceAll(/\\(.)/g,"$1")}u=d.join('"')}return u}function m(u){const d=u.indexOf("'");if(d===-1)return u;const n=u.slice(0,d),F=u.slice(d+1).replace(/^[^']*'/,"");return f(n,F)}function S(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,n,l,F){if(l==="q"||l==="Q")return F=F.replaceAll("_"," "),F=F.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,a){return String.fromCharCode(parseInt(a,16))}),f(n,F);try{F=atob(F)}catch{}return f(n,F)})}return""}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var e=_(1),r=_(20);const R=200,L=206;function V(p){const m=p.response;return typeof m!="string"?m:(0,e.stringToBytes)(m).buffer}class D{constructor(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.url=m,this.isHttp=/^https?:/i.test(m),this.httpHeaders=this.isHttp&&S.httpHeaders||Object.create(null),this.withCredentials=S.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(m,S,u){const d={begin:m,end:S};for(const n in u)d[n]=u[n];return this.request(d)}requestFull(m){return this.request(m)}request(m){const S=new XMLHttpRequest,u=this.currXhrId++,d=this.pendingRequests[u]={xhr:S};S.open("GET",this.url),S.withCredentials=this.withCredentials;for(const n in this.httpHeaders){const l=this.httpHeaders[n];l!==void 0&&S.setRequestHeader(n,l)}return this.isHttp&&"begin"in m&&"end"in m?(S.setRequestHeader("Range",`bytes=${m.begin}-${m.end-1}`),d.expectedStatus=L):d.expectedStatus=R,S.responseType="arraybuffer",m.onError&&(S.onerror=function(n){m.onError(S.status)}),S.onreadystatechange=this.onStateChange.bind(this,u),S.onprogress=this.onProgress.bind(this,u),d.onHeadersReceived=m.onHeadersReceived,d.onDone=m.onDone,d.onError=m.onError,d.onProgress=m.onProgress,S.send(null),u}onProgress(m,S){var u;const d=this.pendingRequests[m];d&&((u=d.onProgress)===null||u===void 0||u.call(d,S))}onStateChange(m,S){const u=this.pendingRequests[m];if(!u)return;const d=u.xhr;if(d.readyState>=2&&u.onHeadersReceived&&(u.onHeadersReceived(),delete u.onHeadersReceived),d.readyState!==4||!(m in this.pendingRequests))return;if(delete this.pendingRequests[m],d.status===0&&this.isHttp){var n;(n=u.onError)===null||n===void 0||n.call(u,d.status);return}const l=d.status||R;if(!(l===R&&u.expectedStatus===L)&&l!==u.expectedStatus){var y;(y=u.onError)===null||y===void 0||y.call(u,d.status);return}const a=V(d);if(l===L){const w=d.getResponseHeader("Content-Range"),Y=/bytes (\d+)-(\d+)\/(\d+)/.exec(w);u.onDone({begin:parseInt(Y[1],10),chunk:a})}else if(a)u.onDone({begin:0,chunk:a});else{var o;(o=u.onError)===null||o===void 0||o.call(u,d.status)}}getRequestXhr(m){return this.pendingRequests[m].xhr}isPendingRequest(m){return m in this.pendingRequests}abortRequest(m){const S=this.pendingRequests[m].xhr;delete this.pendingRequests[m],S.abort()}}class f{constructor(m){this._source=m,this._manager=new D(m.url,{httpHeaders:m.httpHeaders,withCredentials:m.withCredentials}),this._rangeChunkSize=m.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(m){const S=this._rangeRequestReaders.indexOf(m);S>=0&&this._rangeRequestReaders.splice(S,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new A(this._manager,this._source),this._fullRequestReader}getRangeReader(m,S){const u=new M(this._manager,m,S);return u.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(u),u}cancelAllRequests(m){var S;(S=this._fullRequestReader)===null||S===void 0||S.cancel(m);for(const u of this._rangeRequestReaders.slice(0))u.cancel(m)}}t.PDFNetworkStream=f;class A{constructor(m,S){this._manager=m;const u={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=S.url,this._fullRequestId=m.requestFull(u),this._headersReceivedCapability=new e.PromiseCapability,this._disableRange=S.disableRange||!1,this._contentLength=S.length,this._rangeChunkSize=S.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const m=this._fullRequestId,S=this._manager.getRequestXhr(m),u=l=>S.getResponseHeader(l),{allowRangeRequests:d,suggestedLength:n}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});d&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(u),this._isRangeSupported&&this._manager.abortRequest(m),this._headersReceivedCapability.resolve()}_onDone(m){if(m&&(this._requests.length>0?this._requests.shift().resolve({value:m.chunk,done:!1}):this._cachedChunks.push(m.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(m){this._storedError=(0,r.createResponseStatusError)(m,this._url),this._headersReceivedCapability.reject(this._storedError);for(const S of this._requests)S.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(m){var S;(S=this.onProgress)===null||S===void 0||S.call(this,{loaded:m.loaded,total:m.lengthComputable?m.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const m=new e.PromiseCapability;return this._requests.push(m),m.promise}cancel(m){this._done=!0,this._headersReceivedCapability.reject(m);for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class M{constructor(m,S,u){this._manager=m;const d={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._requestId=m.requestRange(S,u,d),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var m;(m=this.onClosed)===null||m===void 0||m.call(this,this)}_onDone(m){const S=m.chunk;this._requests.length>0?this._requests.shift().resolve({value:S,done:!1}):this._queuedChunk=S,this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(m){this._storedError=(0,r.createResponseStatusError)(m,this._url);for(const S of this._requests)S.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(m){if(!this.isStreamingSupported){var S;(S=this.onProgress)===null||S===void 0||S.call(this,{loaded:m.loaded})}}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const S=this._queuedChunk;return this._queuedChunk=null,{value:S,done:!1}}if(this._done)return{value:void 0,done:!0};const m=new e.PromiseCapability;return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var e=_(1),r=_(20);const R=/^file:\/\/\/[a-zA-Z]:\//;function L(u){const d=require$$5,n=d.parse(u);return n.protocol==="file:"||n.host?n:/^[a-z]:[/\\]/i.test(u)?d.parse(`file:///${u}`):(n.host||(n.protocol="file:"),n)}class V{constructor(d){this.source=d,this.url=L(d.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&d.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var d,n;return(d=(n=this._fullRequestReader)===null||n===void 0?void 0:n._loaded)!==null&&d!==void 0?d:0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new m(this):new M(this),this._fullRequestReader}getRangeReader(d,n){if(n<=this._progressiveDataLength)return null;const l=this.isFsUrl?new S(this,d,n):new p(this,d,n);return this._rangeRequestReaders.push(l),l}cancelAllRequests(d){var n;(n=this._fullRequestReader)===null||n===void 0||n.cancel(d);for(const l of this._rangeRequestReaders.slice(0))l.cancel(d)}}t.PDFNodeStream=V;class D{constructor(d){this._url=d.url,this._done=!1,this._storedError=null,this.onProgress=null;const n=d.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=new e.PromiseCapability,this._headersCapability=new e.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var d;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const n=this._readableStream.read();return n===null?(this._readCapability=new e.PromiseCapability,this.read()):(this._loaded+=n.length,(d=this.onProgress)===null||d===void 0||d.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(n).buffer,done:!1})}cancel(d){if(!this._readableStream){this._error(d);return}this._readableStream.destroy(d)}_error(d){this._storedError=d,this._readCapability.resolve()}_setReadableStream(d){this._readableStream=d,d.on("readable",()=>{this._readCapability.resolve()}),d.on("end",()=>{d.destroy(),this._done=!0,this._readCapability.resolve()}),d.on("error",n=>{this._error(n)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class f{constructor(d){this._url=d.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new e.PromiseCapability;const n=d.source;this._isStreamingSupported=!n.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var d;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const n=this._readableStream.read();return n===null?(this._readCapability=new e.PromiseCapability,this.read()):(this._loaded+=n.length,(d=this.onProgress)===null||d===void 0||d.call(this,{loaded:this._loaded}),{value:new Uint8Array(n).buffer,done:!1})}cancel(d){if(!this._readableStream){this._error(d);return}this._readableStream.destroy(d)}_error(d){this._storedError=d,this._readCapability.resolve()}_setReadableStream(d){this._readableStream=d,d.on("readable",()=>{this._readCapability.resolve()}),d.on("end",()=>{d.destroy(),this._done=!0,this._readCapability.resolve()}),d.on("error",n=>{this._error(n)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function A(u,d){return{protocol:u.protocol,auth:u.auth,host:u.hostname,port:u.port,path:u.path,method:"GET",headers:d}}class M extends D{constructor(d){super(d);const n=l=>{if(l.statusCode===404){const o=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o,this._headersCapability.reject(o);return}this._headersCapability.resolve(),this._setReadableStream(l);const F=o=>this._readableStream.headers[o.toLowerCase()],{allowRangeRequests:y,suggestedLength:a}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:F,isHttp:d.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=a||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(F)};if(this._request=null,this._url.protocol==="http:"){const l=require$$5;this._request=l.request(A(this._url,d.httpHeaders),n)}else{const l=require$$5;this._request=l.request(A(this._url,d.httpHeaders),n)}this._request.on("error",l=>{this._storedError=l,this._headersCapability.reject(l)}),this._request.end()}}class p extends f{constructor(d,n,l){super(d),this._httpHeaders={};for(const y in d.httpHeaders){const a=d.httpHeaders[y];a!==void 0&&(this._httpHeaders[y]=a)}this._httpHeaders.Range=`bytes=${n}-${l-1}`;const F=y=>{if(y.statusCode===404){const a=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(y)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(A(this._url,this._httpHeaders),F)}else{const y=require$$5;this._request=y.request(A(this._url,this._httpHeaders),F)}this._request.on("error",y=>{this._storedError=y}),this._request.end()}}class m extends D{constructor(d){super(d);let n=decodeURIComponent(this._url.path);R.test(this._url.href)&&(n=n.replace(/^\//,""));const l=require$$5;l.lstat(n,(F,y)=>{if(F){F.code==="ENOENT"&&(F=new e.MissingPDFException(`Missing PDF "${n}".`)),this._storedError=F,this._headersCapability.reject(F);return}this._contentLength=y.size,this._setReadableStream(l.createReadStream(n)),this._headersCapability.resolve()})}}class S extends f{constructor(d,n,l){super(d);let F=decodeURIComponent(this._url.path);R.test(this._url.href)&&(F=F.replace(/^\//,""));const y=require$$5;this._setReadableStream(y.createReadStream(F,{start:n,end:l-1}))}}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var e=_(6),r=_(1);const R={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},L="http://www.w3.org/XML/1998/namespace",V="http://www.w3.org/1999/xlink",D=["butt","round","square"],f=["miter","round","bevel"],A=function(y){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(URL.createObjectURL&&typeof Blob<"u"&&!o)return URL.createObjectURL(new Blob([y],{type:a}));const w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Y=`data:${a};base64,`;for(let B=0,g=y.length;B<g;B+=3){const P=y[B]&255,q=y[B+1]&255,Q=y[B+2]&255,$=P>>2,et=(P&3)<<4|q>>4,_t=B+1<g?(q&15)<<2|Q>>6:64,X=B+2<g?Q&63:64;Y+=w[$]+w[et]+w[_t]+w[X]}return Y},M=function(){const y=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,o=new Int32Array(256);for(let Q=0;Q<256;Q++){let $=Q;for(let et=0;et<8;et++)$=$&1?3988292384^$>>1&2147483647:$>>1&2147483647;o[Q]=$}function w(Q,$,et){let _t=-1;for(let X=$;X<et;X++){const b=(_t^Q[X])&255,N=o[b];_t=_t>>>8^N}return _t^-1}function Y(Q,$,et,_t){let X=_t;const b=$.length;et[X]=b>>24&255,et[X+1]=b>>16&255,et[X+2]=b>>8&255,et[X+3]=b&255,X+=4,et[X]=Q.charCodeAt(0)&255,et[X+1]=Q.charCodeAt(1)&255,et[X+2]=Q.charCodeAt(2)&255,et[X+3]=Q.charCodeAt(3)&255,X+=4,et.set($,X),X+=$.length;const N=w(et,_t+4,X);et[X]=N>>24&255,et[X+1]=N>>16&255,et[X+2]=N>>8&255,et[X+3]=N&255}function B(Q,$,et){let _t=1,X=0;for(let b=$;b<et;++b)_t=(_t+(Q[b]&255))%65521,X=(X+_t)%65521;return X<<16|_t}function g(Q){if(!r.isNodeJS)return P(Q);try{const $=parseInt(process.versions.node)>=8?Q:Buffer.from(Q),et=require$$5.deflateSync($,{level:9});return et instanceof Uint8Array?et:new Uint8Array(et)}catch($){(0,r.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+$)}return P(Q)}function P(Q){let $=Q.length;const et=65535,_t=Math.ceil($/et),X=new Uint8Array(2+$+_t*5+4);let b=0;X[b++]=120,X[b++]=156;let N=0;for(;$>et;)X[b++]=0,X[b++]=255,X[b++]=255,X[b++]=0,X[b++]=0,X.set(Q.subarray(N,N+et),b),b+=et,N+=et,$-=et;X[b++]=1,X[b++]=$&255,X[b++]=$>>8&255,X[b++]=~$&65535&255,X[b++]=(~$&65535)>>8&255,X.set(Q.subarray(N),b),b+=Q.length-N;const rt=B(Q,0,Q.length);return X[b++]=rt>>24&255,X[b++]=rt>>16&255,X[b++]=rt>>8&255,X[b++]=rt&255,X}function q(Q,$,et,_t){const X=Q.width,b=Q.height;let N,rt,v;const s=Q.data;switch($){case r.ImageKind.GRAYSCALE_1BPP:rt=0,N=1,v=X+7>>3;break;case r.ImageKind.RGB_24BPP:rt=2,N=8,v=X*3;break;case r.ImageKind.RGBA_32BPP:rt=6,N=8,v=X*4;break;default:throw new Error("invalid format")}const i=new Uint8Array((1+v)*b);let h=0,E=0;for(let at=0;at<b;++at)i[h++]=0,i.set(s.subarray(E,E+v),h),E+=v,h+=v;if($===r.ImageKind.GRAYSCALE_1BPP&&_t){h=0;for(let at=0;at<b;at++){h++;for(let dt=0;dt<v;dt++)i[h++]^=255}}const C=new Uint8Array([X>>24&255,X>>16&255,X>>8&255,X&255,b>>24&255,b>>16&255,b>>8&255,b&255,N,rt,0,0,0]),U=g(i),H=y.length+a*3+C.length+U.length,K=new Uint8Array(H);let ot=0;return K.set(y,ot),ot+=y.length,Y("IHDR",C,K,ot),ot+=a+C.length,Y("IDATA",U,K,ot),ot+=a+U.length,Y("IEND",new Uint8Array(0),K,ot),A(K,"image/png",et)}return function($,et,_t){const X=$.kind===void 0?r.ImageKind.GRAYSCALE_1BPP:$.kind;return q($,X,et,_t)}}();class p{constructor(){this.fontSizeScale=1,this.fontWeight=R.fontWeight,this.fontSize=0,this.textMatrix=r.IDENTITY_MATRIX,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=r.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=R.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,o){this.x=a,this.y=o}}function m(y){let a=[];const o=[];for(const w of y){if(w.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),o.push(a),a=a.at(-1).items;continue}w.fn==="restore"?a=o.pop():a.push(w)}return a}function S(y){if(Number.isInteger(y))return y.toString();const a=y.toFixed(10);let o=a.length-1;if(a[o]!=="0")return a;do o--;while(a[o]==="0");return a.substring(0,a[o]==="."?o:o+1)}function u(y){if(y[4]===0&&y[5]===0){if(y[1]===0&&y[2]===0)return y[0]===1&&y[3]===1?"":`scale(${S(y[0])} ${S(y[3])})`;if(y[0]===y[3]&&y[1]===-y[2]){const a=Math.acos(y[0])*180/Math.PI;return`rotate(${S(a)})`}}else if(y[0]===1&&y[1]===0&&y[2]===0&&y[3]===1)return`translate(${S(y[4])} ${S(y[5])})`;return`matrix(${S(y[0])} ${S(y[1])} ${S(y[2])} ${S(y[3])} ${S(y[4])} ${S(y[5])})`}let d=0,n=0,l=0;class F{constructor(a,o){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;(0,e.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new e.DOMSVGFactory,this.current=new p,this.transformMatrix=r.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=a,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!w,this._operatorIdMapping=[];for(const Y in r.OPS)this._operatorIdMapping[r.OPS[Y]]=Y}getObject(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof a=="string"?a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a):o}save(){this.transformStack.push(this.transformMatrix);const a=this.current;this.extraStack.push(a),this.current=a.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(a){this.save(),this.executeOpTree(a),this.restore()}loadDependencies(a){const o=a.fnArray,w=a.argsArray;for(let Y=0,B=o.length;Y<B;Y++)if(o[Y]===r.OPS.dependency)for(const g of w[Y]){const P=g.startsWith("g_")?this.commonObjs:this.objs,q=new Promise(Q=>{P.get(g,Q)});this.current.dependencies.push(q)}return Promise.all(this.current.dependencies)}transform(a,o,w,Y,B,g){const P=[a,o,w,Y,B,g];this.transformMatrix=r.Util.transform(this.transformMatrix,P),this.tgrp=null}getSVG(a,o){this.viewport=o;const w=this._initialize(o);return this.loadDependencies(a).then(()=>(this.transformMatrix=r.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(a)),w))}convertOpList(a){const o=this._operatorIdMapping,w=a.argsArray,Y=a.fnArray,B=[];for(let g=0,P=Y.length;g<P;g++){const q=Y[g];B.push({fnId:q,fn:o[q],args:w[g]})}return m(B)}executeOpTree(a){for(const o of a){const w=o.fn,Y=o.fnId,B=o.args;switch(Y|0){case r.OPS.beginText:this.beginText();break;case r.OPS.dependency:break;case r.OPS.setLeading:this.setLeading(B);break;case r.OPS.setLeadingMoveText:this.setLeadingMoveText(B[0],B[1]);break;case r.OPS.setFont:this.setFont(B);break;case r.OPS.showText:this.showText(B[0]);break;case r.OPS.showSpacedText:this.showText(B[0]);break;case r.OPS.endText:this.endText();break;case r.OPS.moveText:this.moveText(B[0],B[1]);break;case r.OPS.setCharSpacing:this.setCharSpacing(B[0]);break;case r.OPS.setWordSpacing:this.setWordSpacing(B[0]);break;case r.OPS.setHScale:this.setHScale(B[0]);break;case r.OPS.setTextMatrix:this.setTextMatrix(B[0],B[1],B[2],B[3],B[4],B[5]);break;case r.OPS.setTextRise:this.setTextRise(B[0]);break;case r.OPS.setTextRenderingMode:this.setTextRenderingMode(B[0]);break;case r.OPS.setLineWidth:this.setLineWidth(B[0]);break;case r.OPS.setLineJoin:this.setLineJoin(B[0]);break;case r.OPS.setLineCap:this.setLineCap(B[0]);break;case r.OPS.setMiterLimit:this.setMiterLimit(B[0]);break;case r.OPS.setFillRGBColor:this.setFillRGBColor(B[0],B[1],B[2]);break;case r.OPS.setStrokeRGBColor:this.setStrokeRGBColor(B[0],B[1],B[2]);break;case r.OPS.setStrokeColorN:this.setStrokeColorN(B);break;case r.OPS.setFillColorN:this.setFillColorN(B);break;case r.OPS.shadingFill:this.shadingFill(B[0]);break;case r.OPS.setDash:this.setDash(B[0],B[1]);break;case r.OPS.setRenderingIntent:this.setRenderingIntent(B[0]);break;case r.OPS.setFlatness:this.setFlatness(B[0]);break;case r.OPS.setGState:this.setGState(B[0]);break;case r.OPS.fill:this.fill();break;case r.OPS.eoFill:this.eoFill();break;case r.OPS.stroke:this.stroke();break;case r.OPS.fillStroke:this.fillStroke();break;case r.OPS.eoFillStroke:this.eoFillStroke();break;case r.OPS.clip:this.clip("nonzero");break;case r.OPS.eoClip:this.clip("evenodd");break;case r.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case r.OPS.paintImageXObject:this.paintImageXObject(B[0]);break;case r.OPS.paintInlineImageXObject:this.paintInlineImageXObject(B[0]);break;case r.OPS.paintImageMaskXObject:this.paintImageMaskXObject(B[0]);break;case r.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(B[0],B[1]);break;case r.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case r.OPS.closePath:this.closePath();break;case r.OPS.closeStroke:this.closeStroke();break;case r.OPS.closeFillStroke:this.closeFillStroke();break;case r.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case r.OPS.nextLine:this.nextLine();break;case r.OPS.transform:this.transform(B[0],B[1],B[2],B[3],B[4],B[5]);break;case r.OPS.constructPath:this.constructPath(B[0],B[1]);break;case r.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,r.warn)(`Unimplemented operator ${w}`);break}}}setWordSpacing(a){this.current.wordSpacing=a}setCharSpacing(a){this.current.charSpacing=a}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(a,o,w,Y,B,g){const P=this.current;P.textMatrix=P.lineMatrix=[a,o,w,Y,B,g],P.textMatrixScale=Math.hypot(a,o),P.x=P.lineX=0,P.y=P.lineY=0,P.xcoords=[],P.ycoords=[],P.tspan=this.svgFactory.createElement("svg:tspan"),P.tspan.setAttributeNS(null,"font-family",P.fontFamily),P.tspan.setAttributeNS(null,"font-size",`${S(P.fontSize)}px`),P.tspan.setAttributeNS(null,"y",S(-P.y)),P.txtElement=this.svgFactory.createElement("svg:text"),P.txtElement.append(P.tspan)}beginText(){const a=this.current;a.x=a.lineX=0,a.y=a.lineY=0,a.textMatrix=r.IDENTITY_MATRIX,a.lineMatrix=r.IDENTITY_MATRIX,a.textMatrixScale=1,a.tspan=this.svgFactory.createElement("svg:tspan"),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtgrp=this.svgFactory.createElement("svg:g"),a.xcoords=[],a.ycoords=[]}moveText(a,o){const w=this.current;w.x=w.lineX+=a,w.y=w.lineY+=o,w.xcoords=[],w.ycoords=[],w.tspan=this.svgFactory.createElement("svg:tspan"),w.tspan.setAttributeNS(null,"font-family",w.fontFamily),w.tspan.setAttributeNS(null,"font-size",`${S(w.fontSize)}px`),w.tspan.setAttributeNS(null,"y",S(-w.y))}showText(a){const o=this.current,w=o.font,Y=o.fontSize;if(Y===0)return;const B=o.fontSizeScale,g=o.charSpacing,P=o.wordSpacing,q=o.fontDirection,Q=o.textHScale*q,$=w.vertical,et=$?1:-1,_t=w.defaultVMetrics,X=Y*o.fontMatrix[0];let b=0;for(const v of a){if(v===null){b+=q*P;continue}else if(typeof v=="number"){b+=et*v*Y/1e3;continue}const s=(v.isSpace?P:0)+g,i=v.fontChar;let h,E,C=v.width;if($){let H;const K=v.vmetric||_t;H=v.vmetric?K[1]:C*.5,H=-H*X;const ot=K[2]*X;C=K?-K[0]:C,h=H/B,E=(b+ot)/B}else h=b/B,E=0;(v.isInFont||w.missingFile)&&(o.xcoords.push(o.x+h),$&&o.ycoords.push(-o.y+E),o.tspan.textContent+=i);const U=$?C*X-s*q:C*X+s*q;b+=U}o.tspan.setAttributeNS(null,"x",o.xcoords.map(S).join(" ")),$?o.tspan.setAttributeNS(null,"y",o.ycoords.map(S).join(" ")):o.tspan.setAttributeNS(null,"y",S(-o.y)),$?o.y-=b:o.x+=b*Q,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${S(o.fontSize)}px`),o.fontStyle!==R.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==R.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const N=o.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;if(N===r.TextRenderingMode.FILL||N===r.TextRenderingMode.FILL_STROKE?(o.fillColor!==R.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===r.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),N===r.TextRenderingMode.STROKE||N===r.TextRenderingMode.FILL_STROKE){const v=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,v)}let rt=o.textMatrix;o.textRise!==0&&(rt=rt.slice(),rt[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${u(rt)} scale(${S(Q)}, -1)`),o.txtElement.setAttributeNS(L,"xml:space","preserve"),o.txtElement.append(o.tspan),o.txtgrp.append(o.txtElement),this._ensureTransformGroup().append(o.txtElement)}setLeadingMoveText(a,o){this.setLeading(-o),this.moveText(a,o)}addFontStyle(a){if(!a.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const o=A(a.data,a.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${a.loadedName}"; src: url(${o}); }
`}setFont(a){const o=this.current,w=this.commonObjs.get(a[0]);let Y=a[1];o.font=w,this.embedFonts&&!w.missingFile&&!this.embeddedFonts[w.loadedName]&&(this.addFontStyle(w),this.embeddedFonts[w.loadedName]=w),o.fontMatrix=w.fontMatrix||r.FONT_IDENTITY_MATRIX;let B="normal";w.black?B="900":w.bold&&(B="bold");const g=w.italic?"italic":"normal";Y<0?(Y=-Y,o.fontDirection=-1):o.fontDirection=1,o.fontSize=Y,o.fontFamily=w.loadedName,o.fontWeight=B,o.fontStyle=g,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",S(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var a;const o=this.current;o.textRenderingMode&r.TextRenderingMode.ADD_TO_PATH_FLAG&&(a=o.txtElement)!==null&&a!==void 0&&a.hasChildNodes()&&(o.element=o.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(a){a>0&&(this.current.lineWidth=a)}setLineCap(a){this.current.lineCap=D[a]}setLineJoin(a){this.current.lineJoin=f[a]}setMiterLimit(a){this.current.miterLimit=a}setStrokeAlpha(a){this.current.strokeAlpha=a}setStrokeRGBColor(a,o,w){this.current.strokeColor=r.Util.makeHexColor(a,o,w)}setFillAlpha(a){this.current.fillAlpha=a}setFillRGBColor(a,o,w){this.current.fillColor=r.Util.makeHexColor(a,o,w),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(a){this.current.strokeColor=this._makeColorN_Pattern(a)}setFillColorN(a){this.current.fillColor=this._makeColorN_Pattern(a)}shadingFill(a){const{width:o,height:w}=this.viewport,Y=r.Util.inverseTransform(this.transformMatrix),[B,g,P,q]=r.Util.getAxialAlignedBoundingBox([0,0,o,w],Y),Q=this.svgFactory.createElement("svg:rect");Q.setAttributeNS(null,"x",B),Q.setAttributeNS(null,"y",g),Q.setAttributeNS(null,"width",P-B),Q.setAttributeNS(null,"height",q-g),Q.setAttributeNS(null,"fill",this._makeShadingPattern(a)),this.current.fillAlpha<1&&Q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Q)}_makeColorN_Pattern(a){return a[0]==="TilingPattern"?this._makeTilingPattern(a):this._makeShadingPattern(a)}_makeTilingPattern(a){const o=a[1],w=a[2],Y=a[3]||r.IDENTITY_MATRIX,[B,g,P,q]=a[4],Q=a[5],$=a[6],et=a[7],_t=`shading${l++}`,[X,b,N,rt]=r.Util.normalizeRect([...r.Util.applyTransform([B,g],Y),...r.Util.applyTransform([P,q],Y)]),[v,s]=r.Util.singularValueDecompose2dScale(Y),i=Q*v,h=$*s,E=this.svgFactory.createElement("svg:pattern");E.setAttributeNS(null,"id",_t),E.setAttributeNS(null,"patternUnits","userSpaceOnUse"),E.setAttributeNS(null,"width",i),E.setAttributeNS(null,"height",h),E.setAttributeNS(null,"x",`${X}`),E.setAttributeNS(null,"y",`${b}`);const C=this.svg,U=this.transformMatrix,H=this.current.fillColor,K=this.current.strokeColor,ot=this.svgFactory.create(N-X,rt-b);if(this.svg=ot,this.transformMatrix=Y,et===2){const at=r.Util.makeHexColor(...o);this.current.fillColor=at,this.current.strokeColor=at}return this.executeOpTree(this.convertOpList(w)),this.svg=C,this.transformMatrix=U,this.current.fillColor=H,this.current.strokeColor=K,E.append(ot.childNodes[0]),this.defs.append(E),`url(#${_t})`}_makeShadingPattern(a){switch(typeof a=="string"&&(a=this.objs.get(a)),a[0]){case"RadialAxial":const o=`shading${l++}`,w=a[3];let Y;switch(a[1]){case"axial":const B=a[4],g=a[5];Y=this.svgFactory.createElement("svg:linearGradient"),Y.setAttributeNS(null,"id",o),Y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Y.setAttributeNS(null,"x1",B[0]),Y.setAttributeNS(null,"y1",B[1]),Y.setAttributeNS(null,"x2",g[0]),Y.setAttributeNS(null,"y2",g[1]);break;case"radial":const P=a[4],q=a[5],Q=a[6],$=a[7];Y=this.svgFactory.createElement("svg:radialGradient"),Y.setAttributeNS(null,"id",o),Y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Y.setAttributeNS(null,"cx",q[0]),Y.setAttributeNS(null,"cy",q[1]),Y.setAttributeNS(null,"r",$),Y.setAttributeNS(null,"fx",P[0]),Y.setAttributeNS(null,"fy",P[1]),Y.setAttributeNS(null,"fr",Q);break;default:throw new Error(`Unknown RadialAxial type: ${a[1]}`)}for(const B of w){const g=this.svgFactory.createElement("svg:stop");g.setAttributeNS(null,"offset",B[0]),g.setAttributeNS(null,"stop-color",B[1]),Y.append(g)}return this.defs.append(Y),`url(#${o})`;case"Mesh":return(0,r.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${a[0]}`)}}setDash(a,o){this.current.dashArray=a,this.current.dashPhase=o}constructPath(a,o){const w=this.current;let Y=w.x,B=w.y,g=[],P=0;for(const q of a)switch(q|0){case r.OPS.rectangle:Y=o[P++],B=o[P++];const Q=o[P++],$=o[P++],et=Y+Q,_t=B+$;g.push("M",S(Y),S(B),"L",S(et),S(B),"L",S(et),S(_t),"L",S(Y),S(_t),"Z");break;case r.OPS.moveTo:Y=o[P++],B=o[P++],g.push("M",S(Y),S(B));break;case r.OPS.lineTo:Y=o[P++],B=o[P++],g.push("L",S(Y),S(B));break;case r.OPS.curveTo:Y=o[P+4],B=o[P+5],g.push("C",S(o[P]),S(o[P+1]),S(o[P+2]),S(o[P+3]),S(Y),S(B)),P+=6;break;case r.OPS.curveTo2:g.push("C",S(Y),S(B),S(o[P]),S(o[P+1]),S(o[P+2]),S(o[P+3])),Y=o[P+2],B=o[P+3],P+=4;break;case r.OPS.curveTo3:Y=o[P+2],B=o[P+3],g.push("C",S(o[P]),S(o[P+1]),S(Y),S(B),S(Y),S(B)),P+=4;break;case r.OPS.closePath:g.push("Z");break}g=g.join(" "),w.path&&a.length>0&&a[0]!==r.OPS.rectangle&&a[0]!==r.OPS.moveTo?g=w.path.getAttributeNS(null,"d")+g:(w.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(w.path)),w.path.setAttributeNS(null,"d",g),w.path.setAttributeNS(null,"fill","none"),w.element=w.path,w.setCurrentPoint(Y,B)}endPath(){const a=this.current;if(a.path=null,!this.pendingClip)return;if(!a.element){this.pendingClip=null;return}const o=`clippath${d++}`,w=this.svgFactory.createElement("svg:clipPath");w.setAttributeNS(null,"id",o),w.setAttributeNS(null,"transform",u(this.transformMatrix));const Y=a.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Y.setAttributeNS(null,"clip-rule","evenodd"):Y.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,w.append(Y),this.defs.append(w),a.activeClipUrl){a.clipGroup=null;for(const B of this.extraStack)B.clipGroup=null;w.setAttributeNS(null,"clip-path",a.activeClipUrl)}a.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(a){this.pendingClip=a}closePath(){const a=this.current;if(a.path){const o=`${a.path.getAttributeNS(null,"d")}Z`;a.path.setAttributeNS(null,"d",o)}}setLeading(a){this.current.leading=-a}setTextRise(a){this.current.textRise=a}setTextRenderingMode(a){this.current.textRenderingMode=a}setHScale(a){this.current.textHScale=a/100}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(const[o,w]of a)switch(o){case"LW":this.setLineWidth(w);break;case"LC":this.setLineCap(w);break;case"LJ":this.setLineJoin(w);break;case"ML":this.setMiterLimit(w);break;case"D":this.setDash(w[0],w[1]);break;case"RI":this.setRenderingIntent(w);break;case"FL":this.setFlatness(w);break;case"Font":this.setFont(w);break;case"CA":this.setStrokeAlpha(w);break;case"ca":this.setFillAlpha(w);break;default:(0,r.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const a=this.current;a.element&&(a.element.setAttributeNS(null,"fill",a.fillColor),a.element.setAttributeNS(null,"fill-opacity",a.fillAlpha),this.endPath())}stroke(){const a=this.current;a.element&&(this._setStrokeAttributes(a.element),a.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const w=this.current;let Y=w.dashArray;o!==1&&Y.length>0&&(Y=Y.map(function(B){return o*B})),a.setAttributeNS(null,"stroke",w.strokeColor),a.setAttributeNS(null,"stroke-opacity",w.strokeAlpha),a.setAttributeNS(null,"stroke-miterlimit",S(w.miterLimit)),a.setAttributeNS(null,"stroke-linecap",w.lineCap),a.setAttributeNS(null,"stroke-linejoin",w.lineJoin),a.setAttributeNS(null,"stroke-width",S(o*w.lineWidth)+"px"),a.setAttributeNS(null,"stroke-dasharray",Y.map(S).join(" ")),a.setAttributeNS(null,"stroke-dashoffset",S(o*w.dashPhase)+"px")}eoFill(){var a;(a=this.current.element)===null||a===void 0||a.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var a;(a=this.current.element)===null||a===void 0||a.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width","1px"),a.setAttributeNS(null,"height","1px"),a.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(a)}paintImageXObject(a){const o=this.getObject(a);if(!o){(0,r.warn)(`Dependent image with object ID ${a} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(a,o){const w=a.width,Y=a.height,B=M(a,this.forceDataSchema,!!o),g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y","0"),g.setAttributeNS(null,"width",S(w)),g.setAttributeNS(null,"height",S(Y)),this.current.element=g,this.clip("nonzero");const P=this.svgFactory.createElement("svg:image");P.setAttributeNS(V,"xlink:href",B),P.setAttributeNS(null,"x","0"),P.setAttributeNS(null,"y",S(-Y)),P.setAttributeNS(null,"width",S(w)+"px"),P.setAttributeNS(null,"height",S(Y)+"px"),P.setAttributeNS(null,"transform",`scale(${S(1/w)} ${S(-1/Y)})`),o?o.append(P):this._ensureTransformGroup().append(P)}paintImageMaskXObject(a){const o=this.getObject(a.data,a);if(o.bitmap){(0,r.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const w=this.current,Y=o.width,B=o.height,g=w.fillColor;w.maskId=`mask${n++}`;const P=this.svgFactory.createElement("svg:mask");P.setAttributeNS(null,"id",w.maskId);const q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x","0"),q.setAttributeNS(null,"y","0"),q.setAttributeNS(null,"width",S(Y)),q.setAttributeNS(null,"height",S(B)),q.setAttributeNS(null,"fill",g),q.setAttributeNS(null,"mask",`url(#${w.maskId})`),this.defs.append(P),this._ensureTransformGroup().append(q),this.paintInlineImageXObject(o,P)}paintFormXObjectBegin(a,o){if(Array.isArray(a)&&a.length===6&&this.transform(a[0],a[1],a[2],a[3],a[4],a[5]),o){const w=o[2]-o[0],Y=o[3]-o[1],B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x",o[0]),B.setAttributeNS(null,"y",o[1]),B.setAttributeNS(null,"width",S(w)),B.setAttributeNS(null,"height",S(Y)),this.current.element=B,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(a){const o=this.svgFactory.create(a.width,a.height),w=this.svgFactory.createElement("svg:defs");o.append(w),this.defs=w;const Y=this.svgFactory.createElement("svg:g");return Y.setAttributeNS(null,"transform",u(a.transform)),o.append(Y),this.svg=Y,o}_ensureClipGroup(){if(!this.current.clipGroup){const a=this.svgFactory.createElement("svg:g");a.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(a),this.current.clipGroup=a}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",u(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}t.SVGGraphics=F},(T,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class _{static textContent(r){const R=[],L={items:R,styles:Object.create(null)};function V(D){var f;if(!D)return;let A=null;const M=D.name;if(M==="#text")A=D.value;else if(_.shouldBuildText(M))D!=null&&(f=D.attributes)!==null&&f!==void 0&&f.textContent?A=D.attributes.textContent:D.value&&(A=D.value);else return;if(A!==null&&R.push({str:A}),!!D.children)for(const p of D.children)V(p)}return V(r),L}static shouldBuildText(r){return!(r==="textarea"||r==="input"||r==="option"||r==="select")}}t.XfaText=_},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=u,t.updateTextLayer=d;var e=_(1),r=_(6);const R=1e5,L=30,V=.8,D=new Map;function f(n,l){let F;if(l&&e.FeatureTest.isOffscreenCanvasSupported)F=new OffscreenCanvas(n,n).getContext("2d",{alpha:!1});else{const y=document.createElement("canvas");y.width=y.height=n,F=y.getContext("2d",{alpha:!1})}return F}function A(n,l){const F=D.get(n);if(F)return F;const y=f(L,l);y.font=`${L}px ${n}`;const a=y.measureText("");let o=a.fontBoundingBoxAscent,w=Math.abs(a.fontBoundingBoxDescent);if(o){const B=o/(o+w);return D.set(n,B),y.canvas.width=y.canvas.height=0,B}y.strokeStyle="red",y.clearRect(0,0,L,L),y.strokeText("g",0,0);let Y=y.getImageData(0,0,L,L).data;w=0;for(let B=Y.length-1-3;B>=0;B-=4)if(Y[B]>0){w=Math.ceil(B/4/L);break}y.clearRect(0,0,L,L),y.strokeText("A",0,L),Y=y.getImageData(0,0,L,L).data,o=0;for(let B=0,g=Y.length;B<g;B+=4)if(Y[B]>0){o=L-Math.floor(B/4/L);break}if(y.canvas.width=y.canvas.height=0,o){const B=o/(o+w);return D.set(n,B),B}return D.set(n,V),V}function M(n,l,F){const y=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:l.str!=="",hasEOL:l.hasEOL,fontSize:0};n._textDivs.push(y);const o=e.Util.transform(n._transform,l.transform);let w=Math.atan2(o[1],o[0]);const Y=F[l.fontName];Y.vertical&&(w+=Math.PI/2);const B=Math.hypot(o[2],o[3]),g=B*A(Y.fontFamily,n._isOffscreenCanvasSupported);let P,q;w===0?(P=o[4],q=o[5]-g):(P=o[4]+g*Math.sin(w),q=o[5]-g*Math.cos(w));const Q="calc(var(--scale-factor)*",$=y.style;n._container===n._rootContainer?($.left=`${(100*P/n._pageWidth).toFixed(2)}%`,$.top=`${(100*q/n._pageHeight).toFixed(2)}%`):($.left=`${Q}${P.toFixed(2)}px)`,$.top=`${Q}${q.toFixed(2)}px)`),$.fontSize=`${Q}${B.toFixed(2)}px)`,$.fontFamily=Y.fontFamily,a.fontSize=B,y.setAttribute("role","presentation"),y.textContent=l.str,y.dir=l.dir,n._fontInspectorEnabled&&(y.dataset.fontName=l.fontName),w!==0&&(a.angle=w*(180/Math.PI));let et=!1;if(l.str.length>1)et=!0;else if(l.str!==" "&&l.transform[0]!==l.transform[3]){const _t=Math.abs(l.transform[0]),X=Math.abs(l.transform[3]);_t!==X&&Math.max(_t,X)/Math.min(_t,X)>1.5&&(et=!0)}et&&(a.canvasWidth=Y.vertical?l.height:l.width),n._textDivProperties.set(y,a),n._isReadableStream&&n._layoutText(y)}function p(n){const{div:l,scale:F,properties:y,ctx:a,prevFontSize:o,prevFontFamily:w}=n,{style:Y}=l;let B="";if(y.canvasWidth!==0&&y.hasText){const{fontFamily:g}=Y,{canvasWidth:P,fontSize:q}=y;(o!==q||w!==g)&&(a.font=`${q*F}px ${g}`,n.prevFontSize=q,n.prevFontFamily=g);const{width:Q}=a.measureText(l.textContent);Q>0&&(B=`scaleX(${P*F/Q})`)}y.angle!==0&&(B=`rotate(${y.angle}deg) ${B}`),B.length>0&&(Y.transform=B)}function m(n){if(n._canceled)return;const l=n._textDivs,F=n._capability;if(l.length>R){F.resolve();return}if(!n._isReadableStream)for(const a of l)n._layoutText(a);F.resolve()}class S{constructor(l){var F;let{textContentSource:y,container:a,viewport:o,textDivs:w,textDivProperties:Y,textContentItemsStr:B,isOffscreenCanvasSupported:g}=l;this._textContentSource=y,this._isReadableStream=y instanceof ReadableStream,this._container=this._rootContainer=a,this._textDivs=w||[],this._textContentItemsStr=B||[],this._isOffscreenCanvasSupported=g,this._fontInspectorEnabled=!!((F=globalThis.FontInspector)!==null&&F!==void 0&&F.enabled),this._reader=null,this._textDivProperties=Y||new WeakMap,this._canceled=!1,this._capability=new e.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:o.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f(0,g)};const{pageWidth:P,pageHeight:q,pageX:Q,pageY:$}=o.rawDims;this._transform=[1,0,0,-1,-Q,$+q],this._pageWidth=P,this._pageHeight=q,(0,r.setLayerDimensions)(a,o),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new e.AbortException("TextLayer task cancelled."))}_processItems(l,F){for(const y of l){if(y.str===void 0){if(y.type==="beginMarkedContentProps"||y.type==="beginMarkedContent"){const a=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),y.id!==null&&this._container.setAttribute("id",`${y.id}`),a.append(this._container)}else y.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(y.str),M(this,y,F)}}_layoutText(l){const F=this._layoutTextParams.properties=this._textDivProperties.get(l);if(this._layoutTextParams.div=l,p(this._layoutTextParams),F.hasText&&this._container.append(l),F.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(){const l=new e.PromiseCapability;let F=Object.create(null);if(this._isReadableStream){const y=()=>{this._reader.read().then(a=>{let{value:o,done:w}=a;if(w){l.resolve();return}Object.assign(F,o.styles),this._processItems(o.items,F),y()},l.reject)};this._reader=this._textContentSource.getReader(),y()}else if(this._textContentSource){const{items:y,styles:a}=this._textContentSource;this._processItems(y,a),l.resolve()}else throw new Error('No "textContentSource" parameter specified.');l.promise.then(()=>{F=null,m(this)},this._capability.reject)}}t.TextLayerRenderTask=S;function u(n){!n.textContentSource&&(n.textContent||n.textContentStream)&&((0,r.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),n.textContentSource=n.textContent||n.textContentStream);const{container:l,viewport:F}=n,y=getComputedStyle(l),a=y.getPropertyValue("visibility"),o=parseFloat(y.getPropertyValue("--scale-factor"));a==="visible"&&(!o||Math.abs(o-F.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const w=new S(n);return w._render(),w}function d(n){let{container:l,viewport:F,textDivs:y,textDivProperties:a,isOffscreenCanvasSupported:o,mustRotate:w=!0,mustRescale:Y=!0}=n;if(w&&(0,r.setLayerDimensions)(l,{rotation:F.rotation}),Y){const B=f(0,o),P={prevFontSize:null,prevFontFamily:null,div:null,scale:F.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:B};for(const q of y)P.properties=a.get(q),P.div=q,p(P)}}},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var e=_(1),r=_(4),R=_(28),L=_(33),V=_(6),D=_(34),f=new WeakMap,A=new WeakMap,M=new WeakMap,p=new WeakMap,m=new WeakMap,S=new WeakMap,u=new WeakMap,d=new WeakMap,n=new WeakMap,l=new WeakMap,F=new WeakSet;class y{constructor(g){let{uiManager:P,pageIndex:q,div:Q,accessibilityManager:$,annotationLayer:et,viewport:_t,l10n:X}=g;_classPrivateMethodInitSpec(this,F),_classPrivateFieldInitSpec(this,f,void 0),_classPrivateFieldInitSpec(this,A,!1),_classPrivateFieldInitSpec(this,M,null),_classPrivateFieldInitSpec(this,p,this.pointerup.bind(this)),_classPrivateFieldInitSpec(this,m,this.pointerdown.bind(this)),_classPrivateFieldInitSpec(this,S,new Map),_classPrivateFieldInitSpec(this,u,!1),_classPrivateFieldInitSpec(this,d,!1),_classPrivateFieldInitSpec(this,n,!1),_classPrivateFieldInitSpec(this,l,void 0);const b=[R.FreeTextEditor,L.InkEditor,D.StampEditor];if(!y._initialized){y._initialized=!0;for(const N of b)N.initialize(X)}P.registerEditorTypes(b),_classPrivateFieldSet(l,this,P),this.pageIndex=q,this.div=Q,_classPrivateFieldSet(f,this,$),_classPrivateFieldSet(M,this,et),this.viewport=_t,_classPrivateFieldGet(l,this).addLayer(this)}get isEmpty(){return _classPrivateFieldGet(S,this).size===0}updateToolbar(g){_classPrivateFieldGet(l,this).updateToolbar(g)}updateMode(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_classPrivateFieldGet(l,this).getMode();_assertClassBrand(F,this,Y).call(this),g===e.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),g!==e.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",g===e.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",g===e.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",g===e.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(g){if(!g&&_classPrivateFieldGet(l,this).getMode()!==e.AnnotationEditorType.INK)return;if(!g){for(const q of _classPrivateFieldGet(S,this).values())if(q.isEmpty()){q.setInBackground();return}}_assertClassBrand(F,this,o).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(g){_classPrivateFieldGet(l,this).setEditingState(g)}addCommands(g){_classPrivateFieldGet(l,this).addCommands(g)}enable(){this.div.style.pointerEvents="auto";const g=new Set;for(const q of _classPrivateFieldGet(S,this).values())q.enableEditing(),q.annotationElementId&&g.add(q.annotationElementId);if(!_classPrivateFieldGet(M,this))return;const P=_classPrivateFieldGet(M,this).getEditableAnnotations();for(const q of P){if(q.hide(),_classPrivateFieldGet(l,this).isDeletedAnnotationElement(q.data.id)||g.has(q.data.id))continue;const Q=this.deserialize(q);Q&&(this.addOrRebuild(Q),Q.enableEditing())}}disable(){_classPrivateFieldSet(n,this,!0),this.div.style.pointerEvents="none";const g=new Set;for(const q of _classPrivateFieldGet(S,this).values()){var P;if(q.disableEditing(),!q.annotationElementId||q.serialize()!==null){g.add(q.annotationElementId);continue}(P=this.getEditableAnnotation(q.annotationElementId))===null||P===void 0||P.show(),q.remove()}if(_classPrivateFieldGet(M,this)){const q=_classPrivateFieldGet(M,this).getEditableAnnotations();for(const Q of q){const{id:$}=Q.data;g.has($)||_classPrivateFieldGet(l,this).isDeletedAnnotationElement($)||Q.show()}}_assertClassBrand(F,this,Y).call(this),this.isEmpty&&(this.div.hidden=!0),_classPrivateFieldSet(n,this,!1)}getEditableAnnotation(g){var P;return((P=_classPrivateFieldGet(M,this))===null||P===void 0?void 0:P.getEditableAnnotation(g))||null}setActiveEditor(g){_classPrivateFieldGet(l,this).getActive()!==g&&_classPrivateFieldGet(l,this).setActiveEditor(g)}enableClick(){this.div.addEventListener("pointerdown",_classPrivateFieldGet(m,this)),this.div.addEventListener("pointerup",_classPrivateFieldGet(p,this))}disableClick(){this.div.removeEventListener("pointerdown",_classPrivateFieldGet(m,this)),this.div.removeEventListener("pointerup",_classPrivateFieldGet(p,this))}attach(g){_classPrivateFieldGet(S,this).set(g.id,g);const{annotationElementId:P}=g;P&&_classPrivateFieldGet(l,this).isDeletedAnnotationElement(P)&&_classPrivateFieldGet(l,this).removeDeletedAnnotationElement(g)}detach(g){var P;_classPrivateFieldGet(S,this).delete(g.id),(P=_classPrivateFieldGet(f,this))===null||P===void 0||P.removePointerInTextLayer(g.contentDiv),!_classPrivateFieldGet(n,this)&&g.annotationElementId&&_classPrivateFieldGet(l,this).addDeletedAnnotationElement(g)}remove(g){this.detach(g),_classPrivateFieldGet(l,this).removeEditor(g),g.div.contains(document.activeElement)&&setTimeout(()=>{_classPrivateFieldGet(l,this).focusMainContainer()},0),g.div.remove(),g.isAttachedToDOM=!1,_classPrivateFieldGet(d,this)||this.addInkEditorIfNeeded(!1)}changeParent(g){var P;g.parent!==this&&(g.annotationElementId&&(_classPrivateFieldGet(l,this).addDeletedAnnotationElement(g.annotationElementId),r.AnnotationEditor.deleteAnnotationElement(g),g.annotationElementId=null),this.attach(g),(P=g.parent)===null||P===void 0||P.detach(g),g.setParent(this),g.div&&g.isAttachedToDOM&&(g.div.remove(),this.div.append(g.div)))}add(g){if(this.changeParent(g),_classPrivateFieldGet(l,this).addEditor(g),this.attach(g),!g.isAttachedToDOM){const P=g.render();this.div.append(P),g.isAttachedToDOM=!0}g.fixAndSetPosition(),g.onceAdded(),_classPrivateFieldGet(l,this).addToAnnotationStorage(g)}moveEditorInDOM(g){var P;if(!g.isAttachedToDOM)return;const{activeElement:q}=document;g.div.contains(q)&&(g._focusEventsAllowed=!1,setTimeout(()=>{g.div.contains(document.activeElement)?g._focusEventsAllowed=!0:(g.div.addEventListener("focusin",()=>{g._focusEventsAllowed=!0},{once:!0}),q.focus())},0)),g._structTreeParentId=(P=_classPrivateFieldGet(f,this))===null||P===void 0?void 0:P.moveElementInDOM(this.div,g.div,g.contentDiv,!0)}addOrRebuild(g){g.needsToBeRebuilt()?g.rebuild():this.add(g)}addUndoableEditor(g){const P=()=>g._uiManager.rebuild(g),q=()=>{g.remove()};this.addCommands({cmd:P,undo:q,mustExec:!1})}getNextId(){return _classPrivateFieldGet(l,this).getId()}pasteEditor(g,P){_classPrivateFieldGet(l,this).updateToolbar(g),_classPrivateFieldGet(l,this).updateMode(g);const{offsetX:q,offsetY:Q}=_assertClassBrand(F,this,w).call(this),$=this.getNextId(),et=_assertClassBrand(F,this,a).call(this,{parent:this,id:$,x:q,y:Q,uiManager:_classPrivateFieldGet(l,this),isCentered:!0,...P});et&&this.add(et)}deserialize(g){var P;switch((P=g.annotationType)!==null&&P!==void 0?P:g.annotationEditorType){case e.AnnotationEditorType.FREETEXT:return R.FreeTextEditor.deserialize(g,this,_classPrivateFieldGet(l,this));case e.AnnotationEditorType.INK:return L.InkEditor.deserialize(g,this,_classPrivateFieldGet(l,this));case e.AnnotationEditorType.STAMP:return D.StampEditor.deserialize(g,this,_classPrivateFieldGet(l,this))}return null}addNewEditor(){_assertClassBrand(F,this,o).call(this,_assertClassBrand(F,this,w).call(this),!0)}setSelected(g){_classPrivateFieldGet(l,this).setSelected(g)}toggleSelected(g){_classPrivateFieldGet(l,this).toggleSelected(g)}isSelected(g){return _classPrivateFieldGet(l,this).isSelected(g)}unselect(g){_classPrivateFieldGet(l,this).unselect(g)}pointerup(g){const{isMac:P}=e.FeatureTest.platform;if(!(g.button!==0||g.ctrlKey&&P)&&g.target===this.div&&_classPrivateFieldGet(u,this)){if(_classPrivateFieldSet(u,this,!1),!_classPrivateFieldGet(A,this)){_classPrivateFieldSet(A,this,!0);return}if(_classPrivateFieldGet(l,this).getMode()===e.AnnotationEditorType.STAMP){_classPrivateFieldGet(l,this).unselectAll();return}_assertClassBrand(F,this,o).call(this,g,!1)}}pointerdown(g){if(_classPrivateFieldGet(u,this)){_classPrivateFieldSet(u,this,!1);return}const{isMac:P}=e.FeatureTest.platform;if(g.button!==0||g.ctrlKey&&P||g.target!==this.div)return;_classPrivateFieldSet(u,this,!0);const q=_classPrivateFieldGet(l,this).getActive();_classPrivateFieldSet(A,this,!q||q.isEmpty())}findNewParent(g,P,q){const Q=_classPrivateFieldGet(l,this).findParent(P,q);return Q===null||Q===this?!1:(Q.changeParent(g),!0)}destroy(){var g;((g=_classPrivateFieldGet(l,this).getActive())===null||g===void 0?void 0:g.parent)===this&&(_classPrivateFieldGet(l,this).commitOrRemove(),_classPrivateFieldGet(l,this).setActiveEditor(null));for(const q of _classPrivateFieldGet(S,this).values()){var P;(P=_classPrivateFieldGet(f,this))===null||P===void 0||P.removePointerInTextLayer(q.contentDiv),q.setParent(null),q.isAttachedToDOM=!1,q.div.remove()}this.div=null,_classPrivateFieldGet(S,this).clear(),_classPrivateFieldGet(l,this).removeLayer(this)}render(g){let{viewport:P}=g;this.viewport=P,(0,V.setLayerDimensions)(this.div,P);for(const q of _classPrivateFieldGet(l,this).getEditors(this.pageIndex))this.add(q);this.updateMode()}update(g){let{viewport:P}=g;_classPrivateFieldGet(l,this).commitOrRemove(),this.viewport=P,(0,V.setLayerDimensions)(this.div,{rotation:P.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:g,pageHeight:P}=this.viewport.rawDims;return[g,P]}}function a(B){switch(_classPrivateFieldGet(l,this).getMode()){case e.AnnotationEditorType.FREETEXT:return new R.FreeTextEditor(B);case e.AnnotationEditorType.INK:return new L.InkEditor(B);case e.AnnotationEditorType.STAMP:return new D.StampEditor(B)}return null}function o(B,g){const P=this.getNextId(),q=_assertClassBrand(F,this,a).call(this,{parent:this,id:P,x:B.offsetX,y:B.offsetY,uiManager:_classPrivateFieldGet(l,this),isCentered:g});return q&&this.add(q),q}function w(){const{x:B,y:g,width:P,height:q}=this.div.getBoundingClientRect(),Q=Math.max(0,B),$=Math.max(0,g),et=Math.min(window.innerWidth,B+P),_t=Math.min(window.innerHeight,g+q),X=(Q+et)/2-B,b=($+_t)/2-g,[N,rt]=this.viewport.rotation%180===0?[X,b]:[b,X];return{offsetX:N,offsetY:rt}}function Y(){_classPrivateFieldSet(d,this,!0);for(const B of _classPrivateFieldGet(S,this).values())B.isEmpty()&&B.remove();_classPrivateFieldSet(d,this,!1)}_defineProperty(y,"_initialized",!1),t.AnnotationEditorLayer=y},(T,t,_)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var r=_(1),R=_(5),L=_(4),V=_(29),D=new WeakMap,f=new WeakMap,A=new WeakMap,M=new WeakMap,p=new WeakMap,m=new WeakMap,S=new WeakMap,u=new WeakMap,d=new WeakMap,n=new WeakSet;class l extends L.AnnotationEditor{static get _keyboardManager(){const P=l.prototype,q=et=>et.isEmpty(),Q=R.AnnotationEditorUIManager.TRANSLATE_SMALL,$=R.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new R.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],P.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],P.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],P._translateEmpty,{args:[-Q,0],checker:q}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],P._translateEmpty,{args:[-$,0],checker:q}],[["ArrowRight","mac+ArrowRight"],P._translateEmpty,{args:[Q,0],checker:q}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],P._translateEmpty,{args:[$,0],checker:q}],[["ArrowUp","mac+ArrowUp"],P._translateEmpty,{args:[0,-Q],checker:q}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],P._translateEmpty,{args:[0,-$],checker:q}],[["ArrowDown","mac+ArrowDown"],P._translateEmpty,{args:[0,Q],checker:q}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],P._translateEmpty,{args:[0,$],checker:q}]]))}constructor(P){super({...P,name:"freeTextEditor"}),_classPrivateMethodInitSpec(this,n),_classPrivateFieldInitSpec(this,D,this.editorDivBlur.bind(this)),_classPrivateFieldInitSpec(this,f,this.editorDivFocus.bind(this)),_classPrivateFieldInitSpec(this,A,this.editorDivInput.bind(this)),_classPrivateFieldInitSpec(this,M,this.editorDivKeydown.bind(this)),_classPrivateFieldInitSpec(this,p,void 0),_classPrivateFieldInitSpec(this,m,""),_classPrivateFieldInitSpec(this,S,`${this.id}-editor`),_classPrivateFieldInitSpec(this,u,void 0),_classPrivateFieldInitSpec(this,d,null),_classPrivateFieldSet(p,this,P.color||l._defaultColor||L.AnnotationEditor._defaultLineColor),_classPrivateFieldSet(u,this,P.fontSize||l._defaultFontSize)}static initialize(P){L.AnnotationEditor.initialize(P,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const q=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(q.getPropertyValue("--freetext-padding"))}static updateDefaultParams(P,q){switch(P){case r.AnnotationEditorParamsType.FREETEXT_SIZE:l._defaultFontSize=q;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:l._defaultColor=q;break}}updateParams(P,q){switch(P){case r.AnnotationEditorParamsType.FREETEXT_SIZE:_assertClassBrand(n,this,F).call(this,q);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:_assertClassBrand(n,this,y).call(this,q);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,l._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,l._defaultColor||L.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,_classPrivateFieldGet(u,this)],[r.AnnotationEditorParamsType.FREETEXT_COLOR,_classPrivateFieldGet(p,this)]]}_translateEmpty(P,q){this._uiManager.translateSelectedEditors(P,q,!0)}getInitialTranslation(){const P=this.parentScale;return[-l._internalPadding*P,-(l._internalPadding+_classPrivateFieldGet(u,this))*P]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",_classPrivateFieldGet(M,this)),this.editorDiv.addEventListener("focus",_classPrivateFieldGet(f,this)),this.editorDiv.addEventListener("blur",_classPrivateFieldGet(D,this)),this.editorDiv.addEventListener("input",_classPrivateFieldGet(A,this)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",_classPrivateFieldGet(S,this)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",_classPrivateFieldGet(M,this)),this.editorDiv.removeEventListener("focus",_classPrivateFieldGet(f,this)),this.editorDiv.removeEventListener("blur",_classPrivateFieldGet(D,this)),this.editorDiv.removeEventListener("input",_classPrivateFieldGet(A,this)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(P){this._focusEventsAllowed&&(super.focusin(P),P.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var P;if(this.width){_assertClassBrand(n,this,B).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(P=this._initialOptions)!==null&&P!==void 0&&P.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const P=_classPrivateFieldGet(m,this),q=_classPrivateFieldSet(m,this,_assertClassBrand(n,this,a).call(this).trimEnd());if(P===q)return;const Q=$=>{if(_classPrivateFieldSet(m,this,$),!$){this.remove();return}_assertClassBrand(n,this,w).call(this),this._uiManager.rebuild(this),_assertClassBrand(n,this,o).call(this)};this.addCommands({cmd:()=>{Q(q)},undo:()=>{Q(P)},mustExec:!1}),_assertClassBrand(n,this,o).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(P){this.enterInEditMode()}keydown(P){P.target===this.div&&P.key==="Enter"&&(this.enterInEditMode(),P.preventDefault())}editorDivKeydown(P){l._keyboardManager.exec(this,P)}editorDivFocus(P){this.isEditing=!0}editorDivBlur(P){this.isEditing=!1}editorDivInput(P){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let P,q;this.width&&(P=this.x,q=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",_classPrivateFieldGet(S,this)),this.enableEditing(),L.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then($=>{var et;return(et=this.editorDiv)===null||et===void 0?void 0:et.setAttribute("aria-label",$)}),L.AnnotationEditor._l10nPromise.get("free_text2_default_content").then($=>{var et;return(et=this.editorDiv)===null||et===void 0?void 0:et.setAttribute("default-content",$)}),this.editorDiv.contentEditable=!0;const{style:Q}=this.editorDiv;if(Q.fontSize=`calc(${_classPrivateFieldGet(u,this)}px * var(--scale-factor))`,Q.color=_classPrivateFieldGet(p,this),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,R.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[$,et]=this.parentDimensions;if(this.annotationElementId){const{position:_t}=_classPrivateFieldGet(d,this);let[X,b]=this.getInitialTranslation();[X,b]=this.pageTranslationToScreen(X,b);const[N,rt]=this.pageDimensions,[v,s]=this.pageTranslation;let i,h;switch(this.rotation){case 0:i=P+(_t[0]-v)/N,h=q+this.height-(_t[1]-s)/rt;break;case 90:i=P+(_t[0]-v)/N,h=q-(_t[1]-s)/rt,[X,b]=[b,-X];break;case 180:i=P-this.width+(_t[0]-v)/N,h=q-(_t[1]-s)/rt,[X,b]=[-X,-b];break;case 270:i=P+(_t[0]-v-this.height*rt)/N,h=q+(_t[1]-s-this.width*N)/rt,[X,b]=[-b,X];break}this.setAt(i*$,h*et,X,b)}else this.setAt(P*$,q*et,this.width*$,this.height*et);_assertClassBrand(n,this,w).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(P,q,Q){let $=null;if(P instanceof V.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:_t,fontColor:X},rect:b,rotation:N,id:rt},textContent:v,textPosition:s,parent:{page:{pageNumber:i}}}=P;if(!v||v.length===0)return null;$=P={annotationType:r.AnnotationEditorType.FREETEXT,color:Array.from(X),fontSize:_t,value:v.join(`
`),position:s,pageIndex:i-1,rect:b,rotation:N,id:rt,deleted:!1}}const et=super.deserialize(P,q,Q);return _classPrivateFieldSet(u,et,P.fontSize),_classPrivateFieldSet(p,et,r.Util.makeHexColor(...P.color)),_classPrivateFieldSet(m,et,P.value),et.annotationElementId=P.id||null,_classPrivateFieldSet(d,et,$),et}serialize(){let P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const q=l._internalPadding*this.parentScale,Q=this.getRect(q,q),$=L.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:_classPrivateFieldGet(p,this)),et={annotationType:r.AnnotationEditorType.FREETEXT,color:$,fontSize:_classPrivateFieldGet(u,this),value:_classPrivateFieldGet(m,this),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return P?et:this.annotationElementId&&!_assertClassBrand(n,this,Y).call(this,et)?null:(et.id=this.annotationElementId,et)}}e=l;function F(g){const P=Q=>{this.editorDiv.style.fontSize=`calc(${Q}px * var(--scale-factor))`,this.translate(0,-(Q-_classPrivateFieldGet(u,this))*this.parentScale),_classPrivateFieldSet(u,this,Q),_assertClassBrand(n,this,o).call(this)},q=_classPrivateFieldGet(u,this);this.addCommands({cmd:()=>{P(g)},undo:()=>{P(q)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function y(g){const P=_classPrivateFieldGet(p,this);this.addCommands({cmd:()=>{_classPrivateFieldSet(p,this,this.editorDiv.style.color=g)},undo:()=>{_classPrivateFieldSet(p,this,this.editorDiv.style.color=P)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function a(){const g=this.editorDiv.getElementsByTagName("div");if(g.length===0)return this.editorDiv.innerText;const P=[];for(const q of g)P.push(q.innerText.replace(/\r\n?|\n/,""));return P.join(`
`)}function o(){const[g,P]=this.parentDimensions;let q;if(this.isAttachedToDOM)q=this.div.getBoundingClientRect();else{const{currentLayer:Q,div:$}=this,et=$.style.display;$.style.display="hidden",Q.div.append(this.div),q=$.getBoundingClientRect(),$.remove(),$.style.display=et}this.rotation%180===this.parentRotation%180?(this.width=q.width/g,this.height=q.height/P):(this.width=q.height/g,this.height=q.width/P),this.fixAndSetPosition()}function w(){if(this.editorDiv.replaceChildren(),!!_classPrivateFieldGet(m,this))for(const g of _classPrivateFieldGet(m,this).split(`
`)){const P=document.createElement("div");P.append(g?document.createTextNode(g):document.createElement("br")),this.editorDiv.append(P)}}function Y(g){const{value:P,fontSize:q,color:Q,rect:$,pageIndex:et}=_classPrivateFieldGet(d,this);return g.value!==P||g.fontSize!==q||g.rect.some((_t,X)=>Math.abs(_t-$[X])>=1)||g.color.some((_t,X)=>_t!==Q[X])||g.pageIndex!==et}function B(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.annotationElementId)return;if(_assertClassBrand(n,this,o).call(this),!g&&(this.width===0||this.height===0)){setTimeout(()=>_assertClassBrand(n,this,B).call(this,!0),0);return}const P=e._internalPadding*this.parentScale;_classPrivateFieldGet(d,this).rect=this.getRect(P,P)}_defineProperty(l,"_freeTextDefaultContent",""),_defineProperty(l,"_internalPadding",0),_defineProperty(l,"_defaultColor",null),_defineProperty(l,"_defaultFontSize",10),_defineProperty(l,"_type","freetext"),t.FreeTextEditor=l},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var e=_(1),r=_(6),R=_(3),L=_(30),V=_(31),D=_(32);const f=1e3,A=9,M=new WeakSet;function p(bt){return{width:bt[2]-bt[0],height:bt[3]-bt[1]}}class m{static create(c){switch(c.data.annotationType){case e.AnnotationType.LINK:return new n(c);case e.AnnotationType.TEXT:return new y(c);case e.AnnotationType.WIDGET:switch(c.data.fieldType){case"Tx":return new o(c);case"Btn":return c.data.radioButton?new B(c):c.data.checkBox?new Y(c):new g(c);case"Ch":return new P(c);case"Sig":return new w(c)}return new a(c);case e.AnnotationType.POPUP:return new q(c);case e.AnnotationType.FREETEXT:return new k(c);case e.AnnotationType.LINE:return new O(c);case e.AnnotationType.SQUARE:return new lt(c);case e.AnnotationType.CIRCLE:return new st(c);case e.AnnotationType.POLYLINE:return new St(c);case e.AnnotationType.CARET:return new Mt(c);case e.AnnotationType.INK:return new Rt(c);case e.AnnotationType.POLYGON:return new kt(c);case e.AnnotationType.HIGHLIGHT:return new Ft(c);case e.AnnotationType.UNDERLINE:return new yt(c);case e.AnnotationType.SQUIGGLY:return new Wt(c);case e.AnnotationType.STRIKEOUT:return new Ut(c);case e.AnnotationType.STAMP:return new jt(c);case e.AnnotationType.FILEATTACHMENT:return new tt(c);default:return new u(c)}}}var S=new WeakMap;class u{constructor(c){let{isRenderable:I=!1,ignoreBorder:z=!1,createQuadrilaterals:Z=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_classPrivateFieldInitSpec(this,S,!1),this.isRenderable=I,this.data=c.data,this.layer=c.layer,this.linkService=c.linkService,this.downloadManager=c.downloadManager,this.imageResourcesPath=c.imageResourcesPath,this.renderForms=c.renderForms,this.svgFactory=c.svgFactory,this.annotationStorage=c.annotationStorage,this.enableScripting=c.enableScripting,this.hasJSActions=c.hasJSActions,this._fieldObjects=c.fieldObjects,this.parent=c.parent,I&&(this.container=this._createContainer(z)),Z&&this._createQuadrilaterals()}static _hasPopupData(c){let{titleObj:I,contentsObj:z,richText:Z}=c;return!!(I!=null&&I.str||z!=null&&z.str||Z!=null&&Z.str)}get hasPopupData(){return u._hasPopupData(this.data)}_createContainer(c){const{data:I,parent:{page:z,viewport:Z}}=this,ct=document.createElement("section");ct.setAttribute("data-annotation-id",I.id),this instanceof a||(ct.tabIndex=f),ct.style.zIndex=this.parent.zIndex++,this.data.popupRef&&ct.setAttribute("aria-haspopup","dialog"),I.noRotate&&ct.classList.add("norotate");const{pageWidth:ht,pageHeight:mt,pageX:Tt,pageY:Et}=Z.rawDims;if(!I.rect||this instanceof q){const{rotation:Ot}=I;return!I.hasOwnCanvas&&Ot!==0&&this.setRotation(Ot,ct),ct}const{width:Pt,height:Dt}=p(I.rect),Ct=e.Util.normalizeRect([I.rect[0],z.view[3]-I.rect[1]+z.view[1],I.rect[2],z.view[3]-I.rect[3]+z.view[1]]);if(!c&&I.borderStyle.width>0){ct.style.borderWidth=`${I.borderStyle.width}px`;const Ot=I.borderStyle.horizontalCornerRadius,Bt=I.borderStyle.verticalCornerRadius;if(Ot>0||Bt>0){const Ht=`calc(${Ot}px * var(--scale-factor)) / calc(${Bt}px * var(--scale-factor))`;ct.style.borderRadius=Ht}else if(this instanceof B){const Ht=`calc(${Pt}px * var(--scale-factor)) / calc(${Dt}px * var(--scale-factor))`;ct.style.borderRadius=Ht}switch(I.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:ct.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:ct.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:ct.style.borderBottomStyle="solid";break}const Nt=I.borderColor||null;Nt?(_classPrivateFieldSet(S,this,!0),ct.style.borderColor=e.Util.makeHexColor(Nt[0]|0,Nt[1]|0,Nt[2]|0)):ct.style.borderWidth=0}ct.style.left=`${100*(Ct[0]-Tt)/ht}%`,ct.style.top=`${100*(Ct[1]-Et)/mt}%`;const{rotation:wt}=I;return I.hasOwnCanvas||wt===0?(ct.style.width=`${100*Pt/ht}%`,ct.style.height=`${100*Dt/mt}%`):this.setRotation(wt,ct),ct}setRotation(c){let I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:z,pageHeight:Z}=this.parent.viewport.rawDims,{width:ct,height:ht}=p(this.data.rect);let mt,Tt;c%180===0?(mt=100*ct/z,Tt=100*ht/Z):(mt=100*ht/z,Tt=100*ct/Z),I.style.width=`${mt}%`,I.style.height=`${Tt}%`,I.setAttribute("data-main-rotation",(360-c)%360)}get _commonActions(){const c=(I,z,Z)=>{const ct=Z.detail[I],ht=ct[0],mt=ct.slice(1);Z.target.style[z]=L.ColorConverters[`${ht}_HTML`](mt),this.annotationStorage.setValue(this.data.id,{[z]:L.ColorConverters[`${ht}_rgb`](mt)})};return(0,e.shadow)(this,"_commonActions",{display:I=>{const{display:z}=I.detail,Z=z%2===1;this.container.style.visibility=Z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Z,noPrint:z===1||z===2})},print:I=>{this.annotationStorage.setValue(this.data.id,{noPrint:!I.detail.print})},hidden:I=>{const{hidden:z}=I.detail;this.container.style.visibility=z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:z,noView:z})},focus:I=>{setTimeout(()=>I.target.focus({preventScroll:!1}),0)},userName:I=>{I.target.title=I.detail.userName},readonly:I=>{I.target.disabled=I.detail.readonly},required:I=>{this._setRequired(I.target,I.detail.required)},bgColor:I=>{c("bgColor","backgroundColor",I)},fillColor:I=>{c("fillColor","backgroundColor",I)},fgColor:I=>{c("fgColor","color",I)},textColor:I=>{c("textColor","color",I)},borderColor:I=>{c("borderColor","borderColor",I)},strokeColor:I=>{c("strokeColor","borderColor",I)},rotation:I=>{const z=I.detail.rotation;this.setRotation(z),this.annotationStorage.setValue(this.data.id,{rotation:z})}})}_dispatchEventFromSandbox(c,I){const z=this._commonActions;for(const Z of Object.keys(I.detail)){const ct=c[Z]||z[Z];ct==null||ct(I)}}_setDefaultPropertiesFromJS(c){if(!this.enableScripting)return;const I=this.annotationStorage.getRawValue(this.data.id);if(!I)return;const z=this._commonActions;for(const[Z,ct]of Object.entries(I)){const ht=z[Z];if(ht){const mt={detail:{[Z]:ct},target:c};ht(mt),delete I[Z]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:c}=this.data;if(!c)return;const[I,z,Z,ct]=this.data.rect;if(c.length===1){const[,{x:Nt,y:Ht},{x:Xt,y:zt}]=c[0];if(Z===Nt&&ct===Ht&&I===Xt&&z===zt)return}const{style:ht}=this.container;let mt;if(_classPrivateFieldGet(S,this)){const{borderColor:Nt,borderWidth:Ht}=ht;ht.borderWidth=0,mt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Nt}" stroke-width="${Ht}">`],this.container.classList.add("hasBorder")}const Tt=Z-I,Et=ct-z,{svgFactory:Pt}=this,Dt=Pt.createElement("svg");Dt.classList.add("quadrilateralsContainer"),Dt.setAttribute("width",0),Dt.setAttribute("height",0);const Ct=Pt.createElement("defs");Dt.append(Ct);const wt=Pt.createElement("clipPath"),Ot=`clippath_${this.data.id}`;wt.setAttribute("id",Ot),wt.setAttribute("clipPathUnits","objectBoundingBox"),Ct.append(wt);for(const[,{x:Nt,y:Ht},{x:Xt,y:zt}]of c){var Bt;const qt=Pt.createElement("rect"),Vt=(Xt-I)/Tt,Yt=(ct-Ht)/Et,Kt=(Nt-Xt)/Tt,Jt=(Ht-zt)/Et;qt.setAttribute("x",Vt),qt.setAttribute("y",Yt),qt.setAttribute("width",Kt),qt.setAttribute("height",Jt),wt.append(qt),(Bt=mt)===null||Bt===void 0||Bt.push(`<rect vector-effect="non-scaling-stroke" x="${Vt}" y="${Yt}" width="${Kt}" height="${Jt}"/>`)}_classPrivateFieldGet(S,this)&&(mt.push("</g></svg>')"),ht.backgroundImage=mt.join("")),this.container.append(Dt),this.container.style.clipPath=`url(#${Ot})`}_createPopup(){const{container:c,data:I}=this;c.setAttribute("aria-haspopup","dialog");const z=new q({data:{color:I.color,titleObj:I.titleObj,modificationDate:I.modificationDate,contentsObj:I.contentsObj,richText:I.richText,parentRect:I.rect,borderStyle:0,id:`popup_${I.id}`,rotation:I.rotation},parent:this.parent,elements:[this]});this.parent.div.append(z.render())}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(c){let I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const z=[];if(this._fieldObjects){const Z=this._fieldObjects[c];if(Z)for(const{page:ct,id:ht,exportValues:mt}of Z){if(ct===-1||ht===I)continue;const Tt=typeof mt=="string"?mt:null,Et=document.querySelector(`[data-element-id="${ht}"]`);if(Et&&!M.has(Et)){(0,e.warn)(`_getElementsByName - element not allowed: ${ht}`);continue}z.push({id:ht,exportValue:Tt,domElement:Et})}return z}for(const Z of document.getElementsByName(c)){const{exportValue:ct}=Z,ht=Z.getAttribute("data-element-id");ht!==I&&M.has(Z)&&z.push({id:ht,exportValue:ct,domElement:Z})}return z}show(){var c;this.container&&(this.container.hidden=!1),(c=this.popup)===null||c===void 0||c.maybeShow()}hide(){var c;this.container&&(this.container.hidden=!0),(c=this.popup)===null||c===void 0||c.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const c=this.getElementsToTriggerPopup();if(Array.isArray(c))for(const I of c)I.classList.add("highlightArea");else c.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:c,data:{id:I}}=this;this.container.addEventListener("dblclick",()=>{var z;(z=this.linkService.eventBus)===null||z===void 0||z.dispatch("switchannotationeditormode",{source:this,mode:c,editId:I})})}}var d=new WeakSet;class n extends u{constructor(c){let I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;super(c,{isRenderable:!0,ignoreBorder:!!(I!=null&&I.ignoreBorder),createQuadrilaterals:!0}),_classPrivateMethodInitSpec(this,d),this.isTooltipOnly=c.data.isTooltipOnly}render(){const{data:c,linkService:I}=this,z=document.createElement("a");z.setAttribute("data-element-id",c.id);let Z=!1;return c.url?(I.addLinkAttributes(z,c.url,c.newWindow),Z=!0):c.action?(this._bindNamedAction(z,c.action),Z=!0):c.attachment?(this._bindAttachment(z,c.attachment),Z=!0):c.setOCGState?(_assertClassBrand(d,this,F).call(this,z,c.setOCGState),Z=!0):c.dest?(this._bindLink(z,c.dest),Z=!0):(c.actions&&(c.actions.Action||c.actions["Mouse Up"]||c.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(z,c),Z=!0),c.resetForm?(this._bindResetFormAction(z,c.resetForm),Z=!0):this.isTooltipOnly&&!Z&&(this._bindLink(z,""),Z=!0)),this.container.classList.add("linkAnnotation"),Z&&this.container.append(z),this.container}_bindLink(c,I){c.href=this.linkService.getDestinationHash(I),c.onclick=()=>(I&&this.linkService.goToDestination(I),!1),(I||I==="")&&_assertClassBrand(d,this,l).call(this)}_bindNamedAction(c,I){c.href=this.linkService.getAnchorUrl(""),c.onclick=()=>(this.linkService.executeNamedAction(I),!1),_assertClassBrand(d,this,l).call(this)}_bindAttachment(c,I){c.href=this.linkService.getAnchorUrl(""),c.onclick=()=>{var z;return(z=this.downloadManager)===null||z===void 0||z.openOrDownloadData(this.container,I.content,I.filename),!1},_assertClassBrand(d,this,l).call(this)}_bindJSAction(c,I){c.href=this.linkService.getAnchorUrl("");const z=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Z of Object.keys(I.actions)){const ct=z.get(Z);ct&&(c[ct]=()=>{var ht;return(ht=this.linkService.eventBus)===null||ht===void 0||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I.id,name:Z}}),!1})}c.onclick||(c.onclick=()=>!1),_assertClassBrand(d,this,l).call(this)}_bindResetFormAction(c,I){const z=c.onclick;if(z||(c.href=this.linkService.getAnchorUrl("")),_assertClassBrand(d,this,l).call(this),!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),z||(c.onclick=()=>!1);return}c.onclick=()=>{z==null||z();const{fields:Z,refs:ct,include:ht}=I,mt=[];if(Z.length!==0||ct.length!==0){const Dt=new Set(ct);for(const Ct of Z){const wt=this._fieldObjects[Ct]||[];for(const{id:Ot}of wt)Dt.add(Ot)}for(const Ct of Object.values(this._fieldObjects))for(const wt of Ct)Dt.has(wt.id)===ht&&mt.push(wt)}else for(const Dt of Object.values(this._fieldObjects))mt.push(...Dt);const Tt=this.annotationStorage,Et=[];for(const Dt of mt){const{id:Ct}=Dt;switch(Et.push(Ct),Dt.type){case"text":{const Ot=Dt.defaultValue||"";Tt.setValue(Ct,{value:Ot});break}case"checkbox":case"radiobutton":{const Ot=Dt.defaultValue===Dt.exportValues;Tt.setValue(Ct,{value:Ot});break}case"combobox":case"listbox":{const Ot=Dt.defaultValue||"";Tt.setValue(Ct,{value:Ot});break}default:continue}const wt=document.querySelector(`[data-element-id="${Ct}"]`);if(wt){if(!M.has(wt)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${Ct}`);continue}}else continue;wt.dispatchEvent(new Event("resetform"))}if(this.enableScripting){var Pt;(Pt=this.linkService.eventBus)===null||Pt===void 0||Pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Et,name:"ResetForm"}})}return!1}}}function l(){this.container.setAttribute("data-internal-link","")}function F(bt,c){bt.href=this.linkService.getAnchorUrl(""),bt.onclick=()=>(this.linkService.executeSetOCGState(c),!1),_assertClassBrand(d,this,l).call(this)}class y extends u{constructor(c){super(c,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const c=document.createElement("img");return c.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",c.alt="[{{type}} Annotation]",c.dataset.l10nId="text_annotation_type",c.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(c),this.container}}class a extends u{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(c){if(this.data.hasOwnCanvas){var I;((I=c.previousSibling)===null||I===void 0?void 0:I.nodeName)==="CANVAS"&&(c.previousSibling.hidden=!0),c.hidden=!1}}_getKeyModifier(c){const{isWin:I,isMac:z}=e.FeatureTest.platform;return I&&c.ctrlKey||z&&c.metaKey}_setEventListener(c,I,z,Z,ct){z.includes("mouse")?c.addEventListener(z,ht=>{var mt;(mt=this.linkService.eventBus)===null||mt===void 0||mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Z,value:ct(ht),shift:ht.shiftKey,modifier:this._getKeyModifier(ht)}})}):c.addEventListener(z,ht=>{var mt;if(z==="blur"){if(!I.focused||!ht.relatedTarget)return;I.focused=!1}else if(z==="focus"){if(I.focused)return;I.focused=!0}ct&&((mt=this.linkService.eventBus)===null||mt===void 0||mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Z,value:ct(ht)}}))})}_setEventListeners(c,I,z,Z){for(const[Tt,Et]of z){var ct;if(Et==="Action"||(ct=this.data.actions)!==null&&ct!==void 0&&ct[Et]){var ht,mt;(Et==="Focus"||Et==="Blur")&&(I||(I={focused:!1})),this._setEventListener(c,I,Tt,Et,Z),Et==="Focus"&&!((ht=this.data.actions)!==null&&ht!==void 0&&ht.Blur)?this._setEventListener(c,I,"blur","Blur",null):Et==="Blur"&&!((mt=this.data.actions)!==null&&mt!==void 0&&mt.Focus)&&this._setEventListener(c,I,"focus","Focus",null)}}}_setBackgroundColor(c){const I=this.data.backgroundColor||null;c.style.backgroundColor=I===null?"transparent":e.Util.makeHexColor(I[0],I[1],I[2])}_setTextStyle(c){const I=["left","center","right"],{fontColor:z}=this.data.defaultAppearanceData,Z=this.data.defaultAppearanceData.fontSize||A,ct=c.style;let ht;const mt=2,Tt=Et=>Math.round(10*Et)/10;if(this.data.multiLine){const Et=Math.abs(this.data.rect[3]-this.data.rect[1]-mt),Pt=Math.round(Et/(e.LINE_FACTOR*Z))||1,Dt=Et/Pt;ht=Math.min(Z,Tt(Dt/e.LINE_FACTOR))}else{const Et=Math.abs(this.data.rect[3]-this.data.rect[1]-mt);ht=Math.min(Z,Tt(Et/e.LINE_FACTOR))}ct.fontSize=`calc(${ht}px * var(--scale-factor))`,ct.color=e.Util.makeHexColor(z[0],z[1],z[2]),this.data.textAlignment!==null&&(ct.textAlign=I[this.data.textAlignment])}_setRequired(c,I){I?c.setAttribute("required",!0):c.removeAttribute("required"),c.setAttribute("aria-required",I)}}class o extends a{constructor(c){const I=c.renderForms||!c.data.hasAppearance&&!!c.data.fieldValue;super(c,{isRenderable:I})}setPropertyOnSiblings(c,I,z,Z){const ct=this.annotationStorage;for(const ht of this._getElementsByName(c.name,c.id))ht.domElement&&(ht.domElement[I]=z),ct.setValue(ht.id,{[Z]:z})}render(){const c=this.annotationStorage,I=this.data.id;this.container.classList.add("textWidgetAnnotation");let z=null;if(this.renderForms){var Z;const ht=c.getValue(I,{value:this.data.fieldValue});let mt=ht.value||"";const Tt=c.getValue(I,{charLimit:this.data.maxLen}).charLimit;Tt&&mt.length>Tt&&(mt=mt.slice(0,Tt));let Et=ht.formattedValue||((Z=this.data.textContent)===null||Z===void 0?void 0:Z.join(`
`))||null;Et&&this.data.comb&&(Et=Et.replaceAll(/\s+/g,""));const Pt={userValue:mt,formattedValue:Et,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(z=document.createElement("textarea"),z.textContent=Et??mt,this.data.doNotScroll&&(z.style.overflowY="hidden")):(z=document.createElement("input"),z.type="text",z.setAttribute("value",Et??mt),this.data.doNotScroll&&(z.style.overflowX="hidden")),this.data.hasOwnCanvas&&(z.hidden=!0),M.add(z),z.setAttribute("data-element-id",I),z.disabled=this.data.readOnly,z.name=this.data.fieldName,z.tabIndex=f,this._setRequired(z,this.data.required),Tt&&(z.maxLength=Tt),z.addEventListener("input",Ct=>{c.setValue(I,{value:Ct.target.value}),this.setPropertyOnSiblings(z,"value",Ct.target.value,"value"),Pt.formattedValue=null}),z.addEventListener("resetform",Ct=>{var wt;const Ot=(wt=this.data.defaultFieldValue)!==null&&wt!==void 0?wt:"";z.value=Pt.userValue=Ot,Pt.formattedValue=null});let Dt=Ct=>{const{formattedValue:wt}=Pt;wt!=null&&(Ct.target.value=wt),Ct.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var ct;z.addEventListener("focus",wt=>{if(Pt.focused)return;const{target:Ot}=wt;Pt.userValue&&(Ot.value=Pt.userValue),Pt.lastCommittedValue=Ot.value,Pt.commitKey=1,Pt.focused=!0}),z.addEventListener("updatefromsandbox",wt=>{this.showElementAndHideCanvas(wt.target);const Ot={value(Bt){var Nt;Pt.userValue=(Nt=Bt.detail.value)!==null&&Nt!==void 0?Nt:"",c.setValue(I,{value:Pt.userValue.toString()}),Bt.target.value=Pt.userValue},formattedValue(Bt){const{formattedValue:Nt}=Bt.detail;Pt.formattedValue=Nt,Nt!=null&&Bt.target!==document.activeElement&&(Bt.target.value=Nt),c.setValue(I,{formattedValue:Nt})},selRange(Bt){Bt.target.setSelectionRange(...Bt.detail.selRange)},charLimit:Bt=>{var Nt;const{charLimit:Ht}=Bt.detail,{target:Xt}=Bt;if(Ht===0){Xt.removeAttribute("maxLength");return}Xt.setAttribute("maxLength",Ht);let zt=Pt.userValue;!zt||zt.length<=Ht||(zt=zt.slice(0,Ht),Xt.value=Pt.userValue=zt,c.setValue(I,{value:zt}),(Nt=this.linkService.eventBus)===null||Nt===void 0||Nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:zt,willCommit:!0,commitKey:1,selStart:Xt.selectionStart,selEnd:Xt.selectionEnd}}))}};this._dispatchEventFromSandbox(Ot,wt)}),z.addEventListener("keydown",wt=>{var Ot;Pt.commitKey=1;let Bt=-1;if(wt.key==="Escape"?Bt=0:wt.key==="Enter"&&!this.data.multiLine?Bt=2:wt.key==="Tab"&&(Pt.commitKey=3),Bt===-1)return;const{value:Nt}=wt.target;Pt.lastCommittedValue!==Nt&&(Pt.lastCommittedValue=Nt,Pt.userValue=Nt,(Ot=this.linkService.eventBus)===null||Ot===void 0||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Nt,willCommit:!0,commitKey:Bt,selStart:wt.target.selectionStart,selEnd:wt.target.selectionEnd}}))});const Ct=Dt;Dt=null,z.addEventListener("blur",wt=>{if(!Pt.focused||!wt.relatedTarget)return;Pt.focused=!1;const{value:Ot}=wt.target;if(Pt.userValue=Ot,Pt.lastCommittedValue!==Ot){var Bt;(Bt=this.linkService.eventBus)===null||Bt===void 0||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Ot,willCommit:!0,commitKey:Pt.commitKey,selStart:wt.target.selectionStart,selEnd:wt.target.selectionEnd}})}Ct(wt)}),(ct=this.data.actions)!==null&&ct!==void 0&&ct.Keystroke&&z.addEventListener("beforeinput",wt=>{var Ot;Pt.lastCommittedValue=null;const{data:Bt,target:Nt}=wt,{value:Ht,selectionStart:Xt,selectionEnd:zt}=Nt;let qt=Xt,Vt=zt;switch(wt.inputType){case"deleteWordBackward":{const Yt=Ht.substring(0,Xt).match(/\w*[^\w]*$/);Yt&&(qt-=Yt[0].length);break}case"deleteWordForward":{const Yt=Ht.substring(Xt).match(/^[^\w]*\w*/);Yt&&(Vt+=Yt[0].length);break}case"deleteContentBackward":Xt===zt&&(qt-=1);break;case"deleteContentForward":Xt===zt&&(Vt+=1);break}wt.preventDefault(),(Ot=this.linkService.eventBus)===null||Ot===void 0||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Ht,change:Bt||"",willCommit:!1,selStart:qt,selEnd:Vt}})}),this._setEventListeners(z,Pt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],wt=>wt.target.value)}if(Dt&&z.addEventListener("blur",Dt),this.data.comb){const wt=(this.data.rect[2]-this.data.rect[0])/Tt;z.classList.add("comb"),z.style.letterSpacing=`calc(${wt}px * var(--scale-factor) - 1ch)`}}else z=document.createElement("div"),z.textContent=this.data.fieldValue,z.style.verticalAlign="middle",z.style.display="table-cell";return this._setTextStyle(z),this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class w extends a{constructor(c){super(c,{isRenderable:!!c.data.hasOwnCanvas})}}class Y extends a{constructor(c){super(c,{isRenderable:c.renderForms})}render(){const c=this.annotationStorage,I=this.data,z=I.id;let Z=c.getValue(z,{value:I.exportValue===I.fieldValue}).value;typeof Z=="string"&&(Z=Z!=="Off",c.setValue(z,{value:Z})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ct=document.createElement("input");return M.add(ct),ct.setAttribute("data-element-id",z),ct.disabled=I.readOnly,this._setRequired(ct,this.data.required),ct.type="checkbox",ct.name=I.fieldName,Z&&ct.setAttribute("checked",!0),ct.setAttribute("exportValue",I.exportValue),ct.tabIndex=f,ct.addEventListener("change",ht=>{const{name:mt,checked:Tt}=ht.target;for(const Et of this._getElementsByName(mt,z)){const Pt=Tt&&Et.exportValue===I.exportValue;Et.domElement&&(Et.domElement.checked=Pt),c.setValue(Et.id,{value:Pt})}c.setValue(z,{value:Tt})}),ct.addEventListener("resetform",ht=>{const mt=I.defaultFieldValue||"Off";ht.target.checked=mt===I.exportValue}),this.enableScripting&&this.hasJSActions&&(ct.addEventListener("updatefromsandbox",ht=>{const mt={value(Tt){Tt.target.checked=Tt.detail.value!=="Off",c.setValue(z,{value:Tt.target.checked})}};this._dispatchEventFromSandbox(mt,ht)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ht=>ht.target.checked)),this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class B extends a{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const c=this.annotationStorage,I=this.data,z=I.id;let Z=c.getValue(z,{value:I.fieldValue===I.buttonValue}).value;typeof Z=="string"&&(Z=Z!==I.buttonValue,c.setValue(z,{value:Z}));const ct=document.createElement("input");if(M.add(ct),ct.setAttribute("data-element-id",z),ct.disabled=I.readOnly,this._setRequired(ct,this.data.required),ct.type="radio",ct.name=I.fieldName,Z&&ct.setAttribute("checked",!0),ct.tabIndex=f,ct.addEventListener("change",ht=>{const{name:mt,checked:Tt}=ht.target;for(const Et of this._getElementsByName(mt,z))c.setValue(Et.id,{value:!1});c.setValue(z,{value:Tt})}),ct.addEventListener("resetform",ht=>{const mt=I.defaultFieldValue;ht.target.checked=mt!=null&&mt===I.buttonValue}),this.enableScripting&&this.hasJSActions){const ht=I.buttonValue;ct.addEventListener("updatefromsandbox",mt=>{const Tt={value:Et=>{const Pt=ht===Et.detail.value;for(const Dt of this._getElementsByName(Et.target.name)){const Ct=Pt&&Dt.id===z;Dt.domElement&&(Dt.domElement.checked=Ct),c.setValue(Dt.id,{value:Ct})}}};this._dispatchEventFromSandbox(Tt,mt)}),this._setEventListeners(ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],mt=>mt.target.checked)}return this._setBackgroundColor(ct),this._setDefaultPropertiesFromJS(ct),this.container.append(ct),this.container}}class g extends n{constructor(c){super(c,{ignoreBorder:c.data.hasAppearance})}render(){const c=super.render();c.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(c.title=this.data.alternativeText);const I=c.lastChild;return this.enableScripting&&this.hasJSActions&&I&&(this._setDefaultPropertiesFromJS(I),I.addEventListener("updatefromsandbox",z=>{this._dispatchEventFromSandbox({},z)})),c}}class P extends a{constructor(c){super(c,{isRenderable:c.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const c=this.annotationStorage,I=this.data.id,z=c.getValue(I,{value:this.data.fieldValue}),Z=document.createElement("select");M.add(Z),Z.setAttribute("data-element-id",I),Z.disabled=this.data.readOnly,this._setRequired(Z,this.data.required),Z.name=this.data.fieldName,Z.tabIndex=f;let ct=this.data.combo&&this.data.options.length>0;this.data.combo||(Z.size=this.data.options.length,this.data.multiSelect&&(Z.multiple=!0)),Z.addEventListener("resetform",Pt=>{const Dt=this.data.defaultFieldValue;for(const Ct of Z.options)Ct.selected=Ct.value===Dt});for(const Pt of this.data.options){const Dt=document.createElement("option");Dt.textContent=Pt.displayValue,Dt.value=Pt.exportValue,z.value.includes(Pt.exportValue)&&(Dt.setAttribute("selected",!0),ct=!1),Z.append(Dt)}let ht=null;if(ct){const Pt=document.createElement("option");Pt.value=" ",Pt.setAttribute("hidden",!0),Pt.setAttribute("selected",!0),Z.prepend(Pt),ht=()=>{Pt.remove(),Z.removeEventListener("input",ht),ht=null},Z.addEventListener("input",ht)}const mt=Pt=>{const Dt=Pt?"value":"textContent",{options:Ct,multiple:wt}=Z;return wt?Array.prototype.filter.call(Ct,Ot=>Ot.selected).map(Ot=>Ot[Dt]):Ct.selectedIndex===-1?null:Ct[Ct.selectedIndex][Dt]};let Tt=mt(!1);const Et=Pt=>{const Dt=Pt.target.options;return Array.prototype.map.call(Dt,Ct=>({displayValue:Ct.textContent,exportValue:Ct.value}))};return this.enableScripting&&this.hasJSActions?(Z.addEventListener("updatefromsandbox",Pt=>{const Dt={value(Ct){var wt;(wt=ht)===null||wt===void 0||wt();const Ot=Ct.detail.value,Bt=new Set(Array.isArray(Ot)?Ot:[Ot]);for(const Nt of Z.options)Nt.selected=Bt.has(Nt.value);c.setValue(I,{value:mt(!0)}),Tt=mt(!1)},multipleSelection(Ct){Z.multiple=!0},remove(Ct){const wt=Z.options,Ot=Ct.detail.remove;wt[Ot].selected=!1,Z.remove(Ot),wt.length>0&&Array.prototype.findIndex.call(wt,Nt=>Nt.selected)===-1&&(wt[0].selected=!0),c.setValue(I,{value:mt(!0),items:Et(Ct)}),Tt=mt(!1)},clear(Ct){for(;Z.length!==0;)Z.remove(0);c.setValue(I,{value:null,items:[]}),Tt=mt(!1)},insert(Ct){const{index:wt,displayValue:Ot,exportValue:Bt}=Ct.detail.insert,Nt=Z.children[wt],Ht=document.createElement("option");Ht.textContent=Ot,Ht.value=Bt,Nt?Nt.before(Ht):Z.append(Ht),c.setValue(I,{value:mt(!0),items:Et(Ct)}),Tt=mt(!1)},items(Ct){const{items:wt}=Ct.detail;for(;Z.length!==0;)Z.remove(0);for(const Ot of wt){const{displayValue:Bt,exportValue:Nt}=Ot,Ht=document.createElement("option");Ht.textContent=Bt,Ht.value=Nt,Z.append(Ht)}Z.options.length>0&&(Z.options[0].selected=!0),c.setValue(I,{value:mt(!0),items:Et(Ct)}),Tt=mt(!1)},indices(Ct){const wt=new Set(Ct.detail.indices);for(const Ot of Ct.target.options)Ot.selected=wt.has(Ot.index);c.setValue(I,{value:mt(!0)}),Tt=mt(!1)},editable(Ct){Ct.target.disabled=!Ct.detail.editable}};this._dispatchEventFromSandbox(Dt,Pt)}),Z.addEventListener("input",Pt=>{var Dt;const Ct=mt(!0);c.setValue(I,{value:Ct}),Pt.preventDefault(),(Dt=this.linkService.eventBus)===null||Dt===void 0||Dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Tt,changeEx:Ct,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Z,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Pt=>Pt.target.value)):Z.addEventListener("input",function(Pt){c.setValue(I,{value:mt(!0)})}),this.data.combo&&this._setTextStyle(Z),this._setBackgroundColor(Z),this._setDefaultPropertiesFromJS(Z),this.container.append(Z),this.container}}class q extends u{constructor(c){const{data:I,elements:z}=c;super(c,{isRenderable:u._hasPopupData(I)}),this.elements=z}render(){this.container.classList.add("popupAnnotation");const c=new at({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),I=[];for(const z of this.elements)z.popup=c,I.push(z.data.id),z.addHighlightArea();return this.container.setAttribute("aria-controls",I.map(z=>`${e.AnnotationPrefix}${z}`).join(",")),this.container}}var Q=new WeakMap,$=new WeakMap,et=new WeakMap,_t=new WeakMap,X=new WeakMap,b=new WeakMap,N=new WeakMap,rt=new WeakMap,v=new WeakMap,s=new WeakMap,i=new WeakMap,h=new WeakMap,E=new WeakMap,C=new WeakMap,U=new WeakMap,H=new WeakMap,K=new WeakMap,ot=new WeakSet;class at{constructor(c){let{container:I,color:z,elements:Z,titleObj:ct,modificationDate:ht,contentsObj:mt,richText:Tt,parent:Et,rect:Pt,parentRect:Dt,open:Ct}=c;_classPrivateMethodInitSpec(this,ot),_classPrivateFieldInitSpec(this,Q,null),_classPrivateFieldInitSpec(this,$,_assertClassBrand(ot,this,dt).bind(this)),_classPrivateFieldInitSpec(this,et,_assertClassBrand(ot,this,W).bind(this)),_classPrivateFieldInitSpec(this,_t,_assertClassBrand(ot,this,At).bind(this)),_classPrivateFieldInitSpec(this,X,_assertClassBrand(ot,this,ft).bind(this)),_classPrivateFieldInitSpec(this,b,null),_classPrivateFieldInitSpec(this,N,null),_classPrivateFieldInitSpec(this,rt,null),_classPrivateFieldInitSpec(this,v,null),_classPrivateFieldInitSpec(this,s,null),_classPrivateFieldInitSpec(this,i,null),_classPrivateFieldInitSpec(this,h,!1),_classPrivateFieldInitSpec(this,E,null),_classPrivateFieldInitSpec(this,C,null),_classPrivateFieldInitSpec(this,U,null),_classPrivateFieldInitSpec(this,H,null),_classPrivateFieldInitSpec(this,K,!1),_classPrivateFieldSet(N,this,I),_classPrivateFieldSet(H,this,ct),_classPrivateFieldSet(rt,this,mt),_classPrivateFieldSet(U,this,Tt),_classPrivateFieldSet(s,this,Et),_classPrivateFieldSet(b,this,z),_classPrivateFieldSet(C,this,Pt),_classPrivateFieldSet(i,this,Dt),_classPrivateFieldSet(v,this,Z);const wt=r.PDFDateString.toDateObject(ht);wt&&_classPrivateFieldSet(Q,this,Et.l10n.get("annotation_date_string",{date:wt.toLocaleDateString(),time:wt.toLocaleTimeString()})),this.trigger=Z.flatMap(Bt=>Bt.getElementsToTriggerPopup());for(const Bt of this.trigger)Bt.addEventListener("click",_classPrivateFieldGet(X,this)),Bt.addEventListener("mouseenter",_classPrivateFieldGet(_t,this)),Bt.addEventListener("mouseleave",_classPrivateFieldGet(et,this)),Bt.classList.add("popupTriggerArea");for(const Bt of Z){var Ot;(Ot=Bt.container)===null||Ot===void 0||Ot.addEventListener("keydown",_classPrivateFieldGet($,this))}_classPrivateFieldGet(N,this).hidden=!0,Ct&&_assertClassBrand(ot,this,ft).call(this)}render(){if(_classPrivateFieldGet(E,this))return;const{page:{view:c},viewport:{rawDims:{pageWidth:I,pageHeight:z,pageX:Z,pageY:ct}}}=_classPrivateFieldGet(s,this),ht=_classPrivateFieldSet(E,this,document.createElement("div"));if(ht.className="popup",_classPrivateFieldGet(b,this)){const zt=ht.style.outlineColor=e.Util.makeHexColor(..._classPrivateFieldGet(b,this));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?ht.style.backgroundColor=`color-mix(in srgb, ${zt} 30%, white)`:ht.style.backgroundColor=e.Util.makeHexColor(..._classPrivateFieldGet(b,this).map(Vt=>Math.floor(.7*(255-Vt)+Vt)))}const mt=document.createElement("span");mt.className="header";const Tt=document.createElement("h1");if(mt.append(Tt),{dir:Tt.dir,str:Tt.textContent}=_classPrivateFieldGet(H,this),ht.append(mt),_classPrivateFieldGet(Q,this)){const zt=document.createElement("span");zt.classList.add("popupDate"),_classPrivateFieldGet(Q,this).then(qt=>{zt.textContent=qt}),mt.append(zt)}const Et=_classPrivateFieldGet(rt,this),Pt=_classPrivateFieldGet(U,this);if(Pt!=null&&Pt.str&&(!(Et!=null&&Et.str)||Et.str===Pt.str))D.XfaLayer.render({xfaHtml:Pt.html,intent:"richText",div:ht}),ht.lastChild.classList.add("richText","popupContent");else{const zt=this._formatContents(Et);ht.append(zt)}let Dt=!!_classPrivateFieldGet(i,this),Ct=Dt?_classPrivateFieldGet(i,this):_classPrivateFieldGet(C,this);for(const zt of _classPrivateFieldGet(v,this))if(!Ct||e.Util.intersect(zt.data.rect,Ct)!==null){Ct=zt.data.rect,Dt=!0;break}const wt=e.Util.normalizeRect([Ct[0],c[3]-Ct[1]+c[1],Ct[2],c[3]-Ct[3]+c[1]]),Bt=Dt?Ct[2]-Ct[0]+5:0,Nt=wt[0]+Bt,Ht=wt[1],{style:Xt}=_classPrivateFieldGet(N,this);Xt.left=`${100*(Nt-Z)/I}%`,Xt.top=`${100*(Ht-ct)/z}%`,_classPrivateFieldGet(N,this).append(ht)}_formatContents(c){let{str:I,dir:z}=c;const Z=document.createElement("p");Z.classList.add("popupContent"),Z.dir=z;const ct=I.split(/(?:\r\n?|\n)/);for(let ht=0,mt=ct.length;ht<mt;++ht){const Tt=ct[ht];Z.append(document.createTextNode(Tt)),ht<mt-1&&Z.append(document.createElement("br"))}return Z}forceHide(){_classPrivateFieldSet(K,this,this.isVisible),_classPrivateFieldGet(K,this)&&(_classPrivateFieldGet(N,this).hidden=!0)}maybeShow(){_classPrivateFieldGet(K,this)&&(_classPrivateFieldSet(K,this,!1),_classPrivateFieldGet(N,this).hidden=!1)}get isVisible(){return _classPrivateFieldGet(N,this).hidden===!1}}function dt(bt){bt.altKey||bt.shiftKey||bt.ctrlKey||bt.metaKey||(bt.key==="Enter"||bt.key==="Escape"&&_classPrivateFieldGet(h,this))&&_assertClassBrand(ot,this,ft).call(this)}function ft(){_classPrivateFieldSet(h,this,!_classPrivateFieldGet(h,this)),_classPrivateFieldGet(h,this)?(_assertClassBrand(ot,this,At).call(this),_classPrivateFieldGet(N,this).addEventListener("click",_classPrivateFieldGet(X,this)),_classPrivateFieldGet(N,this).addEventListener("keydown",_classPrivateFieldGet($,this))):(_assertClassBrand(ot,this,W).call(this),_classPrivateFieldGet(N,this).removeEventListener("click",_classPrivateFieldGet(X,this)),_classPrivateFieldGet(N,this).removeEventListener("keydown",_classPrivateFieldGet($,this)))}function At(){_classPrivateFieldGet(E,this)||this.render(),this.isVisible?_classPrivateFieldGet(h,this)&&_classPrivateFieldGet(N,this).classList.add("focused"):(_classPrivateFieldGet(N,this).hidden=!1,_classPrivateFieldGet(N,this).style.zIndex=parseInt(_classPrivateFieldGet(N,this).style.zIndex)+1e3)}function W(){_classPrivateFieldGet(N,this).classList.remove("focused"),!(_classPrivateFieldGet(h,this)||!this.isVisible)&&(_classPrivateFieldGet(N,this).hidden=!0,_classPrivateFieldGet(N,this).style.zIndex=parseInt(_classPrivateFieldGet(N,this).style.zIndex)-1e3)}class k extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0}),this.textContent=c.data.textContent,this.textPosition=c.data.textPosition,this.annotationEditorType=e.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const c=document.createElement("div");c.classList.add("annotationTextContent"),c.setAttribute("role","comment");for(const I of this.textContent){const z=document.createElement("span");z.textContent=I,c.append(z)}this.container.append(c)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=k;var G=new WeakMap;class O extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,G,null)}render(){this.container.classList.add("lineAnnotation");const c=this.data,{width:I,height:z}=p(c.rect),Z=this.svgFactory.create(I,z,!0),ct=_classPrivateFieldSet(G,this,this.svgFactory.createElement("svg:line"));return ct.setAttribute("x1",c.rect[2]-c.lineCoordinates[0]),ct.setAttribute("y1",c.rect[3]-c.lineCoordinates[1]),ct.setAttribute("x2",c.rect[2]-c.lineCoordinates[2]),ct.setAttribute("y2",c.rect[3]-c.lineCoordinates[3]),ct.setAttribute("stroke-width",c.borderStyle.width||1),ct.setAttribute("stroke","transparent"),ct.setAttribute("fill","transparent"),Z.append(ct),this.container.append(Z),!c.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(G,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var j=new WeakMap;class lt extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,j,null)}render(){this.container.classList.add("squareAnnotation");const c=this.data,{width:I,height:z}=p(c.rect),Z=this.svgFactory.create(I,z,!0),ct=c.borderStyle.width,ht=_classPrivateFieldSet(j,this,this.svgFactory.createElement("svg:rect"));return ht.setAttribute("x",ct/2),ht.setAttribute("y",ct/2),ht.setAttribute("width",I-ct),ht.setAttribute("height",z-ct),ht.setAttribute("stroke-width",ct||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),Z.append(ht),this.container.append(Z),!c.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(j,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var ut=new WeakMap;class st extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,ut,null)}render(){this.container.classList.add("circleAnnotation");const c=this.data,{width:I,height:z}=p(c.rect),Z=this.svgFactory.create(I,z,!0),ct=c.borderStyle.width,ht=_classPrivateFieldSet(ut,this,this.svgFactory.createElement("svg:ellipse"));return ht.setAttribute("cx",I/2),ht.setAttribute("cy",z/2),ht.setAttribute("rx",I/2-ct/2),ht.setAttribute("ry",z/2-ct/2),ht.setAttribute("stroke-width",ct||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),Z.append(ht),this.container.append(Z),!c.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(ut,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var it=new WeakMap;class St extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,it,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const c=this.data,{width:I,height:z}=p(c.rect),Z=this.svgFactory.create(I,z,!0);let ct=[];for(const mt of c.vertices){const Tt=mt.x-c.rect[0],Et=c.rect[3]-mt.y;ct.push(Tt+","+Et)}ct=ct.join(" ");const ht=_classPrivateFieldSet(it,this,this.svgFactory.createElement(this.svgElementName));return ht.setAttribute("points",ct),ht.setAttribute("stroke-width",c.borderStyle.width||1),ht.setAttribute("stroke","transparent"),ht.setAttribute("fill","transparent"),Z.append(ht),this.container.append(Z),!c.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(it,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}class kt extends St{constructor(c){super(c),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Mt extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Lt=new WeakMap;class Rt extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0}),_classPrivateFieldInitSpec(this,Lt,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=e.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const c=this.data,{width:I,height:z}=p(c.rect),Z=this.svgFactory.create(I,z,!0);for(const ct of c.inkLists){let ht=[];for(const Tt of ct){const Et=Tt.x-c.rect[0],Pt=c.rect[3]-Tt.y;ht.push(`${Et},${Pt}`)}ht=ht.join(" ");const mt=this.svgFactory.createElement(this.svgElementName);_classPrivateFieldGet(Lt,this).push(mt),mt.setAttribute("points",ht),mt.setAttribute("stroke-width",c.borderStyle.width||1),mt.setAttribute("stroke","transparent"),mt.setAttribute("fill","transparent"),!c.popupRef&&this.hasPopupData&&this._createPopup(),Z.append(mt)}return this.container.append(Z),this.container}getElementsToTriggerPopup(){return _classPrivateFieldGet(Lt,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}t.InkAnnotationElement=Rt;class Ft extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class yt extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Wt extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Ut extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class jt extends u{constructor(c){super(c,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=jt;var $t=new WeakMap,pt=new WeakSet;class tt extends u{constructor(c){var I;super(c,{isRenderable:!0}),_classPrivateMethodInitSpec(this,pt),_classPrivateFieldInitSpec(this,$t,null);const{filename:z,content:Z}=this.data.file;this.filename=(0,r.getFilenameFromUrl)(z,!0),this.content=Z,(I=this.linkService.eventBus)===null||I===void 0||I.dispatch("fileattachmentannotation",{source:this,filename:z,content:Z})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:c,data:I}=this;let z;I.hasAppearance||I.fillAlpha===0?z=document.createElement("div"):(z=document.createElement("img"),z.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(I.name)?"paperclip":"pushpin"}.svg`,I.fillAlpha&&I.fillAlpha<1&&(z.style=`filter: opacity(${Math.round(I.fillAlpha*100)}%);`)),z.addEventListener("dblclick",_assertClassBrand(pt,this,J).bind(this)),_classPrivateFieldSet($t,this,z);const{isMac:Z}=e.FeatureTest.platform;return c.addEventListener("keydown",ct=>{ct.key==="Enter"&&(Z?ct.metaKey:ct.ctrlKey)&&_assertClassBrand(pt,this,J).call(this)}),!I.popupRef&&this.hasPopupData?this._createPopup():z.classList.add("popupTriggerArea"),c.append(z),c}getElementsToTriggerPopup(){return _classPrivateFieldGet($t,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function J(){var bt;(bt=this.downloadManager)===null||bt===void 0||bt.openOrDownloadData(this.container,this.content,this.filename)}var gt=new WeakMap,x=new WeakMap,nt=new WeakMap,vt=new WeakSet;class xt{constructor(c){let{div:I,accessibilityManager:z,annotationCanvasMap:Z,l10n:ct,page:ht,viewport:mt}=c;_classPrivateMethodInitSpec(this,vt),_classPrivateFieldInitSpec(this,gt,null),_classPrivateFieldInitSpec(this,x,null),_classPrivateFieldInitSpec(this,nt,new Map),this.div=I,_classPrivateFieldSet(gt,this,z),_classPrivateFieldSet(x,this,Z),this.l10n=ct,this.page=ht,this.viewport=mt,this.zIndex=0,this.l10n||(this.l10n=V.NullL10n)}async render(c){const{annotations:I}=c,z=this.div;(0,r.setLayerDimensions)(z,this.viewport);const Z=new Map,ct={data:null,layer:z,linkService:c.linkService,downloadManager:c.downloadManager,imageResourcesPath:c.imageResourcesPath||"",renderForms:c.renderForms!==!1,svgFactory:new r.DOMSVGFactory,annotationStorage:c.annotationStorage||new R.AnnotationStorage,enableScripting:c.enableScripting===!0,hasJSActions:c.hasJSActions,fieldObjects:c.fieldObjects,parent:this,elements:null};for(const ht of I){if(ht.noHTML)continue;const mt=ht.annotationType===e.AnnotationType.POPUP;if(mt){const Pt=Z.get(ht.id);if(!Pt)continue;ct.elements=Pt}else{const{width:Pt,height:Dt}=p(ht.rect);if(Pt<=0||Dt<=0)continue}ct.data=ht;const Tt=m.create(ct);if(!Tt.isRenderable)continue;if(!mt&&ht.popupRef){const Pt=Z.get(ht.popupRef);Pt?Pt.push(Tt):Z.set(ht.popupRef,[Tt])}Tt.annotationEditorType>0&&_classPrivateFieldGet(nt,this).set(Tt.data.id,Tt);const Et=Tt.render();ht.hidden&&(Et.style.visibility="hidden"),_assertClassBrand(vt,this,It).call(this,Et,ht.id)}_assertClassBrand(vt,this,Gt).call(this),await this.l10n.translate(z)}update(c){let{viewport:I}=c;const z=this.div;this.viewport=I,(0,r.setLayerDimensions)(z,{rotation:I.rotation}),_assertClassBrand(vt,this,Gt).call(this),z.hidden=!1}getEditableAnnotations(){return Array.from(_classPrivateFieldGet(nt,this).values())}getEditableAnnotation(c){return _classPrivateFieldGet(nt,this).get(c)}}function It(bt,c){var I;const z=bt.firstChild||bt;z.id=`${e.AnnotationPrefix}${c}`,this.div.append(bt),(I=_classPrivateFieldGet(gt,this))===null||I===void 0||I.moveElementInDOM(this.div,bt,z,!1)}function Gt(){if(!_classPrivateFieldGet(x,this))return;const bt=this.div;for(const[c,I]of _classPrivateFieldGet(x,this)){const z=bt.querySelector(`[data-annotation-id="${c}"]`);if(!z)continue;const{firstChild:Z}=z;Z?Z.nodeName==="CANVAS"?Z.replaceWith(I):Z.before(I):z.append(I)}_classPrivateFieldGet(x,this).clear()}t.AnnotationLayer=xt},(T,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function _(R){return Math.floor(Math.max(0,Math.min(1,R))*255).toString(16).padStart(2,"0")}function e(R){return Math.max(0,Math.min(255,255*R))}class r{static CMYK_G(L){let[V,D,f,A]=L;return["G",1-Math.min(1,.3*V+.59*f+.11*D+A)]}static G_CMYK(L){let[V]=L;return["CMYK",0,0,0,1-V]}static G_RGB(L){let[V]=L;return["RGB",V,V,V]}static G_rgb(L){let[V]=L;return V=e(V),[V,V,V]}static G_HTML(L){let[V]=L;const D=_(V);return`#${D}${D}${D}`}static RGB_G(L){let[V,D,f]=L;return["G",.3*V+.59*D+.11*f]}static RGB_rgb(L){return L.map(e)}static RGB_HTML(L){return`#${L.map(_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(L){let[V,D,f,A]=L;return["RGB",1-Math.min(1,V+A),1-Math.min(1,f+A),1-Math.min(1,D+A)]}static CMYK_rgb(L){let[V,D,f,A]=L;return[e(1-Math.min(1,V+A)),e(1-Math.min(1,f+A)),e(1-Math.min(1,D+A))]}static CMYK_HTML(L){const V=this.CMYK_RGB(L).slice(1);return this.RGB_HTML(V)}static RGB_CMYK(L){let[V,D,f]=L;const A=1-V,M=1-D,p=1-f,m=Math.min(A,M,p);return["CMYK",A,M,p,m]}}t.ColorConverters=r},(T,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=e;const _={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};_.print_progress_percent="{{progress}}%";function e(L,V){switch(L){case"find_match_count":L=`find_match_count[${V.total===1?"one":"other"}]`;break;case"find_match_count_limit":L=`find_match_count_limit[${V.limit===1?"one":"other"}]`;break}return _[L]||""}function r(L,V){return V?L.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(D,f)=>f in V?V[f]:"{{"+f+"}}"):L}const R={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(L){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e(L,V);return r(D,V)},async translate(L){}};t.NullL10n=R},(T,t,_)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var e=_(25);class r{static setupStorage(L,V,D,f,A){const M=f.getValue(V,{value:null});switch(D.name){case"textarea":if(M.value!==null&&(L.textContent=M.value),A==="print")break;L.addEventListener("input",p=>{f.setValue(V,{value:p.target.value})});break;case"input":if(D.attributes.type==="radio"||D.attributes.type==="checkbox"){if(M.value===D.attributes.xfaOn?L.setAttribute("checked",!0):M.value===D.attributes.xfaOff&&L.removeAttribute("checked"),A==="print")break;L.addEventListener("change",p=>{f.setValue(V,{value:p.target.checked?p.target.getAttribute("xfaOn"):p.target.getAttribute("xfaOff")})})}else{if(M.value!==null&&L.setAttribute("value",M.value),A==="print")break;L.addEventListener("input",p=>{f.setValue(V,{value:p.target.value})})}break;case"select":if(M.value!==null){L.setAttribute("value",M.value);for(const p of D.children)p.attributes.value===M.value?p.attributes.selected=!0:p.attributes.hasOwnProperty("selected")&&delete p.attributes.selected}L.addEventListener("input",p=>{const m=p.target.options,S=m.selectedIndex===-1?"":m[m.selectedIndex].value;f.setValue(V,{value:S})});break}}static setAttributes(L){let{html:V,element:D,storage:f=null,intent:A,linkService:M}=L;const{attributes:p}=D,m=V instanceof HTMLAnchorElement;p.type==="radio"&&(p.name=`${p.name}-${A}`);for(const[S,u]of Object.entries(p))if(u!=null)switch(S){case"class":u.length&&V.setAttribute(S,u.join(" "));break;case"dataId":break;case"id":V.setAttribute("data-element-id",u);break;case"style":Object.assign(V.style,u);break;case"textContent":V.textContent=u;break;default:(!m||S!=="href"&&S!=="newWindow")&&V.setAttribute(S,u)}m&&M.addLinkAttributes(V,p.href,p.newWindow),f&&p.dataId&&this.setupStorage(V,p.dataId,D,f)}static render(L){const V=L.annotationStorage,D=L.linkService,f=L.xfaHtml,A=L.intent||"display",M=document.createElement(f.name);f.attributes&&this.setAttributes({html:M,element:f,intent:A,linkService:D});const p=[[f,-1,M]],m=L.div;if(m.append(M),L.viewport){const d=`matrix(${L.viewport.transform.join(",")})`;m.style.transform=d}A!=="richText"&&m.setAttribute("class","xfaLayer xfaFont");const S=[];for(;p.length>0;){var u;const[d,n,l]=p.at(-1);if(n+1===d.children.length){p.pop();continue}const F=d.children[++p.at(-1)[1]];if(F===null)continue;const{name:y}=F;if(y==="#text"){const o=document.createTextNode(F.value);S.push(o),l.append(o);continue}const a=F!=null&&(u=F.attributes)!==null&&u!==void 0&&u.xmlns?document.createElementNS(F.attributes.xmlns,y):document.createElement(y);if(l.append(a),F.attributes&&this.setAttributes({html:a,element:F,storage:V,intent:A,linkService:D}),F.children&&F.children.length>0)p.push([F,-1,a]);else if(F.value){const o=document.createTextNode(F.value);e.XfaText.shouldBuildText(y)&&S.push(o),a.append(o)}}for(const d of m.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:S}}static update(L){const V=`matrix(${L.viewport.transform.join(",")})`;L.div.style.transform=V,L.div.hidden=!1}}t.XfaLayer=r},(T,t,_)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var r=_(1),R=_(4),L=_(29),V=_(6),D=_(5),f=new WeakMap,A=new WeakMap,M=new WeakMap,p=new WeakMap,m=new WeakMap,S=new WeakMap,u=new WeakMap,d=new WeakMap,n=new WeakMap,l=new WeakMap,F=new WeakMap,y=new WeakMap,a=new WeakMap,o=new WeakMap,w=new WeakSet;class Y extends R.AnnotationEditor{constructor(k){super({...k,name:"inkEditor"}),_classPrivateMethodInitSpec(this,w),_classPrivateFieldInitSpec(this,f,0),_classPrivateFieldInitSpec(this,A,0),_classPrivateFieldInitSpec(this,M,this.canvasPointermove.bind(this)),_classPrivateFieldInitSpec(this,p,this.canvasPointerleave.bind(this)),_classPrivateFieldInitSpec(this,m,this.canvasPointerup.bind(this)),_classPrivateFieldInitSpec(this,S,this.canvasPointerdown.bind(this)),_classPrivateFieldInitSpec(this,u,new Path2D),_classPrivateFieldInitSpec(this,d,!1),_classPrivateFieldInitSpec(this,n,!1),_classPrivateFieldInitSpec(this,l,!1),_classPrivateFieldInitSpec(this,F,null),_classPrivateFieldInitSpec(this,y,0),_classPrivateFieldInitSpec(this,a,0),_classPrivateFieldInitSpec(this,o,null),this.color=k.color||null,this.thickness=k.thickness||null,this.opacity=k.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(k){R.AnnotationEditor.initialize(k,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(k,G){switch(k){case r.AnnotationEditorParamsType.INK_THICKNESS:Y._defaultThickness=G;break;case r.AnnotationEditorParamsType.INK_COLOR:Y._defaultColor=G;break;case r.AnnotationEditorParamsType.INK_OPACITY:Y._defaultOpacity=G/100;break}}updateParams(k,G){switch(k){case r.AnnotationEditorParamsType.INK_THICKNESS:_assertClassBrand(w,this,B).call(this,G);break;case r.AnnotationEditorParamsType.INK_COLOR:_assertClassBrand(w,this,g).call(this,G);break;case r.AnnotationEditorParamsType.INK_OPACITY:_assertClassBrand(w,this,P).call(this,G);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,Y._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,Y._defaultColor||R.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(Y._defaultOpacity*100)]]}get propertiesToUpdate(){var k;return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Y._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||Y._defaultColor||R.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((k=this.opacity)!==null&&k!==void 0?k:Y._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(_assertClassBrand(w,this,i).call(this),_assertClassBrand(w,this,h).call(this)),this.isAttachedToDOM||(this.parent.add(this),_assertClassBrand(w,this,E).call(this)),_assertClassBrand(w,this,At).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,_classPrivateFieldGet(F,this).disconnect(),_classPrivateFieldSet(F,this,null),super.remove())}setParent(k){!this.parent&&k?this._uiManager.removeShouldRescale(this):this.parent&&k===null&&this._uiManager.addShouldRescale(this),super.setParent(k)}onScaleChanging(){const[k,G]=this.parentDimensions,O=this.width*k,j=this.height*G;this.setDimensions(O,j)}enableEditMode(){_classPrivateFieldGet(d,this)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",_classPrivateFieldGet(S,this)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",_classPrivateFieldGet(S,this)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){_classPrivateFieldGet(d,this)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),_classPrivateFieldSet(d,this,!0),this.div.classList.add("disabled"),_assertClassBrand(w,this,At).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(k){this._focusEventsAllowed&&(super.focusin(k),this.enableEditMode())}canvasPointerdown(k){k.button!==0||!this.isInEditMode()||_classPrivateFieldGet(d,this)||(this.setInForeground(),k.preventDefault(),k.type!=="mouse"&&this.div.focus(),_assertClassBrand(w,this,$).call(this,k.offsetX,k.offsetY))}canvasPointermove(k){k.preventDefault(),_assertClassBrand(w,this,et).call(this,k.offsetX,k.offsetY)}canvasPointerup(k){k.preventDefault(),_assertClassBrand(w,this,s).call(this,k)}canvasPointerleave(k){_assertClassBrand(w,this,s).call(this,k)}get isResizable(){return!this.isEmpty()&&_classPrivateFieldGet(d,this)}render(){if(this.div)return this.div;let k,G;this.width&&(k=this.x,G=this.y),super.render(),R.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(st=>{var it;return(it=this.div)===null||it===void 0?void 0:it.setAttribute("aria-label",st)});const[O,j,lt,ut]=_assertClassBrand(w,this,q).call(this);if(this.setAt(O,j,0,0),this.setDims(lt,ut),_assertClassBrand(w,this,i).call(this),this.width){const[st,it]=this.parentDimensions;this.setAspectRatio(this.width*st,this.height*it),this.setAt(k*st,G*it,this.width*st,this.height*it),_classPrivateFieldSet(l,this,!0),_assertClassBrand(w,this,E).call(this),this.setDims(this.width*st,this.height*it),_assertClassBrand(w,this,v).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return _assertClassBrand(w,this,h).call(this),this.div}setDimensions(k,G){const O=Math.round(k),j=Math.round(G);if(_classPrivateFieldGet(y,this)===O&&_classPrivateFieldGet(a,this)===j)return;_classPrivateFieldSet(y,this,O),_classPrivateFieldSet(a,this,j),this.canvas.style.visibility="hidden";const[lt,ut]=this.parentDimensions;this.width=k/lt,this.height=G/ut,this.fixAndSetPosition(),_classPrivateFieldGet(d,this)&&_assertClassBrand(w,this,C).call(this,k,G),_assertClassBrand(w,this,E).call(this),_assertClassBrand(w,this,v).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(k,G,O){if(k instanceof L.InkAnnotationElement)return null;const j=super.deserialize(k,G,O);j.thickness=k.thickness,j.color=r.Util.makeHexColor(...k.color),j.opacity=k.opacity;const[lt,ut]=j.pageDimensions,st=j.width*lt,it=j.height*ut,St=j.parentScale,kt=k.thickness/2;_classPrivateFieldSet(d,j,!0),_classPrivateFieldSet(y,j,Math.round(st)),_classPrivateFieldSet(a,j,Math.round(it));const{paths:Mt,rect:Lt,rotation:Rt}=k;for(let{bezier:yt}of Mt){yt=ot.call(Y,yt,Lt,Rt);const Wt=[];j.paths.push(Wt);let Ut=St*(yt[0]-kt),jt=St*(yt[1]-kt);for(let pt=2,tt=yt.length;pt<tt;pt+=6){const J=St*(yt[pt]-kt),gt=St*(yt[pt+1]-kt),x=St*(yt[pt+2]-kt),nt=St*(yt[pt+3]-kt),vt=St*(yt[pt+4]-kt),xt=St*(yt[pt+5]-kt);Wt.push([[Ut,jt],[J,gt],[x,nt],[vt,xt]]),Ut=vt,jt=xt}const $t=_assertClassBrand(Y,this,H).call(this,Wt);j.bezierPath2D.push($t)}const Ft=_assertClassBrand(w,j,dt).call(j);return _classPrivateFieldSet(A,j,Math.max(R.AnnotationEditor.MIN_SIZE,Ft[2]-Ft[0])),_classPrivateFieldSet(f,j,Math.max(R.AnnotationEditor.MIN_SIZE,Ft[3]-Ft[1])),_assertClassBrand(w,j,C).call(j,st,it),j}serialize(){if(this.isEmpty())return null;const k=this.getRect(0,0),G=R.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:G,thickness:this.thickness,opacity:this.opacity,paths:_assertClassBrand(w,this,at).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,k),pageIndex:this.pageIndex,rect:k,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}e=Y;function B(W){const k=this.thickness;this.addCommands({cmd:()=>{this.thickness=W,_assertClassBrand(w,this,At).call(this)},undo:()=>{this.thickness=k,_assertClassBrand(w,this,At).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}function g(W){const k=this.color;this.addCommands({cmd:()=>{this.color=W,_assertClassBrand(w,this,v).call(this)},undo:()=>{this.color=k,_assertClassBrand(w,this,v).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function P(W){W/=100;const k=this.opacity;this.addCommands({cmd:()=>{this.opacity=W,_assertClassBrand(w,this,v).call(this)},undo:()=>{this.opacity=k,_assertClassBrand(w,this,v).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}function q(){const{parentRotation:W,parentDimensions:[k,G]}=this;switch(W){case 90:return[0,G,G,k];case 180:return[k,G,k,G];case 270:return[k,0,G,k];default:return[0,0,k,G]}}function Q(){const{ctx:W,color:k,opacity:G,thickness:O,parentScale:j,scaleFactor:lt}=this;W.lineWidth=O*j/lt,W.lineCap="round",W.lineJoin="round",W.miterLimit=10,W.strokeStyle=`${k}${(0,D.opacityToHex)(G)}`}function $(W,k){this.canvas.addEventListener("contextmenu",V.noContextMenu),this.canvas.addEventListener("pointerleave",_classPrivateFieldGet(p,this)),this.canvas.addEventListener("pointermove",_classPrivateFieldGet(M,this)),this.canvas.addEventListener("pointerup",_classPrivateFieldGet(m,this)),this.canvas.removeEventListener("pointerdown",_classPrivateFieldGet(S,this)),this.isEditing=!0,_classPrivateFieldGet(l,this)||(_classPrivateFieldSet(l,this,!0),_assertClassBrand(w,this,E).call(this),this.thickness||(this.thickness=e._defaultThickness),this.color||(this.color=e._defaultColor||R.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=e._defaultOpacity)),this.currentPath.push([W,k]),_classPrivateFieldSet(n,this,!1),_assertClassBrand(w,this,Q).call(this),_classPrivateFieldSet(o,this,()=>{_assertClassBrand(w,this,b).call(this),_classPrivateFieldGet(o,this)&&window.requestAnimationFrame(_classPrivateFieldGet(o,this))}),window.requestAnimationFrame(_classPrivateFieldGet(o,this))}function et(W,k){const[G,O]=this.currentPath.at(-1);if(this.currentPath.length>1&&W===G&&k===O)return;const j=this.currentPath;let lt=_classPrivateFieldGet(u,this);if(j.push([W,k]),_classPrivateFieldSet(n,this,!0),j.length<=2){lt.moveTo(...j[0]),lt.lineTo(W,k);return}j.length===3&&(_classPrivateFieldSet(u,this,lt=new Path2D),lt.moveTo(...j[0])),_assertClassBrand(w,this,N).call(this,lt,...j.at(-3),...j.at(-2),W,k)}function _t(){if(this.currentPath.length===0)return;const W=this.currentPath.at(-1);_classPrivateFieldGet(u,this).lineTo(...W)}function X(W,k){_classPrivateFieldSet(o,this,null),W=Math.min(Math.max(W,0),this.canvas.width),k=Math.min(Math.max(k,0),this.canvas.height),_assertClassBrand(w,this,et).call(this,W,k),_assertClassBrand(w,this,_t).call(this);let G;if(this.currentPath.length!==1)G=_assertClassBrand(w,this,rt).call(this);else{const st=[W,k];G=[[st,st.slice(),st.slice(),st]]}const O=_classPrivateFieldGet(u,this),j=this.currentPath;this.currentPath=[],_classPrivateFieldSet(u,this,new Path2D);const lt=()=>{this.allRawPaths.push(j),this.paths.push(G),this.bezierPath2D.push(O),this.rebuild()},ut=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(_assertClassBrand(w,this,i).call(this),_assertClassBrand(w,this,h).call(this)),_assertClassBrand(w,this,At).call(this))};this.addCommands({cmd:lt,undo:ut,mustExec:!0})}function b(){if(!_classPrivateFieldGet(n,this))return;_classPrivateFieldSet(n,this,!1);const W=Math.ceil(this.thickness*this.parentScale),k=this.currentPath.slice(-3),G=k.map(lt=>lt[0]),O=k.map(lt=>lt[1]);Math.min(...G)-W,Math.max(...G)+W,Math.min(...O)-W,Math.max(...O)+W;const{ctx:j}=this;j.save(),j.clearRect(0,0,this.canvas.width,this.canvas.height);for(const lt of this.bezierPath2D)j.stroke(lt);j.stroke(_classPrivateFieldGet(u,this)),j.restore()}function N(W,k,G,O,j,lt,ut){const st=(k+O)/2,it=(G+j)/2,St=(O+lt)/2,kt=(j+ut)/2;W.bezierCurveTo(st+2*(O-st)/3,it+2*(j-it)/3,St+2*(O-St)/3,kt+2*(j-kt)/3,St,kt)}function rt(){const W=this.currentPath;if(W.length<=2)return[[W[0],W[0],W.at(-1),W.at(-1)]];const k=[];let G,[O,j]=W[0];for(G=1;G<W.length-2;G++){const[Mt,Lt]=W[G],[Rt,Ft]=W[G+1],yt=(Mt+Rt)/2,Wt=(Lt+Ft)/2,Ut=[O+2*(Mt-O)/3,j+2*(Lt-j)/3],jt=[yt+2*(Mt-yt)/3,Wt+2*(Lt-Wt)/3];k.push([[O,j],Ut,jt,[yt,Wt]]),[O,j]=[yt,Wt]}const[lt,ut]=W[G],[st,it]=W[G+1],St=[O+2*(lt-O)/3,j+2*(ut-j)/3],kt=[st+2*(lt-st)/3,it+2*(ut-it)/3];return k.push([[O,j],St,kt,[st,it]]),k}function v(){if(this.isEmpty()){_assertClassBrand(w,this,U).call(this);return}_assertClassBrand(w,this,Q).call(this);const{canvas:W,ctx:k}=this;k.setTransform(1,0,0,1,0,0),k.clearRect(0,0,W.width,W.height),_assertClassBrand(w,this,U).call(this);for(const G of this.bezierPath2D)k.stroke(G)}function s(W){this.canvas.removeEventListener("pointerleave",_classPrivateFieldGet(p,this)),this.canvas.removeEventListener("pointermove",_classPrivateFieldGet(M,this)),this.canvas.removeEventListener("pointerup",_classPrivateFieldGet(m,this)),this.canvas.addEventListener("pointerdown",_classPrivateFieldGet(S,this)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",V.noContextMenu)},10),_assertClassBrand(w,this,X).call(this,W.offsetX,W.offsetY),this.addToAnnotationStorage(),this.setInBackground()}function i(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",R.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(W=>{var k;return(k=this.canvas)===null||k===void 0?void 0:k.setAttribute("aria-label",W)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}function h(){_classPrivateFieldSet(F,this,new ResizeObserver(W=>{const k=W[0].contentRect;k.width&&k.height&&this.setDimensions(k.width,k.height)})),_classPrivateFieldGet(F,this).observe(this.div)}function E(){if(!_classPrivateFieldGet(l,this))return;const[W,k]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*W),this.canvas.height=Math.ceil(this.height*k),_assertClassBrand(w,this,U).call(this)}function C(W,k){const G=_assertClassBrand(w,this,ft).call(this),O=(W-G)/_classPrivateFieldGet(A,this),j=(k-G)/_classPrivateFieldGet(f,this);this.scaleFactor=Math.min(O,j)}function U(){const W=_assertClassBrand(w,this,ft).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+W,this.translationY*this.scaleFactor+W)}function H(W){const k=new Path2D;for(let G=0,O=W.length;G<O;G++){const[j,lt,ut,st]=W[G];G===0&&k.moveTo(...j),k.bezierCurveTo(lt[0],lt[1],ut[0],ut[1],st[0],st[1])}return k}function K(W,k,G){const[O,j,lt,ut]=k;switch(G){case 0:for(let st=0,it=W.length;st<it;st+=2)W[st]+=O,W[st+1]=ut-W[st+1];break;case 90:for(let st=0,it=W.length;st<it;st+=2){const St=W[st];W[st]=W[st+1]+O,W[st+1]=St+j}break;case 180:for(let st=0,it=W.length;st<it;st+=2)W[st]=lt-W[st],W[st+1]+=j;break;case 270:for(let st=0,it=W.length;st<it;st+=2){const St=W[st];W[st]=lt-W[st+1],W[st+1]=ut-St}break;default:throw new Error("Invalid rotation")}return W}function ot(W,k,G){const[O,j,lt,ut]=k;switch(G){case 0:for(let st=0,it=W.length;st<it;st+=2)W[st]-=O,W[st+1]=ut-W[st+1];break;case 90:for(let st=0,it=W.length;st<it;st+=2){const St=W[st];W[st]=W[st+1]-j,W[st+1]=St-O}break;case 180:for(let st=0,it=W.length;st<it;st+=2)W[st]=lt-W[st],W[st+1]-=j;break;case 270:for(let st=0,it=W.length;st<it;st+=2){const St=W[st];W[st]=ut-W[st+1],W[st+1]=lt-St}break;default:throw new Error("Invalid rotation")}return W}function at(W,k,G,O){const j=[],lt=this.thickness/2,ut=W*k+lt,st=W*G+lt;for(const it of this.paths){const St=[],kt=[];for(let Mt=0,Lt=it.length;Mt<Lt;Mt++){const[Rt,Ft,yt,Wt]=it[Mt],Ut=W*Rt[0]+ut,jt=W*Rt[1]+st,$t=W*Ft[0]+ut,pt=W*Ft[1]+st,tt=W*yt[0]+ut,J=W*yt[1]+st,gt=W*Wt[0]+ut,x=W*Wt[1]+st;Mt===0&&(St.push(Ut,jt),kt.push(Ut,jt)),St.push($t,pt,tt,J,gt,x),kt.push($t,pt),Mt===Lt-1&&kt.push(gt,x)}j.push({bezier:K.call(e,St,O,this.rotation),points:K.call(e,kt,O,this.rotation)})}return j}function dt(){let W=1/0,k=-1/0,G=1/0,O=-1/0;for(const j of this.paths)for(const[lt,ut,st,it]of j){const St=r.Util.bezierBoundingBox(...lt,...ut,...st,...it);W=Math.min(W,St[0]),G=Math.min(G,St[1]),k=Math.max(k,St[2]),O=Math.max(O,St[3])}return[W,G,k,O]}function ft(){return _classPrivateFieldGet(d,this)?Math.ceil(this.thickness*this.parentScale):0}function At(){let W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return;if(!_classPrivateFieldGet(d,this)){_assertClassBrand(w,this,v).call(this);return}const k=_assertClassBrand(w,this,dt).call(this),G=_assertClassBrand(w,this,ft).call(this);_classPrivateFieldSet(A,this,Math.max(R.AnnotationEditor.MIN_SIZE,k[2]-k[0])),_classPrivateFieldSet(f,this,Math.max(R.AnnotationEditor.MIN_SIZE,k[3]-k[1]));const O=Math.ceil(G+_classPrivateFieldGet(A,this)*this.scaleFactor),j=Math.ceil(G+_classPrivateFieldGet(f,this)*this.scaleFactor),[lt,ut]=this.parentDimensions;this.width=O/lt,this.height=j/ut,this.setAspectRatio(O,j);const st=this.translationX,it=this.translationY;this.translationX=-k[0],this.translationY=-k[1],_assertClassBrand(w,this,E).call(this),_assertClassBrand(w,this,v).call(this),_classPrivateFieldSet(y,this,O),_classPrivateFieldSet(a,this,j),this.setDims(O,j);const St=W?G/this.scaleFactor/2:0;this.translate(st-this.translationX-St,it-this.translationY-St)}_defineProperty(Y,"_defaultColor",null),_defineProperty(Y,"_defaultOpacity",1),_defineProperty(Y,"_defaultThickness",1),_defineProperty(Y,"_type","ink"),t.InkEditor=Y},(T,t,_)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var r=_(1),R=_(4),L=_(6),V=_(29),D=new WeakMap,f=new WeakMap,A=new WeakMap,M=new WeakMap,p=new WeakMap,m=new WeakMap,S=new WeakMap,u=new WeakMap,d=new WeakMap,n=new WeakMap,l=new WeakSet;class F extends R.AnnotationEditor{constructor($){super({...$,name:"stampEditor"}),_classPrivateMethodInitSpec(this,l),_classPrivateFieldInitSpec(this,D,null),_classPrivateFieldInitSpec(this,f,null),_classPrivateFieldInitSpec(this,A,null),_classPrivateFieldInitSpec(this,M,null),_classPrivateFieldInitSpec(this,p,null),_classPrivateFieldInitSpec(this,m,null),_classPrivateFieldInitSpec(this,S,null),_classPrivateFieldInitSpec(this,u,null),_classPrivateFieldInitSpec(this,d,!1),_classPrivateFieldInitSpec(this,n,!1),_classPrivateFieldSet(M,this,$.bitmapUrl),_classPrivateFieldSet(p,this,$.bitmapFile)}static initialize($){R.AnnotationEditor.initialize($)}static get supportedTypes(){const $=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,r.shadow)(this,"supportedTypes",$.map(et=>`image/${et}`))}static get supportedTypesStr(){return(0,r.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting($){return this.supportedTypes.includes($)}static paste($,et){et.pasteEditor(r.AnnotationEditorType.STAMP,{bitmapFile:$.getAsFile()})}remove(){if(_classPrivateFieldGet(f,this)){var $,et;_classPrivateFieldSet(D,this,null),this._uiManager.imageManager.deleteId(_classPrivateFieldGet(f,this)),($=_classPrivateFieldGet(m,this))===null||$===void 0||$.remove(),_classPrivateFieldSet(m,this,null),(et=_classPrivateFieldGet(S,this))===null||et===void 0||et.disconnect(),_classPrivateFieldSet(S,this,null)}super.remove()}rebuild(){if(!this.parent){_classPrivateFieldGet(f,this)&&_assertClassBrand(l,this,o).call(this);return}super.rebuild(),this.div!==null&&(_classPrivateFieldGet(f,this)&&_assertClassBrand(l,this,o).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(_classPrivateFieldGet(A,this)||_classPrivateFieldGet(D,this)||_classPrivateFieldGet(M,this)||_classPrivateFieldGet(p,this))}get isResizable(){return!0}render(){if(this.div)return this.div;let $,et;if(this.width&&($=this.x,et=this.y),super.render(),this.div.hidden=!0,_classPrivateFieldGet(D,this)?_assertClassBrand(l,this,w).call(this):_assertClassBrand(l,this,o).call(this),this.width){const[_t,X]=this.parentDimensions;this.setAt($*_t,et*X,this.width*_t,this.height*X)}return this.div}static deserialize($,et,_t){if($ instanceof V.StampAnnotationElement)return null;const X=super.deserialize($,et,_t),{rect:b,bitmapUrl:N,bitmapId:rt,isSvg:v,accessibilityData:s}=$;rt&&_t.imageManager.isValidId(rt)?_classPrivateFieldSet(f,X,rt):_classPrivateFieldSet(M,X,N),_classPrivateFieldSet(d,X,v);const[i,h]=X.pageDimensions;return X.width=(b[2]-b[0])/i,X.height=(b[3]-b[1])/h,s&&(X.altTextData=s),X}serialize(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.isEmpty())return null;const _t={annotationType:r.AnnotationEditorType.STAMP,bitmapId:_classPrivateFieldGet(f,this),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:_classPrivateFieldGet(d,this),structTreeParentId:this._structTreeParentId};if($)return _t.bitmapUrl=_assertClassBrand(l,this,P).call(this,!0),_t.accessibilityData=this.altTextData,_t;const{decorative:X,altText:b}=this.altTextData;if(!X&&b&&(_t.accessibilityData={type:"Figure",alt:b}),et===null)return _t;et.stamps||(et.stamps=new Map);const N=_classPrivateFieldGet(d,this)?(_t.rect[2]-_t.rect[0])*(_t.rect[3]-_t.rect[1]):null;if(!et.stamps.has(_classPrivateFieldGet(f,this)))et.stamps.set(_classPrivateFieldGet(f,this),{area:N,serialized:_t}),_t.bitmap=_assertClassBrand(l,this,P).call(this,!1);else if(_classPrivateFieldGet(d,this)){const rt=et.stamps.get(_classPrivateFieldGet(f,this));N>rt.area&&(rt.area=N,rt.serialized.bitmap.close(),rt.serialized.bitmap=_assertClassBrand(l,this,P).call(this,!1))}return _t}}e=F;function y(Q){let $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!Q){this.remove();return}_classPrivateFieldSet(D,this,Q.bitmap),$||(_classPrivateFieldSet(f,this,Q.id),_classPrivateFieldSet(d,this,Q.isSvg)),_assertClassBrand(l,this,w).call(this)}function a(){_classPrivateFieldSet(A,this,null),this._uiManager.enableWaiting(!1),_classPrivateFieldGet(m,this)&&this.div.focus()}function o(){if(_classPrivateFieldGet(f,this)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(_classPrivateFieldGet(f,this)).then($=>_assertClassBrand(l,this,y).call(this,$,!0)).finally(()=>_assertClassBrand(l,this,a).call(this));return}if(_classPrivateFieldGet(M,this)){const $=_classPrivateFieldGet(M,this);_classPrivateFieldSet(M,this,null),this._uiManager.enableWaiting(!0),_classPrivateFieldSet(A,this,this._uiManager.imageManager.getFromUrl($).then(et=>_assertClassBrand(l,this,y).call(this,et)).finally(()=>_assertClassBrand(l,this,a).call(this)));return}if(_classPrivateFieldGet(p,this)){const $=_classPrivateFieldGet(p,this);_classPrivateFieldSet(p,this,null),this._uiManager.enableWaiting(!0),_classPrivateFieldSet(A,this,this._uiManager.imageManager.getFromFile($).then(et=>_assertClassBrand(l,this,y).call(this,et)).finally(()=>_assertClassBrand(l,this,a).call(this)));return}const Q=document.createElement("input");Q.type="file",Q.accept=e.supportedTypesStr,_classPrivateFieldSet(A,this,new Promise($=>{Q.addEventListener("change",async()=>{if(!Q.files||Q.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const et=await this._uiManager.imageManager.getFromFile(Q.files[0]);_assertClassBrand(l,this,y).call(this,et)}$()}),Q.addEventListener("cancel",()=>{this.remove(),$()})}).finally(()=>_assertClassBrand(l,this,a).call(this))),Q.click()}function w(){const{div:Q}=this;let{width:$,height:et}=_classPrivateFieldGet(D,this);const[_t,X]=this.pageDimensions,b=.75;if(this.width)$=this.width*_t,et=this.height*X;else if($>b*_t||et>b*X){const s=Math.min(b*_t/$,b*X/et);$*=s,et*=s}const[N,rt]=this.parentDimensions;this.setDims($*N/_t,et*rt/X),this._uiManager.enableWaiting(!1);const v=_classPrivateFieldSet(m,this,document.createElement("canvas"));Q.append(v),Q.hidden=!1,_assertClassBrand(l,this,g).call(this,$,et),_assertClassBrand(l,this,q).call(this),_classPrivateFieldGet(n,this)||(this.parent.addUndoableEditor(this),_classPrivateFieldSet(n,this,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}function Y(Q,$){var et;const[_t,X]=this.parentDimensions;this.width=Q/_t,this.height=$/X,this.setDims(Q,$),(et=this._initialOptions)!==null&&et!==void 0&&et.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,_classPrivateFieldGet(u,this)!==null&&clearTimeout(_classPrivateFieldGet(u,this)),_classPrivateFieldSet(u,this,setTimeout(()=>{_classPrivateFieldSet(u,this,null),_assertClassBrand(l,this,g).call(this,Q,$)},200))}function B(Q,$){const{width:et,height:_t}=_classPrivateFieldGet(D,this);let X=et,b=_t,N=_classPrivateFieldGet(D,this);for(;X>2*Q||b>2*$;){const rt=X,v=b;X>2*Q&&(X=X>=16384?Math.floor(X/2)-1:Math.ceil(X/2)),b>2*$&&(b=b>=16384?Math.floor(b/2)-1:Math.ceil(b/2));const s=new OffscreenCanvas(X,b);s.getContext("2d").drawImage(N,0,0,rt,v,0,0,X,b),N=s.transferToImageBitmap()}return N}function g(Q,$){Q=Math.ceil(Q),$=Math.ceil($);const et=_classPrivateFieldGet(m,this);if(!et||et.width===Q&&et.height===$)return;et.width=Q,et.height=$;const _t=_classPrivateFieldGet(d,this)?_classPrivateFieldGet(D,this):_assertClassBrand(l,this,B).call(this,Q,$),X=et.getContext("2d");X.filter=this._uiManager.hcmFilter,X.drawImage(_t,0,0,_t.width,_t.height,0,0,Q,$)}function P(Q){if(Q){if(_classPrivateFieldGet(d,this)){const _t=this._uiManager.imageManager.getSvgUrl(_classPrivateFieldGet(f,this));if(_t)return _t}const $=document.createElement("canvas");return{width:$.width,height:$.height}=_classPrivateFieldGet(D,this),$.getContext("2d").drawImage(_classPrivateFieldGet(D,this),0,0),$.toDataURL()}if(_classPrivateFieldGet(d,this)){const[$,et]=this.pageDimensions,_t=Math.round(this.width*$*L.PixelsPerInch.PDF_TO_CSS_UNITS),X=Math.round(this.height*et*L.PixelsPerInch.PDF_TO_CSS_UNITS),b=new OffscreenCanvas(_t,X);return b.getContext("2d").drawImage(_classPrivateFieldGet(D,this),0,0,_classPrivateFieldGet(D,this).width,_classPrivateFieldGet(D,this).height,0,0,_t,X),b.transferToImageBitmap()}return structuredClone(_classPrivateFieldGet(D,this))}function q(){_classPrivateFieldSet(S,this,new ResizeObserver(Q=>{const $=Q[0].contentRect;$.width&&$.height&&_assertClassBrand(l,this,Y).call(this,$.width,$.height)})),_classPrivateFieldGet(S,this).observe(this.div)}_defineProperty(F,"_type","stamp"),t.StampEditor=F}],__webpack_module_cache__={};function __w_pdfjs_require__(T){var t=__webpack_module_cache__[T];if(t!==void 0)return t.exports;var _=__webpack_module_cache__[T]={exports:{}};return __webpack_modules__[T](_,_.exports,__w_pdfjs_require__),_.exports}var __webpack_exports__={};return(()=>{var T=__webpack_exports__;Object.defineProperty(T,"__esModule",{value:!0}),Object.defineProperty(T,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(T,"AnnotationEditorLayer",{enumerable:!0,get:function(){return R.AnnotationEditorLayer}}),Object.defineProperty(T,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(T,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(T,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return L.AnnotationEditorUIManager}}),Object.defineProperty(T,"AnnotationLayer",{enumerable:!0,get:function(){return V.AnnotationLayer}}),Object.defineProperty(T,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(T,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(T,"DOMSVGFactory",{enumerable:!0,get:function(){return e.DOMSVGFactory}}),Object.defineProperty(T,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(T,"GlobalWorkerOptions",{enumerable:!0,get:function(){return D.GlobalWorkerOptions}}),Object.defineProperty(T,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(T,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(T,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(T,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(T,"PDFDataRangeTransport",{enumerable:!0,get:function(){return _.PDFDataRangeTransport}}),Object.defineProperty(T,"PDFDateString",{enumerable:!0,get:function(){return e.PDFDateString}}),Object.defineProperty(T,"PDFWorker",{enumerable:!0,get:function(){return _.PDFWorker}}),Object.defineProperty(T,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(T,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(T,"PixelsPerInch",{enumerable:!0,get:function(){return e.PixelsPerInch}}),Object.defineProperty(T,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(T,"RenderingCancelledException",{enumerable:!0,get:function(){return e.RenderingCancelledException}}),Object.defineProperty(T,"SVGGraphics",{enumerable:!0,get:function(){return _.SVGGraphics}}),Object.defineProperty(T,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(T,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(T,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(T,"XfaLayer",{enumerable:!0,get:function(){return f.XfaLayer}}),Object.defineProperty(T,"build",{enumerable:!0,get:function(){return _.build}}),Object.defineProperty(T,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(T,"getDocument",{enumerable:!0,get:function(){return _.getDocument}}),Object.defineProperty(T,"getFilenameFromUrl",{enumerable:!0,get:function(){return e.getFilenameFromUrl}}),Object.defineProperty(T,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return e.getPdfFilenameFromUrl}}),Object.defineProperty(T,"getXfaPageViewport",{enumerable:!0,get:function(){return e.getXfaPageViewport}}),Object.defineProperty(T,"isDataScheme",{enumerable:!0,get:function(){return e.isDataScheme}}),Object.defineProperty(T,"isPdfFile",{enumerable:!0,get:function(){return e.isPdfFile}}),Object.defineProperty(T,"loadScript",{enumerable:!0,get:function(){return e.loadScript}}),Object.defineProperty(T,"noContextMenu",{enumerable:!0,get:function(){return e.noContextMenu}}),Object.defineProperty(T,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(T,"renderTextLayer",{enumerable:!0,get:function(){return r.renderTextLayer}}),Object.defineProperty(T,"setLayerDimensions",{enumerable:!0,get:function(){return e.setLayerDimensions}}),Object.defineProperty(T,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(T,"updateTextLayer",{enumerable:!0,get:function(){return r.updateTextLayer}}),Object.defineProperty(T,"version",{enumerable:!0,get:function(){return _.version}});var t=__w_pdfjs_require__(1),_=__w_pdfjs_require__(2),e=__w_pdfjs_require__(6),r=__w_pdfjs_require__(26),R=__w_pdfjs_require__(27),L=__w_pdfjs_require__(5),V=__w_pdfjs_require__(29),D=__w_pdfjs_require__(14),f=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$2);var pdfExports=pdf$2.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
