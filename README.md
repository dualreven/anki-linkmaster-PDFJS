# Anki LinkMaster PDFJS

ä¸€ä¸ªç°ä»£åŒ–çš„Ankiå­¦ä¹ å¡ç‰‡ç”Ÿæˆå·¥å…·ï¼Œé›†æˆPDF.jsé˜…è¯»å™¨å’Œæ™ºèƒ½é“¾æ¥ç®¡ç†åŠŸèƒ½ã€‚

## ğŸ¯ é¡¹ç›®ä»‹ç»

### å¼€å‘åŠ¨æœº
Anki LinkMaster PDFJS æ—¨åœ¨è§£å†³å­¦ä¹ è€…åœ¨é˜…è¯»PDFæ–‡æ¡£æ—¶æ— æ³•é«˜æ•ˆåˆ›å»ºAnkiå­¦ä¹ å¡ç‰‡çš„é—®é¢˜ã€‚é€šè¿‡é›†æˆPDF.jsé˜…è¯»å™¨å’Œæ™ºèƒ½é“¾æ¥ç®¡ç†ï¼Œç”¨æˆ·å¯ä»¥åœ¨é˜…è¯»è¿‡ç¨‹ä¸­å¿«é€Ÿæ ‡è®°é‡è¦å†…å®¹ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–çš„å­¦ä¹ å¡ç‰‡ã€‚

### æŠ€æœ¯æ¶æ„
- **åç«¯**: Python 3.9+ + PyQt6 + WebSocket
- **å‰ç«¯**: Vanilla JavaScript + PDF.js + Vite
- **é€šä¿¡**: WebSocketå®æ—¶é€šä¿¡
- **PDFå¤„ç†**: PDF.jsé›†æˆ
- **æ•°æ®å­˜å‚¨**: æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
- **è¡¨æ ¼ç»„ä»¶**: PDFTableæ¨¡å—ï¼ˆä¼ä¸šçº§è¡¨æ ¼è§£å†³æ–¹æ¡ˆï¼‰

### å¼€å‘æ€æƒ³
- **6Aå·¥ä½œæµ**: Alignment â†’ Consensus â†’ Design â†’ Task â†’ Acceptance â†’ Assessment
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œå’ŒèŒè´£åˆ†ç¦»
- **æµ‹è¯•é©±åŠ¨**: å…¨é¢çš„æµ‹è¯•è¦†ç›–ç¡®ä¿ä»£ç è´¨é‡
- **æ¸è¿›å¢å¼º**: ä»æ ¸å¿ƒåŠŸèƒ½é€æ­¥æ‰©å±•
- **ç»„ä»¶åŒ–æ¶æ„**: å¯å¤ç”¨çš„ä¼ä¸šçº§ç»„ä»¶è®¾è®¡

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾
```mermaid
flowchart TD
    subgraph å‰ç«¯å±‚
        A[HTML/CSS/JS]
        B[PDFHomeManager]
        C[WebSocketå®¢æˆ·ç«¯]
        D[PDFTableæ¨¡å—]
    end

    subgraph é€šä¿¡å±‚
        E[WebSocketåè®®]
    end

    subgraph åç«¯å±‚
        F[WebSocketServer]
        G[AnkiLinkMasterApp]
        H[PDFManager]
        I[PDFFileList]
        J[æ–‡ä»¶ç³»ç»Ÿ]
    end

    A --> B
    B --> C
    B --> D
    C --> E
    D --> E
    E --> F
    F --> G
    G --> H
    G --> I
    H --> I
```

### æ¨¡å—è°ƒç”¨å…³ç³»

#### å‰ç«¯æ¨¡å—è°ƒç”¨
```
PDFHomeManager (å‰ç«¯ä¸»æ§åˆ¶å™¨)
â”œâ”€â”€ WebSocketå®¢æˆ·ç«¯ (å®æ—¶é€šä¿¡)
â”œâ”€â”€ FileSelector (æ–‡ä»¶é€‰æ‹©)
â”œâ”€â”€ PDFTableæ¨¡å— (ä¼ä¸šçº§è¡¨æ ¼ç»„ä»¶)
â”‚   â”œâ”€â”€ PDFTable (ä¸»æ§åˆ¶å™¨)
â”‚   â”œâ”€â”€ PDFTableDataModel (æ•°æ®æ¨¡å‹)
â”‚   â”œâ”€â”€ PDFTableRenderer (æ¸²æŸ“å™¨)
â”‚   â”œâ”€â”€ PDFTableEvents (äº‹ä»¶ç®¡ç†)
â”‚   â”œâ”€â”€ PDFTableSorting (æ’åºåŠŸèƒ½)
â”‚   â”œâ”€â”€ PDFTableFiltering (è¿‡æ»¤åŠŸèƒ½)
â”‚   â”œâ”€â”€ PDFTableSelection (é€‰æ‹©åŠŸèƒ½)
â”‚   â”œâ”€â”€ PDFTablePagination (åˆ†é¡µåŠŸèƒ½)
â”‚   â””â”€â”€ PDFTableUtils (å·¥å…·å‡½æ•°)
â””â”€â”€ PDFListRenderer (åˆ—è¡¨æ¸²æŸ“)
```

#### åç«¯æ¨¡å—è°ƒç”¨
```
AnkiLinkMasterApp (åº”ç”¨ä¸»æ§åˆ¶å™¨)
â”œâ”€â”€ WebSocketServer (é€šä¿¡æœåŠ¡)
â”œâ”€â”€ PDFManager (æ–‡ä»¶ç®¡ç†)
â””â”€â”€ UIå±‚ (PyQtä¸»çª—å£)
```

### æ•°æ®æµæ¶æ„
```
ç”¨æˆ·æ“ä½œ â†’ PDFTableæ¨¡å— â†’ å‰ç«¯äº‹ä»¶å¤„ç† â†’ WebSocketæ¶ˆæ¯ â†’ åç«¯æ¶ˆæ¯å¤„ç† â†’ PDFManageræ“ä½œ â†’ æ•°æ®æŒä¹…åŒ– â†’ çŠ¶æ€å¹¿æ’­ â†’ PDFTableæ›´æ–°
```

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **PDFæ–‡ä»¶ç®¡ç†**: æ”¯æŒæ·»åŠ ã€åˆ é™¤ã€æµè§ˆPDFæ–‡ä»¶
- âœ… **PDFé˜…è¯»å™¨**: é›†æˆPDF.jsæä¾›æµç•…çš„é˜…è¯»ä½“éªŒ
- âœ… **å®æ—¶é€šä¿¡**: WebSocketå®ç°å‰åç«¯å®æ—¶åŒæ­¥
- âœ… **å¡ç‰‡ç”Ÿæˆ**: æ™ºèƒ½æå–PDFå†…å®¹ç”ŸæˆAnkiå¡ç‰‡
- âœ… **é“¾æ¥ç®¡ç†**: ç®¡ç†PDFä¸å¡ç‰‡é—´çš„æ™ºèƒ½é“¾æ¥
- âœ… **ä¼ä¸šçº§è¡¨æ ¼**: PDFTableæ¨¡å—æä¾›é«˜çº§æ•°æ®å±•ç¤ºå’Œäº¤äº’åŠŸèƒ½

### æŠ€æœ¯ç‰¹è‰²
- **è·¨å¹³å°**: åŸºäºPyQt6çš„è·¨å¹³å°æ¡Œé¢åº”ç”¨
- **å®æ—¶åŒæ­¥**: WebSocketç¡®ä¿æ•°æ®å®æ—¶æ›´æ–°
- **ç¦»çº¿å¯ç”¨**: å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œæ— éœ€ç½‘ç»œä¾èµ–
- **æ‰©å±•æ€§å¼º**: æ¨¡å—åŒ–æ¶æ„æ”¯æŒåŠŸèƒ½æ‰©å±•
- **ä¼ä¸šçº§è¡¨æ ¼**: PDFTableæ¨¡å—æä¾›é«˜çº§è¡¨æ ¼åŠŸèƒ½
  - è™šæ‹Ÿæ»šåŠ¨ï¼šæ”¯æŒå¤§æ•°æ®é›†é«˜æ•ˆæ¸²æŸ“
  - å¤šåˆ—æ’åºï¼šæ”¯æŒå•åˆ—å’Œå¤šåˆ—æ’åº
  - é«˜çº§è¿‡æ»¤ï¼šçµæ´»çš„æ•°æ®è¿‡æ»¤ç³»ç»Ÿ
  - åˆ†é¡µç³»ç»Ÿï¼šå¯é…ç½®çš„åˆ†é¡µåŠŸèƒ½
  - è¡Œé€‰æ‹©ï¼šå¤šç§é€‰æ‹©æ¨¡å¼ï¼ˆå•é€‰ã€å¤šé€‰ã€èŒƒå›´é€‰æ‹©ï¼‰
  - å“åº”å¼è®¾è®¡ï¼šé€‚é…ä¸åŒå±å¹•å°ºå¯¸
  - ä¸»é¢˜ç³»ç»Ÿï¼šæ”¯æŒå¤šç§è§†è§‰ä¸»é¢˜
  - è‡ªå®šä¹‰æ¸²æŸ“ï¼šæ”¯æŒå•å…ƒæ ¼è‡ªå®šä¹‰å†…å®¹æ¸²æŸ“

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- **Python**: 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Node.js**: 16.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Windows 10+/macOS 10.15+/Linux

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone [é¡¹ç›®åœ°å€]
cd anki-linkmaster-PDFJS
```

#### 2. å®‰è£…åç«¯ä¾èµ–
```bash
cd src/backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

#### 3. å®‰è£…å‰ç«¯ä¾èµ–
```bash
cd ../..
npm install
```

#### 4. å¯åŠ¨å¼€å‘ç¯å¢ƒ

**å¯åŠ¨åç«¯æœåŠ¡**:
```bash
cd src/backend
python main.py
```

**å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨**:
```bash
# æ–°ç»ˆç«¯
npm run dev
```

è¿™äº›è„šæœ¬ä¼šï¼š
- åœ¨åå°å¯åŠ¨ `npm run dev`ï¼ˆå‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼‰
- åœ¨åå°å¯åŠ¨ `python app.py`ï¼ˆä¸»åº”ç”¨ï¼‰
- åœ¨åå°å¯åŠ¨ `python debug.py --port 9222`ï¼ˆè°ƒè¯•æ§åˆ¶å°ç›‘å¬å™¨ï¼‰
- ä¿å­˜è¿›ç¨‹IDåˆ° `ai-services.pids` æ–‡ä»¶ä»¥ä¾¿åç»­ç®¡ç†
- æä¾›ä¸€é”®åœæ­¢æ‰€æœ‰æœåŠ¡çš„åŠŸèƒ½

> **æ³¨æ„**: è¿™äº›è„šæœ¬ä¸“ä¸ºAI/è‡ªåŠ¨åŒ–åœºæ™¯è®¾è®¡ï¼Œé¿å…é˜»å¡å¯¹è¯çª—å£ã€‚æ‰‹åŠ¨å¼€å‘æ—¶å»ºè®®ä½¿ç”¨å•ç‹¬çš„ç»ˆç«¯çª—å£è¿è¡Œå„æœåŠ¡ã€‚

### è¿è¡Œæµ‹è¯•

**åç«¯æµ‹è¯•**:
```bash
cd src/backend
python -m pytest tests/ -v
```

**é›†æˆæµ‹è¯•**:
```bash
python test/20250822_comprehensive_diagnostic.py
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
anki-linkmaster-PDFJS/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ backend/              # PyQt6åç«¯åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â””â”€â”€ application.py      # ä¸»åº”ç”¨æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ pdf_manager/
â”‚   â”‚   â”‚   â”œâ”€â”€ manager.py          # PDFç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ utils.py            # å·¥å…·ç±»
â”‚   â”‚   â”‚   â””â”€â”€ config.py           # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ websocket/
â”‚   â”‚   â”‚   â”œâ”€â”€ server.py           # WebSocketæœåŠ¡å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ client.py           # å®¢æˆ·ç«¯ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ protocol.py         # åè®®å¤„ç†
â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â””â”€â”€ main_window.py      # ä¸»çª—å£
â”‚   â”‚   â”œâ”€â”€ main.py                 # åº”ç”¨å…¥å£
â”‚   â”‚   â””â”€â”€ requirements.txt        # Pythonä¾èµ–
â”‚   â”œâ”€â”€ frontend/            # å‰ç«¯åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ pdf-home/        # PDFä¸»é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ index.html          # ä¸»é¡µHTML
â”‚   â”‚   â”‚   â”œâ”€â”€ main.js             # ä¸»é¡µé€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ styles.css          # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ common/          # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ pdf-table/         # PDFTableæ¨¡å—
â”‚   â”‚   â”‚       â”œâ”€â”€ index.js             # ä¸»å…¥å£
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table.js         # ä¸»æ§åˆ¶å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-config.js  # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-data-model.js # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-renderer.js  # æ¸²æŸ“å™¨
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-events.js    # äº‹ä»¶ç®¡ç†
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-selection.js # é€‰æ‹©åŠŸèƒ½
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-sorting.js   # æ’åºåŠŸèƒ½
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-filtering.js # è¿‡æ»¤åŠŸèƒ½
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-pagination.js # åˆ†é¡µåŠŸèƒ½
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-utils.js     # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚       â”œâ”€â”€ pdf-table-styles.css   # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”‚       â”œâ”€â”€ demo.html             # æ¼”ç¤ºé¡µé¢
â”‚   â”‚   â”‚       â””â”€â”€ README.md             # æ¨¡å—æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ pdf-viewer/      # PDFé˜…è¯»å™¨
â”œâ”€â”€ data/                    # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ pdfs/              # PDFæ–‡ä»¶å‰¯æœ¬
â”‚   â”œâ”€â”€ thumbnails/        # PDFç¼©ç•¥å›¾
â”‚   â””â”€â”€ pdf_files.json     # æ–‡ä»¶ç´¢å¼•
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ tests/                   # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ log/                     # è¿è¡Œæ—¥å¿—
â”œâ”€â”€ package.json             # å‰ç«¯é…ç½®
â”œâ”€â”€ vite.config.js           # Viteé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ APIè§„èŒƒ

### PDFTableæ¨¡å—API

#### åŸºç¡€ä½¿ç”¨
```javascript
import PDFTable from './common/pdf-table/index.js';

// åˆå§‹åŒ–è¡¨æ ¼
const table = new PDFTable('#container', {
    data: pdfData,
    columns: [
        { field: 'filename', title: 'æ–‡ä»¶å', sortable: true },
        { field: 'size', title: 'å¤§å°', sortable: true, formatter: 'fileSize' },
        { field: 'import_date', title: 'å¯¼å…¥æ—¶é—´', sortable: true, formatter: 'date' },
        { field: 'importance', title: 'é‡è¦æ€§', sortable: true, renderer: 'importanceRenderer' }
    ],
    pageSize: 20,
    sortable: true,
    filterable: true,
    selectable: true,
    theme: 'modern'
});

await table.initialize();
```

#### äº‹ä»¶å¤„ç†
```javascript
// è¡Œé€‰æ‹©äº‹ä»¶
table.events.on('selection-changed', (selectedRows) => {
    console.log('é€‰ä¸­çš„è¡Œ:', selectedRows);
});

// è¡Œç‚¹å‡»äº‹ä»¶
table.events.on('row-click', ({ rowData, event }) => {
    console.log('ç‚¹å‡»çš„è¡Œæ•°æ®:', rowData);
});

// æ’åºäº‹ä»¶
table.events.on('sort-changed', ({ field, direction }) => {
    console.log('æ’åºå­—æ®µ:', field, 'æ–¹å‘:', direction);
});
```

#### æ•°æ®æ“ä½œ
```javascript
// æ›´æ–°æ•°æ®
table.setData(newData);

// æ·»åŠ è¡Œ
table.addRow(newRowData);

// åˆ é™¤è¡Œ
table.removeRow(rowId);

// è¿‡æ»¤æ•°æ®
table.applyFilter({ filename: 'åŒ…å«å…³é”®è¯' });

// æ’åºæ•°æ®
table.sortBy('filename', 'asc');
```

#### é…ç½®é€‰é¡¹
```javascript
const config = {
    // åŸºç¡€é…ç½®
    data: [],
    columns: [],
    
    // åŠŸèƒ½å¼€å…³
    sortable: true,
    filterable: true,
    selectable: true,
    pagination: true,
    
    // æ€§èƒ½é…ç½®
    virtualScroll: false,
    pageSize: 20,
    
    // UIé…ç½®
    theme: 'modern',
    responsive: true,
    
    // æœ¬åœ°åŒ–
    locale: 'zh-CN',
    
    // è‡ªå®šä¹‰æ¸²æŸ“å™¨
    renderers: {
        importanceRenderer: (value, row) => {
            return `<span class="importance-${value}">${value}</span>`;
        }
    }
};
```

### WebSocketæ¶ˆæ¯æ ¼å¼

#### æ¶ˆæ¯ç»“æ„
æ‰€æœ‰WebSocketæ¶ˆæ¯é‡‡ç”¨ç»Ÿä¸€JSONæ ¼å¼ï¼š
```json
{
  "type": "message_type",
  "data": {...},
  "id": "message_uuid"
}
```

#### æ¶ˆæ¯ç±»å‹å®šä¹‰

##### å‰ç«¯ â†’ åç«¯
- `request_file_selection`: è¯·æ±‚æ–‡ä»¶é€‰æ‹©
- `add_pdf`: æ·»åŠ PDFæ–‡ä»¶
- `get_pdf_list`: è·å–æ–‡ä»¶åˆ—è¡¨
- `remove_pdf`: åˆ é™¤PDFæ–‡ä»¶

##### åç«¯ â†’ å‰ç«¯
- `pdf_list_updated`: æ–‡ä»¶åˆ—è¡¨æ›´æ–°
- `success`: æ“ä½œæˆåŠŸå“åº”
- `error`: é”™è¯¯å“åº”

### å…·ä½“è°ƒç”¨ç¤ºä¾‹

#### 1. æ–‡ä»¶é€‰æ‹©æµç¨‹
```
ç”¨æˆ·ç‚¹å‡»"æ·»åŠ PDF" â†’ 
å‰ç«¯å‘é€request_file_selection â†’ 
åç«¯å¼¹å‡ºQTæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡† â†’ 
ç”¨æˆ·é€‰æ‹©æ–‡ä»¶ â†’ 
åç«¯å¤„ç†æ–‡ä»¶ â†’ 
å¹¿æ’­pdf_list_updated â†’ 
å‰ç«¯æ›´æ–°åˆ—è¡¨
```

#### 2. æ–‡ä»¶åˆ é™¤æµç¨‹
```
ç”¨æˆ·ç‚¹å‡»"åˆ é™¤" â†’ 
å‰ç«¯ç¡®è®¤ â†’ 
å‰ç«¯å‘é€remove_pdf â†’ 
åç«¯åˆ é™¤æ–‡ä»¶ â†’ 
å¹¿æ’­pdf_list_updated â†’ 
å‰ç«¯æ›´æ–°åˆ—è¡¨
```

### é”™è¯¯å¤„ç†æœºåˆ¶

#### é”™è¯¯æ¶ˆæ¯æ ¼å¼
```json
{
  "type": "error",
  "data": {
    "original_type": "original_message_type",
    "code": "ERROR_CODE",
    "message": "é”™è¯¯æè¿°"
  }
}
```

#### é”™è¯¯ç å®šä¹‰
- `FILE_EXISTS`: æ–‡ä»¶å·²å­˜åœ¨
- `FILE_NOT_FOUND`: æ–‡ä»¶ä¸å­˜åœ¨
- `PERMISSION_DENIED`: æƒé™ä¸è¶³
- `INVALID_MESSAGE_FORMAT`: æ¶ˆæ¯æ ¼å¼é”™è¯¯
- `INTERNAL_ERROR`: å†…éƒ¨é”™è¯¯

## ğŸ§ª å¼€å‘è¯´æ˜

### å…³é”®ç±»/å‡½æ•°

#### AnkiLinkMasterApp (src/backend/app/application.py)
- **èŒè´£**: åº”ç”¨ä¸»æ§åˆ¶å™¨ï¼Œåè°ƒå„æ¨¡å—
- **æ ¸å¿ƒæ–¹æ³•**:
  - `run()`: å¯åŠ¨åº”ç”¨
  - `handle_websocket_message()`: å¤„ç†WebSocketæ¶ˆæ¯
  - `setup_websocket_handlers()`: è®¾ç½®æ¶ˆæ¯å¤„ç†å™¨

#### PDFManager (src/backend/pdf_manager/manager.py)
- **èŒè´£**: PDFæ–‡ä»¶ç®¡ç†æ ¸å¿ƒé€»è¾‘
- **æ ¸å¿ƒæ–¹æ³•**:
  - `add_file(filepath)`: æ·»åŠ PDFæ–‡ä»¶ï¼ˆè‡ªåŠ¨åˆ›å»ºå‰¯æœ¬ï¼‰
  - `remove_file(file_id)`: åˆ é™¤PDFæ–‡ä»¶ï¼ˆåŒæ­¥åˆ é™¤å‰¯æœ¬ï¼‰
  - `get_files()`: è·å–æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯
  - `get_file_detail(file_id)`: è·å–æ–‡ä»¶è¯¦ç»†ä¿¡æ¯

#### WebSocketServer (src/backend/websocket/server.py)
- **èŒè´£**: WebSocketé€šä¿¡ç®¡ç†
- **æ ¸å¿ƒæ–¹æ³•**:
  - `start()`: å¯åŠ¨æœåŠ¡å™¨
  - `send_message(client_id, message)`: å‘é€æ¶ˆæ¯ç»™æŒ‡å®šå®¢æˆ·ç«¯
  - `broadcast_message(message)`: å¹¿æ’­æ¶ˆæ¯ç»™æ‰€æœ‰å®¢æˆ·ç«¯

#### PDFHomeManager (src/frontend/pdf-home/main.js)
- **èŒè´£**: å‰ç«¯ä¸šåŠ¡é€»è¾‘æ§åˆ¶å™¨
- **æ ¸å¿ƒæ–¹æ³•**:
  - `setupWebSocket()`: å»ºç«‹WebSocketè¿æ¥
  - `requestFileSelection()`: è§¦å‘æ–‡ä»¶é€‰æ‹©
  - `updatePDFList()`: æ›´æ–°æ–‡ä»¶åˆ—è¡¨æ˜¾ç¤º

#### PDFTableæ¨¡å— (src/frontend/common/pdf-table/index.js)
- **èŒè´£**: ä¼ä¸šçº§è¡¨æ ¼ç»„ä»¶ï¼Œæä¾›PDFæ–‡ä»¶ç®¡ç†ç•Œé¢
- **æ ¸å¿ƒç±»**:
  - `PDFTable`: ä¸»æ§åˆ¶å™¨ï¼Œåè°ƒæ‰€æœ‰å­æ¨¡å—
  - `PDFTableDataModel`: æ•°æ®éªŒè¯å’Œæ¨¡å‹ç®¡ç†
  - `PDFTableRenderer`: DOMæ¸²æŸ“å’Œè™šæ‹Ÿæ»šåŠ¨
  - `PDFTableEvents`: äº‹ä»¶ç®¡ç†ç³»ç»Ÿ
  - `PDFTableSorting`: æ’åºåŠŸèƒ½
  - `PDFTableFiltering`: è¿‡æ»¤åŠŸèƒ½
  - `PDFTableSelection`: è¡Œé€‰æ‹©ç®¡ç†
  - `PDFTablePagination`: åˆ†é¡µç³»ç»Ÿ
- **æ ¸å¿ƒæ–¹æ³•**:
  - `initialize()`: åˆå§‹åŒ–è¡¨æ ¼
  - `setData(data)`: è®¾ç½®è¡¨æ ¼æ•°æ®
  - `render()`: æ¸²æŸ“è¡¨æ ¼
  - `sort(field, direction)`: æ’åº
  - `filter(criteria)`: è¿‡æ»¤
  - `selectRow(rowId)`: é€‰æ‹©è¡Œ
  - `addEventListener(event, handler)`: æ·»åŠ äº‹ä»¶ç›‘å¬

### æ•°æ®æ¨¡å‹

#### PDFFileæ¨¡å‹
```javascript
{
  id: "æ–‡ä»¶å”¯ä¸€ID",
  filename: "æ–‡ä»¶å",
  filepath: "å‰¯æœ¬æ–‡ä»¶è·¯å¾„",
  file_size: "æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰",
  created_time: "åˆ›å»ºæ—¶é—´æˆ³",
  modified_time: "ä¿®æ”¹æ—¶é—´æˆ³",
  title: "æ–‡æ¡£æ ‡é¢˜",
  metadata: {...} // é¢å¤–å…ƒæ•°æ®
}
```

### æ–‡ä»¶å­˜å‚¨æœºåˆ¶

#### å‰¯æœ¬å­˜å‚¨ç­–ç•¥
- **æºæ–‡ä»¶**: ç”¨æˆ·é€‰æ‹©çš„åŸå§‹PDFæ–‡ä»¶ä¿æŒä¸å˜
- **å‰¯æœ¬æ–‡ä»¶**: è‡ªåŠ¨å¤åˆ¶åˆ° `data/pdfs/` ç›®å½•
- **æ–‡ä»¶ID**: åŸºäºåŸå§‹æ–‡ä»¶è·¯å¾„çš„MD5å“ˆå¸Œç”Ÿæˆ
- **ç´¢å¼•æ–‡ä»¶**: `data/pdf_files.json` å­˜å‚¨æ–‡ä»¶å…ƒæ•°æ®

#### æ•°æ®ä¸€è‡´æ€§
- æ–‡ä»¶æ“ä½œé‡‡ç”¨äº‹åŠ¡å¼å¤„ç†
- å…ƒæ•°æ®ä¸æ–‡ä»¶ç³»ç»ŸçŠ¶æ€åŒæ­¥æ›´æ–°
- é”™è¯¯æ—¶è‡ªåŠ¨å›æ»šæ“ä½œ

## ğŸ”„ æ¨¡å—è°ƒç”¨è¯¦ç»†è¯´æ˜

### å‰ç«¯è°ƒç”¨é“¾

#### 1. åˆå§‹åŒ–æµç¨‹
```javascript
// PDFHomeManager.constructor()
PDFHomeManager
â”œâ”€â”€ setupWebSocket()      // å»ºç«‹WebSocketè¿æ¥
â”œâ”€â”€ setupEventListeners() // ç»‘å®šUIäº‹ä»¶
â””â”€â”€ loadPDFs()           // åŠ è½½åˆå§‹æ–‡ä»¶åˆ—è¡¨
```

#### 2. æ–‡ä»¶æ·»åŠ æµç¨‹
```javascript
// ç”¨æˆ·è§¦å‘æ·»åŠ 
PDFHomeManager.requestFileSelection()
â””â”€â”€ WebSocket.send({type: 'request_file_selection'})

// åç«¯å¤„ç†
AnkiLinkMasterApp.handle_request_file_selection()
â”œâ”€â”€ QFileDialog.getOpenFileName()  // QTæ–‡ä»¶é€‰æ‹©
â”œâ”€â”€ PDFManager.add_file()          // æ·»åŠ æ–‡ä»¶
â”‚   â”œâ”€â”€ åˆ›å»ºæ–‡ä»¶å‰¯æœ¬                // data/pdfs/
â”‚   â”œâ”€â”€ æ›´æ–°å…ƒæ•°æ®                  // data/pdf_files.json
â”‚   â””â”€â”€ è§¦å‘file_addedä¿¡å·
â””â”€â”€ broadcast_pdf_list()          // å¹¿æ’­æ›´æ–°
```

### åç«¯è°ƒç”¨é“¾

#### 1. æ¶ˆæ¯å¤„ç†æµç¨‹
```python
# WebSocketæ¶ˆæ¯å¤„ç†
WebSocketServer.message_received
â”œâ”€â”€ AnkiLinkMasterApp.handle_websocket_message
â”‚   â”œâ”€â”€ æ¶ˆæ¯ç±»å‹è·¯ç”±
â”‚   â”œâ”€â”€ å‚æ•°éªŒè¯
â”‚   â”œâ”€â”€ ä¸šåŠ¡é€»è¾‘å¤„ç†
â”‚   â””â”€â”€ å“åº”å‘é€
â””â”€â”€ é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•
```

#### 2. æ–‡ä»¶ç®¡ç†æµç¨‹
```python
# PDFæ–‡ä»¶ç®¡ç†
PDFManager.add_file(filepath)
â”œâ”€â”€ FileValidator.validate_file_operation()  // æ–‡ä»¶éªŒè¯
â”œâ”€â”€ _create_file_copy()                        // åˆ›å»ºå‰¯æœ¬
â”œâ”€â”€ PDFFile.from_file_path()                   // åˆ›å»ºæ¨¡å‹
â”œâ”€â”€ PDFFileList.add_file()                     // æ·»åŠ åˆ°åˆ—è¡¨
â”œâ”€â”€ save_files()                              // æŒä¹…åŒ–å­˜å‚¨
â””â”€â”€ file_added.emit()                         // ä¿¡å·é€šçŸ¥
```

## ğŸ¯ å·²å®ç°åŠŸèƒ½

### âœ… æ ¸å¿ƒåŠŸèƒ½
- [x] PDFæ–‡ä»¶åˆ—è¡¨ç®¡ç†
- [x] æ–‡ä»¶æ·»åŠ /åˆ é™¤æ“ä½œ
- [x] æ–‡ä»¶å‰¯æœ¬è‡ªåŠ¨ç®¡ç†
- [x] WebSocketå®æ—¶é€šä¿¡
- [x] é”™è¯¯å¤„ç†ä¸ç”¨æˆ·åé¦ˆ
- [x] è·¨å¹³å°æ¡Œé¢åº”ç”¨
- [x] ä¼ä¸šçº§è¡¨æ ¼ç»„ä»¶ (PDFTable)

### âœ… æŠ€æœ¯ç‰¹æ€§
- [x] PyQt6ä¸»çª—å£é›†æˆ
- [x] WebSocketæœåŠ¡å™¨å®ç°
- [x] æ–‡ä»¶ç³»ç»Ÿç›‘æ§
- [x] æ•°æ®æŒä¹…åŒ–
- [x] æ—¥å¿—ç³»ç»Ÿ
- [x] ä¼ä¸šçº§è¡¨æ ¼ç»„ä»¶
  - [x] è™šæ‹Ÿæ»šåŠ¨æ”¯æŒ
  - [x] å¤šåˆ—æ’åº
  - [x] é«˜çº§è¿‡æ»¤
  - [x] åˆ†é¡µç³»ç»Ÿ
  - [x] è¡Œé€‰æ‹©åŠŸèƒ½
  - [x] å“åº”å¼è®¾è®¡
  - [x] ä¸»é¢˜ç³»ç»Ÿ
  - [x] è‡ªå®šä¹‰æ¸²æŸ“å™¨

### âœ… ç”¨æˆ·ä½“éªŒ
- [x] ç›´è§‚çš„æ–‡ä»¶åˆ—è¡¨ç•Œé¢
- [x] æ‹–æ‹½æ–‡ä»¶æ”¯æŒ
- [x] å®æ—¶çŠ¶æ€æ›´æ–°
- [x] å‹å¥½çš„é”™è¯¯æç¤º
- [x] é«˜çº§è¡¨æ ¼äº¤äº’
  - [x] ç‚¹å‡»è¡Œé€‰æ‹©
  - [x] æ‹–æ‹½åˆ—å®½è°ƒæ•´
  - [x] åˆ—æ’åºæŒ‡ç¤ºå™¨
  - [x] è¿‡æ»¤å™¨ç•Œé¢
  - [x] åˆ†é¡µæ§ä»¶
  - [x] ä¸»é¢˜åˆ‡æ¢

## ğŸ“ å¾…å®ç°åŠŸèƒ½

### ğŸ”œ å³å°†å®ç°
- [ ] PDFé˜…è¯»å™¨é›†æˆ
- [ ] å¡ç‰‡ç”ŸæˆåŠŸèƒ½
- [ ] æœç´¢ä¸ç­›é€‰
- [ ] æ‰¹é‡æ“ä½œ

### ğŸ”„ é•¿æœŸè§„åˆ’
- [ ] å¤šæ ‡ç­¾é¡µæ”¯æŒ
- [ ] ç”¨æˆ·åå¥½è®¾ç½®
- [ ] æ’ä»¶ç³»ç»Ÿ
- [ ] äº‘åŒæ­¥åŠŸèƒ½

## ğŸ› å·²çŸ¥é—®é¢˜

### å½“å‰ç‰ˆæœ¬é—®é¢˜
- æš‚æ— å·²çŸ¥å…³é”®é—®é¢˜
- æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- æ€§èƒ½è¡¨ç°è‰¯å¥½

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### åŸºå‡†æµ‹è¯•
- **åº”ç”¨å¯åŠ¨æ—¶é—´**: < 2ç§’
- **æ–‡ä»¶æ·»åŠ å»¶è¿Ÿ**: < 500ms
- **WebSocketè¿æ¥**: < 500ms
- **å†…å­˜ä½¿ç”¨**: ç¨³å®šï¼Œæ— æ³„æ¼
- **æ–‡ä»¶å¤„ç†**: æ”¯æŒ100MB+ PDFæ–‡ä»¶
- **è¡¨æ ¼æ¸²æŸ“æ€§èƒ½**: 
  - 1000è¡Œæ•°æ®æ¸²æŸ“: < 100ms
  - è™šæ‹Ÿæ»šåŠ¨: < 16ms (60fps)
  - æ’åºæ“ä½œ: < 50ms
  - è¿‡æ»¤æ“ä½œ: < 30ms
  - å†…å­˜å ç”¨: < 50MB (1000è¡Œæ•°æ®)

## ğŸ—ï¸ å¼€å‘å†å²

### ç‰ˆæœ¬æ¼”è¿›

#### v1.0.0 (å½“å‰)
- **å®Œæˆæ—¶é—´**: 2025å¹´1æœˆ
- **ä¸»è¦ç‰¹æ€§**: åŸºç¡€PDFç®¡ç†åŠŸèƒ½
- **æ¶æ„**: PyQt6 + WebSocket + Vanilla JS
- **çŠ¶æ€**: ç¨³å®šå¯ç”¨

#### å¼€å‘é‡Œç¨‹ç¢‘
1. **é¡¹ç›®åˆå§‹åŒ–** (2025-01-20): å»ºç«‹é¡¹ç›®ç»“æ„å’ŒåŸºç¡€é…ç½®
2. **PyQt6æ¡†æ¶** (2025-01-21): å®Œæˆåç«¯ä¸»æ¡†æ¶
3. **WebSocketé€šä¿¡** (2025-01-21): å®ç°å®æ—¶é€šä¿¡
4. **PDFç®¡ç†** (2025-01-22): å®Œæˆæ–‡ä»¶ç®¡ç†æ ¸å¿ƒ
5. **å‰ç«¯ç•Œé¢** (2025-01-22): å®Œæˆç”¨æˆ·ç•Œé¢
6. **é›†æˆæµ‹è¯•** (2025-01-22): å®Œæˆç³»ç»Ÿæµ‹è¯•
7. **PDFTableæ¨¡å—** (2025-01-23): å®Œæˆä¼ä¸šçº§è¡¨æ ¼ç»„ä»¶
   - æ ¸å¿ƒæ¶æ„è®¾è®¡å’Œæ¨¡å—åŒ–å®ç°
   - é«˜çº§åŠŸèƒ½å¼€å‘ï¼ˆæ’åºã€è¿‡æ»¤ã€åˆ†é¡µã€é€‰æ‹©ï¼‰
   - æ€§èƒ½ä¼˜åŒ–å’Œè™šæ‹Ÿæ»šåŠ¨
   - ä¸»é¢˜ç³»ç»Ÿå’Œå“åº”å¼è®¾è®¡
   - å®Œæ•´çš„APIæ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹

### å…³é”®è®¾è®¡å†³ç­–
- **é€‰æ‹©PyQt6**: ä¸Ankiç”Ÿæ€ä¿æŒä¸€è‡´
- **WebSocketé€šä¿¡**: å®ç°å®æ—¶åŒæ­¥
- **æ–‡ä»¶å‰¯æœ¬æœºåˆ¶**: ç¡®ä¿æ•°æ®å®‰å…¨
- **æ¨¡å—åŒ–æ¶æ„**: æ”¯æŒåŠŸèƒ½æ‰©å±•
- **PDFTableæ¨¡å—è®¾è®¡**:
  - **æ¨¡å—åŒ–æ¶æ„**: æ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹æ¨¡å—ï¼ŒèŒè´£æ¸…æ™°
  - **äº‹ä»¶é©±åŠ¨**: ä½¿ç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼å®ç°ç»„ä»¶é—´é€šä¿¡
  - **æ€§èƒ½ä¼˜åŒ–**: è™šæ‹Ÿæ»šåŠ¨å’Œå¯¹è±¡æ± æå‡å¤§æ•°æ®é›†å¤„ç†èƒ½åŠ›
  - **å¯æ‰©å±•æ€§**: æ”¯æŒè‡ªå®šä¹‰æ¸²æŸ“å™¨å’Œæ’ä»¶åŒ–åŠŸèƒ½
  - **å“åº”å¼è®¾è®¡**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸å’Œè®¾å¤‡

### æŠ€æœ¯å€ºåŠ¡
- éœ€è¦æ·»åŠ æ›´å¤šå•å…ƒæµ‹è¯•
- æ€§èƒ½ä¼˜åŒ–ç©ºé—´å­˜åœ¨
- å›½é™…åŒ–æ”¯æŒå¾…æ·»åŠ 

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®
1. å…‹éš†é¡¹ç›®
2. å®‰è£…åç«¯ä¾èµ–: `pip install -r src/backend/requirements.txt`
3. å®‰è£…å‰ç«¯ä¾èµ–: `npm install`
4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨: `npm run dev`

### æäº¤è§„èŒƒ
- ä½¿ç”¨è¯­ä¹‰åŒ–æäº¤æ¶ˆæ¯
- æ·»åŠ é€‚å½“çš„æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°ç›¸å…³æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - è¯¦è§LICENSEæ–‡ä»¶