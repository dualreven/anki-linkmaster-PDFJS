- **规范名称**: 版本控制规范
- **规范描述**: 定义JSON通信协议的版本控制机制，确保向后兼容性和平滑升级，避免破坏性变更影响现有系统。
- **当前版本**: 1.0
- **所属范畴**: API规范
- **适用范围**: 所有JSON通信协议的版本管理
- **详细内容**: 
  - 版本号必须遵循语义化版本控制（SemVer）格式：主版本.次版本.修订版
  - 主版本号变更表示不兼容的API修改
  - 次版本号变更表示向后兼容的功能性新增
  - 修订版号变更表示向后兼容的问题修复
  - 版本信息应该在消息的metadata字段中明确标识
  - 旧版本应该尽可能保持兼容，避免强制升级

- **正向例子**:
  ```json
  // 在metadata中包含版本信息
  {
    "type": "get_pdf_list",
    "timestamp": 1635768000.123,
    "request_id": "550e8400-e29b-41d4-a716-446655440000",
    "data": {"page": 1, "per_page": 20},
    "metadata": {
      "version": "1.2.0", // 语义化版本
      "compatibility": "backward" // 兼容性信息
    }
  }

  // 版本升级策略
  // 主版本升级：2.0.0（不兼容变更）
  // 次版本升级：1.3.0（新增功能，向后兼容）
  // 修订版升级：1.2.1（bug修复，向后兼容）
  ```

- **反向例子**:
  ```json
  // 错误：缺少版本信息
  {
    "type": "get_pdf_list",
    "data": {},
    // 没有version字段，无法识别协议版本
  }

  // 错误：版本格式不正确
  {
    "type": "get_pdf_list",
    "metadata": {
      "version": "v1.2" // 应该使用数字格式，不是v前缀
    }
  }

  // 错误：破坏性变更没有主版本升级
  {
    "type": "get_pdf_list",
    "metadata": {
      "version": "1.2.0"
    },
    "data": {
      "page": 1,
      "per_page": 20
    }
    // 如果删除了per_page字段，应该升级到2.0.0
  }
  ```

- **版本控制原则**:
  - **主版本号（Major）**: 当进行不兼容的API变更时递增
  - **次版本号（Minor）**: 当添加向后兼容的功能时递增
  - **修订版号（Patch）**: 当进行向后兼容的问题修复时递增
  - **版本标识**: 建议在metadata中使用"version"字段
  - **兼容性处理**: 系统应该支持多个版本协议的处理