# project_initialize 项目需求对齐文档

## 1. 项目和任务特性规范

### 1.1 项目背景
本项目是作为Anki插件LinkMaster的一个模块存在的，旨在替代基于PyMuPDF的旧版PDF阅读器。旧版本存在跨平台兼容性差、生态资源有限等问题，因此转向基于Web技术（PDF.js + PyQt6）的解决方案。

### 1.2 目标用户
- **主要用户**：学生、研究人员、需要进行PDF标注并反复学习思考的人群
- **使用场景**：深度PDF阅读、标注、制作Anki学习卡片

### 1.3 项目价值
- 利用Web技术丰富的生态资源
- 实现真正的跨平台兼容性（Windows/macOS/Linux）
- 为Anki用户提供更强大的PDF学习工具

## 2. 原始需求

### 2.1 第一阶段MVP功能

#### 2.1.1 PDF主页功能
- **文件管理**：
  - PDF文件列表展示
  - 单选/多选文件
  - 增加PDF文件
  - 删除PDF文件
  - 右键收藏功能
- **扩展性**：为后续功能预留开发接口

#### 2.1.2 PDF阅读器功能
- **核心阅读**：
  - 基于QtWebEngine + PDF.js实现PDF渲染
  - 支持书签加载
  - 支持文字层显示
  - 支持图像层显示
- **接口设计**：
  - 提供标准化API供PDF主页调用
  - 预留其他模块调用接口

### 2.2 未来功能规划（暂不实现）
- 标注功能（选框、选字、注释）
- Anki卡片制作功能
- 标注和卡片数据持久化
- 外部调用接口（从Anki跳转回PDF特定位置）
- Anki互通功能（复习时跳转、批量复习等）

## 3. 边界确认(明确任务范围)

### 3.1 当前任务范围
1. **项目初始化**：建立项目结构和开发环境
2. **PyQt6后端**：WebSocket服务器和PDF文件管理
3. **PDF主页**：Vanilla JS实现文件列表和管理
4. **PDF阅读器**：PDF.js集成和基础阅读功能
5. **通信机制**：前后端WebSocket通信

### 3.2 不在当前任务范围
- 标注功能实现
- Anki卡片制作功能
- 数据持久化实现
- 外部调用接口实现

## 4. 需求理解(对现有项目的理解)

### 4.1 技术栈理解
- **后端框架**：PyQt6（与Anki版本保持一致）
- **前端技术**：
  - PDF渲染：PDF.js
  - 前端框架：Vanilla JS（ES6+现代语法）
  - 构建工具：Vite（用于开发时的模块化）
- **通信方式**：WebSocket
- **数据库**：SQLite
- **文件存储**：本地文件系统

### 4.2 架构理解
- **集成方式**：作为Python模块集成到现有Anki插件中
- **部署方式**：开发完成后将dist文件夹内容复制到Anki插件目录
- **同步机制**：利用Anki自带的同步功能

## 5. 疑问澄清(存在歧义的地方)

### 5.1 待确认问题
1. **PDF文件存储路径**：PDF文件是存储在用户指定目录还是插件目录下？
2. **WebSocket端口分配**：WebSocket服务器使用固定端口还是动态分配？
3. **错误处理机制**：PDF加载失败或WebSocket连接中断时的错误处理策略？
4. **性能优化细节**：对于大型PDF文件，是否需要实现分页加载或缓存机制？

### 5.2 假设条件
1. 假设用户系统已安装Python 3.9+和Node.js环境
2. 假设Anki插件目录结构与文档描述一致
3. 假设PDF.js库能正常集成到QtWebEngine中