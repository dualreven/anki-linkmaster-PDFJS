---
title: "架构说明示例"
author: "张三 <zhangsan@example.com>"
file_version: "v1.0"
input: |-
  - `AITASK/01-myproject/v1/需求/需求说明.md`
  - `designs/初步调研.md`
usage: |-
  本文件用途：说明系统/子系统架构，记录候选方案、选型依据、组件接口契约、部署拓扑与风险评估。交付对象：Arch-Designer、ArchSpec-Manager、Spec-Designer、开发与运维团队。
generated_time: "20250101010101"
source_inputs:
  - `AITASK/01-myproject/v1/需求/需求说明.md`
  - `designs/初步调研.md`
---
# 架构说明 (模板)

> 模板说明：请复制本文件为真实产物并替换 YAML 元数据；真实产物命名格式示例：[`AITASK/01-myproject/v1/20250101010101-架构说明.md`](AITASK/01-myproject/v1/20250101010101-架构说明.md:1)

## 使用说明（如何填写）
- input 字段：列出本次架构需要的所有必需输入文件路径（相对路径），每行一个，使用 YAML 列表或 Markdown 列表；示例见上方 YAML。
- usage 字段：简要说明本文件用途、交付对象与预期读者（例如：Arch-Designer, ArchSpec-Manager, Spec-Designer）。
- 在填写时请保持路径为相对路径并使用仓库内实际位置（可点击引用格式）。

## 1. 概要（Summary / 背景与目标）
- 目的：概述为什么编写此架构说明，需解决的问题与约束。
- 适用范围：本架构覆盖的系统边界、模块与不包含的范围。
- 目标读者：例如 Arch-Designer / ArchSpec-Manager / Spec-Designer / 开发团队 / 运维。
- 填写要点：列出上下游输入（参见 YAML 的 `input`）、关键成功指标（KPI/性能目标）和交付时间线。

## 2. 候选架构概览（Candidate Architectures）
- 提供 2-3 个候选方案标题与一句话概述；为每个候选方案保留占位小节（组件图、模块边界、接口概览、部署拓扑、优缺点、实现难度估计）。

### 候选方案 A：微服务分层（示例）
- 一句话概述：将系统拆分为若干独立微服务，按业务能力划分。
- 组件图：![](...)（在最终文档中插入实际图片，参见附录）
- 模块边界：占位，说明各服务边界与责任
- 接口概览：占位，列出主要 API/事件往来
- 部署拓扑：占位
- 优点：可独立扩展、团队并行开发
- 缺点：运维复杂、分布式一致性问题
- 实现难度估计：中等

### 候选方案 B：单体模块化（示例）
- 一句话概述：以单体应用为主，通过模块化分层实现分治。
- 组件图：占位
- 模块边界：占位
- 接口概览：占位
- 部署拓扑：占位
- 优点：部署简单、调试方便
- 缺点：扩展受限、发布耦合
- 实现难度估计：较低

### 候选方案 C：混合（示例）
- 一句话概述：关键路径采用微服务，非关键路径保留单体。
- 组件图：占位
- 模块边界：占位
- 接口概览：占位
- 部署拓扑：占位
- 优点：兼顾灵活性与简化运维
- 缺点：复杂性中等偏高
- 实现难度估计：较高

> 对每个候选方案请保留以下占位小节（复制到每个方案下）：
> - 组件图（占位）：插入 PNG/SVG
> - 模块边界：文字描述 + UML/PlantUML 占位
> - 接口概览：API/事件清单占位
> - 部署拓扑（占位）
> - 优缺点
> - 实现难度估计与预估工期

## 3. 最终选定方案（Selected Architecture）
- 选定方案名称与简述
- 决策理由：为何选定该方案，比较备选方案并列出权衡（功能、非功能、成本、时间、组织能力）
- 替代方案对比（占位表格）：对比 性能/可扩展性/复杂度/风险 等
- 关键设计决策与风险承诺（Decision records / trade-offs）：
  - 决策摘要、影响范围、替代方案、缓解措施、负责人、时间点

## 4. 组件与模块（Components & Modules）
- 总览：按优先级列出主要组件/子系统
- 每个组件的示例结构：
  - 名称：
  - 职责说明：
  - 输入/输出：
  - 依赖关系：
  - 边界条件（如数据一致性、事务边界）
  - 示例接口清单：
    - 接口名：GetOrder
      - 描述：查询订单信息
      - 输入示例：{ "order_id": "string" }
      - 输出示例：{ "order": { ... } }
      - 错误处理思路：404/400/500 分类说明

## 5. 接口契约示例（Interfaces / Contracts）
- 提供 2-3 个接口的结构化示例（REST/JSON 或函数签名），包含请求/响应示例与错误码说明。
- 指明哪些接口为“关键契约”，并说明如何由 [`roo/system-prompt-spec-designer`](roo/system-prompt-spec-designer:1) 细化与验收。

### 接口示例：POST /api/v1/orders
- 描述：创建订单
- 请求：
```json
{ "customer_id": "string", "items": [{ "sku": "string", "qty": 1 }] }
```
- 响应（成功）：
```json
{ "order_id": "string", "status": "created" }
```
- 错误码：
  - 400: 请求参数错误
  - 409: 资源冲突
  - 500: 内部错误
- 关键契约说明：此接口为关键契约（Critical Contract），任何变更需与 [`roo/system-prompt-spec-designer`](roo/system-prompt-spec-designer:1) 协调并在契约管理系统登记。

### 接口示例：GET /api/v1/orders/{order_id}
- 描述：查询订单详情
- 请求参数：path order_id
- 响应示例：
```json
{ "order_id": "string", "items": [...], "total": 100.0 }
```
- 错误码：404/400/500

> 在此段落中说明：哪些接口为“关键契约”，以及如何由 [`roo/system-prompt-spec-designer`](roo/system-prompt-spec-designer:1) 进行后续细化与验收。

## 6. 部署拓扑（Deployment Topology）
- 部署单元：列出容器、虚机、数据库等
- 拓扑图占位：插入架构图 PNG/SVG（示例路径：[`AITASK/01-myproject/v1/20250101010101-架构图.png`](AITASK/01-myproject/v1/20250101010101-架构图.png:1)）
- 运行环境：操作系统、容器平台、K8s 版本、网络要求
- 可伸缩性与容错：自动扩缩容、熔断、降级策略占位
- 部署示例段落（占位）：本地 / 云 / 混合 的具体说明

## 7. 性能与非功能假设（Non-Functional Assumptions）
- 性能目标示例：P95 响应 < 300ms，吞吐 2000 req/s
- 容量估算：并发用户数、每日事务数、数据增长率
- 可用性目标：SLA 99.9% 等
- 安全/合规假设：加密、认证、审计要求
- 度量方法：Prometheus/Grafana 指标、压测基线与验收流程

## 8. 迁移/兼容性说明（Migration & Compatibility）
- 迁移步骤概要：版本兼容矩阵、数据迁移与验证步骤
- 兼容性注意点：API 版本控制、序列化格式、数据库 schema 迁移策略
- 回退策略占位：如何回滚部署、数据恢复流程与验证点

## 9. 风险与未决项（Risks & Open Issues）
- 风险清单：每项包含 描述 / 优先级 / 影响 / 缓解建议 / 负责人
- 未决设计问题：列出问题、必要的决策项与建议的决策截止日期

## 10. 验收标准（Acceptance Criteria / DoD）
- 完成条件示例：
  - 关键接口契约草案完成并通过评审
  - 部署拓扑图与运行说明完成
  - 风险评估与缓解措施记录完善
  - YAML metadata（包含 source_inputs）完整

## 11. 输出/交付物（Outputs）
- 本架构说明应生成的文件示例（至少 3 个）：
  - [`AITASK/01-myproject/v1/20250101010101-架构说明.md`](AITASK/01-myproject/v1/20250101010101-架构说明.md:1)
  - [`AITASK/01-myproject/v1/20250101010101-架构图.png`](AITASK/01-myproject/v1/20250101010101-架构图.png:1)
  - [`AITASK/01-myproject/v1/20250101010101-架构决策记录.md`](AITASK/01-myproject/v1/20250101010101-架构决策记录.md:1)
- 建议目录结构、命名与示例说明参见：[`docs/articles/AITASK项目工程文件目录结构.md`](docs/articles/AITASK项目工程文件目录结构.md:1)

## 12. 版本与作者记录（metadata 示例）
- YAML 示例：
```yaml
version: v1.0
author: "张三 <zhangsan@example.com>"
generated_time: "20250101010101"
source_inputs:
  - `AITASK/01-myproject/v1/需求/需求说明.md`
```

## 13. 附录：图形与示意占位（如何插入图、格式建议）
- 推荐图片格式：PNG 或 SVG，建议宽度 1200px
- 若使用 PlantUML：在 repo 中放置 `.puml` 文件并导出 PNG，引用相对路径
- 图片插入示例：
  - ![架构图](`AITASK/01-myproject/v1/20250101010101-架构图.png`)

## 14. 参考（必须以带路径可点击格式列出并摘录关键要点）
- [`docs/articles/开发流程设计.md`](docs/articles/开发流程设计.md:1)
  - 关键摘录：1.1 节（ArchSpec-Manager）与 1.1.1 节（Arch-Designer）职责；架构说明为下游 Spec-Designer、Conflict-Detector 等提供输入。
- [`roo/system-prompt-arch-designer`](roo/system-prompt-arch-designer:1)
- [`roo/system-prompt-archspec-manager`](roo/system-prompt-archspec-manager:1)
- 可选列出其它参考（示例）：
  - [`roo/system-prompt-project-manager`](roo/system-prompt-project-manager:1)
  - [`roo/system-prompt-proto-iter-developer`](roo/system-prompt-proto-iter-developer:1)

---
## 模板末尾示例：简短填写示例（2-3 段）
### 候选方案示例（已填写段落）
候选方案 A（微服务分层）：将订阅与支付服务拆分为独立微服务以支持不同步扩缩容。预估实现难度中等，需新增服务网关与集中认证。

### 选定方案示例（已填写段落）
选定方案：混合架构（候选方案 C）。决策理由：支付与高并发查询路径采用微服务以保证可伸缩性；管理后台采用单体以降低运维成本。主要权衡为增加运维复杂度换取关键路径性能与扩展性。

### 接口示例（已填写段落）
接口 POST /api/v1/orders 已定义为关键契约：请求体示例 { "customer_id": "C123", "items": [{"sku":"SKU1","qty":1}] }，响应示例 { "order_id":"O123", "status":"created" }；变更需通知 [`roo/system-prompt-spec-designer`](roo/system-prompt-spec-designer:1) 并更新契约管理记录。

<!-- End of template -->