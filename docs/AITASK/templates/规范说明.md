---
title: "示例：规范说明 v1"
author: "示例：张三 <zhangsan@example.com>"
file_version: "v1.0.0"
input:
  - "示例：需求文档 - `docs/requirements/需求-v1.md`"
  - "示例：架构说明 - `docs/architecture/架构-v1.md`"
usage: "说明：本文件用途、下游依赖（例如：Spec-Designer, Spec-Verifier, Test-Designer）"
generated_time: "示例：20250101010101   # YYYYMMDDhhmmss"
source_inputs:
  - "docs/requirements/需求-v1.md"
  - "docs/architecture/架构-v1.md"
---

# 规范说明 (Specification Summary)

注意：本模板用作 AITASK 版本目录下“规范说明”类型文件模板。生成的实际产物示例文件名格式：
[`AITASK/01-myproject/v1/20250101010101-规范说明.md`](AITASK/01-myproject/v1/20250101010101-规范说明.md:1)

## 文件头 (YAML metadata)
- 上方 YAML 为示例元数据块。字段说明：
  - `title`: 文件标题；示例已填。
  - `author`: 作者与联系方式。
  - `file_version`: 本规范说明的版本号（语义化或日期版本）。
  - `input`: 必需输入文件列表（必须列出上游输入的相对路径，例如需求/架构/版本说明），示例格式：
    - `docs/requirements/需求-v1.md`
    - `docs/architecture/架构-v1.md`
  - `usage`: 本文件用途与下游依赖，说明谁会消费本规范（例如：`roo/system-prompt-spec-designer`、`roo/system-prompt-spec-verifier`、`roo/system-prompt-test-designer`）。
  - `generated_time`: 生成时间戳（YYYYMMDDhhmmss），生产环境必须自动填入。
  - `source_inputs`: 列出所有上游输入路径（数组形式），每次更新需同步修改。

---

## 1. 概要（Summary / 目的与适用范围）
- 填写要点：
  - 本规范说明的目的（例如：聚合项目 v1 的所有规范并提供可验证的 DoD）。
  - 目标读者（例如：开发者、测试工程师、运维、安全负责人、Spec-Designer）。
  - 适用范围与排除项（例如：仅适用于微服务 A 模块）。
- 示例：
  - 目的：为 `AITASK/01-myproject/v1` 聚合规范，供 Spec-Designer 与 Test-Designer 使用。

## 2. 规范汇总（Spec Aggregation / 目录概览）
- 列出本版本包含的规范分类与简短描述与引用路径占位：
  - API 规范：接口契约、请求/响应示例（路径：`AITASK/01-myproject/v1/docs/SPEC/api/`）
  - 编码规范：编码风格、lint 规则（路径：`docs/specs/coding/`）
  - 错误码规范：统一错误码与语义（路径：`docs/specs/error-codes/`）
  - 部署/运维规范：CI/CD、监控、回滚策略（路径：`docs/specs/deploy/`）
  - 安全规范：鉴权、敏感数据处理（路径：`docs/specs/security/`）
- 对每类给出一行引用占位，使用相对路径并保持可点击，例如：
  - [`AITASK/01-myproject/v1/docs/SPEC/api/README.md`](AITASK/01-myproject/v1/docs/SPEC/api/README.md:1)

## 3. 原子规范索引（Atomic Spec Index / SPEC-HEAD）
- 说明：`SPEC-HEAD-[模块].yml` 用于索引该模块下的原子规范，包含每个原子规范的元信息（id、desc、basepath、version、last_updated）。
- 存放规则：模块规范存放于 `docs/SPEC/` 目录下，命名规则示例：
  - `docs/SPEC/SPEC-HEAD-auth.yml`
- 推荐 `SPEC-HEAD` 格式（示例 YAML）：

```yaml
# SPEC-HEAD-auth.yml 示例
module: "auth"
version: "v1.0.0"
generated_time: "20250101010101"
specs:
  - id: "AUTH-001"
    title: "用户认证流程"
    desc: "描述登录/登出及 Token 刷新流程"
    basepath: "docs/SPEC/auth/AUTH-001-用户认证.md"
    version: "v1.0.0"
    last_updated: "20250101010101"
```

- 命名规则：`[模块]/docs/SPEC/[范畴]-[子范畴]-[功能]-[序号ID].md`，例如：
  - [`auth/docs/SPEC/安全-认证-token-001.md`](auth/docs/SPEC/安全-认证-token-001.md:1)

## 4. 规范条目示例（Spec Item Template）
- 单个原子规范（`.md`）的模板要点（标题为一级或二级）：
  - 规范名称
  - 描述（简要目的）
  - 当前版本
  - 适用范围（模块/服务/接口）
  - 详细要求（分项列出）
  - 正/反示例（示例代码块）
  - DoD / 测试点（可验证条目）
  - 关联 `SPEC-HEAD` id 与路径
- 原子规范骨架示例（可复制为新文件）：

```markdown
---
id: "SPEC-XXX"
title: "示例规范名称"
version: "v1.0.0"
scope: "模块/服务/接口"
---

# 规范名称：示例规范名称
描述：一句话说明本规范的目的。

## 详细要求
- 要求 1：...
- 要求 2：...

## 正向示例（示例代码块，标注语言）
```json
{ "example": true }
```

## 反向示例
```json
{ "example": false }
```

## DoD / 测试点
- TP-1：自动化单元测试覆盖该要求；验证方法：单元测试；责任人：角色/姓名
```

## 5. 接口规范汇总（API / Contract Specs）
- 说明：接口契约应包含接口名、路径、请求/响应结构、字段说明、错误码、示例与变更历史。
- 示例 OpenAPI 片段（简化）：

```yaml
paths:
  /v1/login:
    post:
      summary: "用户登录"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: "成功"
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
```

- 另可使用 JSON Schema 片段或引用文件，例如：
  - [`AITASK/01-myproject/v1/docs/SPEC/api/login.schema.json`](AITASK/01-myproject/v1/docs/SPEC/api/login.schema.json:1)

## 6. 规则与可验证点（Rules → Test Points）
- 原则：每条规范必须映射至少一个可验证测试点（DoD）。
- 示例表格（Markdown 表格）：

| 规范条目 | 验证方法 | 责任人 |
|---|---|---|
| AUTH-001 登录必须返回 token | 单元测试/集成测试 | 测试工程师/张三 |
| CODING-001 ESLint 无错误 | 静态扫描 | 开发负责人 |

## 7. 规范版本管理（Versioning & Change Log）
- 说明：每次变更需：
  - 更新受影响的原子规范文件版本字段。
  - 更新对应 `SPEC-HEAD-[模块].yml` 中的 `version` 与 `last_updated`。
  - 更新 `source_inputs` 列表（YAML 头）。
- 变更记录示例：

```text
2025-01-01 20250101010101 v1.0.1 AUTH-001 更新登录字段说明（作者：张三）
```

## 8. 关联文档与下游使用（Downstream Consumers）
- 说明：列出使用本规范的角色、自动化 agent 或流程：
  - `roo/system-prompt-spec-designer` 用于生成或填充原子规范。
  - `roo/system-prompt-spec-verifier` 用于校验代码/规范符合度。
  - `roo/system-prompt-test-designer` 用于生成测试点。
- 示例调用关系占位（可点击路径）：
  - [`roo/system-prompt-spec-designer`](roo/system-prompt-spec-designer:1)
  - [`roo/system-prompt-spec-verifier`](roo/system-prompt-spec-verifier:1)
  - [`roo/system-prompt-test-designer`](roo/system-prompt-test-designer:1)

## 9. 合规/性能/安全约束（Non-functional Constraints）
- 列出关键非功能约束与可量化指标和验证方法，例如：
  - 响应时间：P95 < 200ms（验证：性能测试）。
  - 可用性：SLA 99.9%（验证：监控告警 & 审计）。
  - 安全：所有敏感字段应加密传输（验证：安全扫描/渗透测试）。

## 10. 验收与合格条件（Acceptance Criteria）
- 本规范说明“完成”的条件举例：
  - `SPEC-HEAD` 完整且指向所有原子规范。
  - 所有关键契约均有示例与变更记录。
  - 每项规范至少有一个 DoD/测试点。

## 11. 输出/交付物（Outputs）
- 必须生成或引用的文件（至少 3 个示例），遵循 AITASK 目录规范：
  - [`AITASK/01-myproject/v1/20250101010101-规范说明.md`](AITASK/01-myproject/v1/20250101010101-规范说明.md:1)
  - [`AITASK/01-myproject/v1/docs/SPEC/SPEC-HEAD-auth.yml`](AITASK/01-myproject/v1/docs/SPEC/SPEC-HEAD-auth.yml:1)
  - [`auth/docs/SPEC/安全-认证-token-001.md`](auth/docs/SPEC/安全-认证-token-001.md:1)
- 说明：实际产物文件名中的时间戳应为 `generated_time` 值。

## 12. 未决项与建议（Open Issues & Recommendations）
- 列出尚未决的问题与下一步建议，例如：
  - 是否需要创建 `Conflict-Detector` 子任务来检测规范间冲突？建议：是/否。
  - 建议下次迭代补充接口示例的契约测试向量。

## 13. 示例/填表区（Templates）
- 包含可直接复制的“原子规范文件模板”与“SPEC-HEAD YAML 示例”。（见第3、4 节中的示例）

## 14. 参考（References）
- 必须列出并摘录关键要点（示例格式，路径为相对可点击）：
  - [`docs/articles/开发流程设计.md`](docs/articles/开发流程设计.md:1)
    - 关键摘录：1.1 节（ArchSpec-Manager）负责生成规范说明（1.1.2）；规范必须可验证并映射测试点，供 Task-Design-Manager 与 Spec-Verifier 使用。
  - [`roo/system-prompt-spec-designer`](roo/system-prompt-spec-designer:1)
  - [`roo/system-prompt-archspec-manager`](roo/system-prompt-archspec-manager:1)
  - 其它可选参考：
    - [`roo/system-prompt-project-manager`](roo/system-prompt-project-manager:1)
    - [`roo/system-prompt-proto-iter-developer`](roo/system-prompt-proto-iter-developer:1)
    - [`roo/system-prompt-spec-verifier`](roo/system-prompt-spec-verifier:1)
    - [`roo/system-prompt-test-designer`](roo/system-prompt-test-designer:1)

---

### 附录：原子规范最小示例（可直接复制为新文件）

```markdown
---
id: "AUTH-001"
title: "用户登录返回 Token"
version: "v1.0.0"
scope: "auth-service"
---

# 规范：用户登录返回 Token
描述：登录接口必须返回有效 token，包含过期时间与算法信息。

## 详细要求
- 返回字段 `token` 为字符串，`expires_in` 为秒数（integer）。

## 正向示例
```json
{ "token": "eyJ...", "expires_in": 3600 }
```

## DoD
- 单元/集成测试覆盖登录成功与失败场景；责任人：测试工程师
```

### 附录：接口契约最小示例（JSON Schema）

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LoginResponse",
  "type": "object",
  "properties": {
    "token": { "type": "string" },
    "expires_in": { "type": "integer", "minimum": 0 }
  },
  "required": ["token","expires_in"]
}
```

---

模板结束。请复制本文件并按需修改 YAML 头的 `generated_time` 与 `source_inputs`，将文件另存为：
[`AITASK/01-myproject/v1/[YYYYMMDDhhmmss]-规范说明.md`](AITASK/01-myproject/v1/20250101010101-规范说明.md:1)